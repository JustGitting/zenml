
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sdkdocs.zenml.io/0.74.0/core_code_docs/core-pipelines/">
      
      <link rel="icon" href="../../_assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.5.10">
    
    
      
        <title>Pipelines - ZenML API Reference</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

<script>
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM";;analytics.SNIPPET_VERSION="4.15.3";
  analytics.load("CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM");
  analytics.page();
  }}();
</script>
<script defer data-domain="apidocs.zenml.io" src="https://plausible.io/js/plausible.js"></script>


  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pipelines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ZenML API Reference" class="md-header__button md-logo" aria-label="ZenML API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZenML API Reference
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pipelines
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ZenML API Reference" class="md-nav__button md-logo" aria-label="ZenML API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ZenML API Reference
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        ZenML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        CLI docs
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Core code docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core code docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Core code docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-actions/" class="md-nav__link">
        Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-alerter/" class="md-nav__link">
        Alerter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-analytics/" class="md-nav__link">
        Analytics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-annotators/" class="md-nav__link">
        Annotators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-artifact_stores/" class="md-nav__link">
        Artifact Stores
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-artifacts/" class="md-nav__link">
        Artifacts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-client/" class="md-nav__link">
        Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-client_lazy_loader/" class="md-nav__link">
        Client Lazy Loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-code_repositories/" class="md-nav__link">
        Code Repositories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-config/" class="md-nav__link">
        Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-console/" class="md-nav__link">
        Console
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-container_registries/" class="md-nav__link">
        Container Registries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-data_validators/" class="md-nav__link">
        Data Validators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-entrypoints/" class="md-nav__link">
        Entrypoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-enums/" class="md-nav__link">
        Enums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-environment/" class="md-nav__link">
        Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-event_hub/" class="md-nav__link">
        Event Hub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-event_sources/" class="md-nav__link">
        Event Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-experiment_trackers/" class="md-nav__link">
        Experiment Trackers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-feature_stores/" class="md-nav__link">
        Feature Stores
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-hooks/" class="md-nav__link">
        Hooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-image_builders/" class="md-nav__link">
        Image Builders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-io/" class="md-nav__link">
        Io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-logger/" class="md-nav__link">
        Logger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-logging/" class="md-nav__link">
        Logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-login/" class="md-nav__link">
        Login
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-materializers/" class="md-nav__link">
        Materializers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-metadata/" class="md-nav__link">
        Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-model/" class="md-nav__link">
        Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-model_deployers/" class="md-nav__link">
        Model Deployers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-model_registries/" class="md-nav__link">
        Model Registries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-orchestrators/" class="md-nav__link">
        Orchestrators
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Pipelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Pipelines
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.pipelines" class="md-nav__link">
    pipelines
  </a>
  
    <nav class="md-nav" aria-label="pipelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils" class="md-nav__link">
    build_utils
  </a>
  
    <nav class="md-nav" aria-label="build_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.allows_download_from_code_repository" class="md-nav__link">
    allows_download_from_code_repository()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.build_required" class="md-nav__link">
    build_required()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.code_download_possible" class="md-nav__link">
    code_download_possible()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.compute_build_checksum" class="md-nav__link">
    compute_build_checksum()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.compute_stack_checksum" class="md-nav__link">
    compute_stack_checksum()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.create_pipeline_build" class="md-nav__link">
    create_pipeline_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.find_existing_build" class="md-nav__link">
    find_existing_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.log_code_repository_usage" class="md-nav__link">
    log_code_repository_usage()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.requires_download_from_code_repository" class="md-nav__link">
    requires_download_from_code_repository()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.requires_included_code" class="md-nav__link">
    requires_included_code()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.reuse_or_create_pipeline_build" class="md-nav__link">
    reuse_or_create_pipeline_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.should_upload_code" class="md-nav__link">
    should_upload_code()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.verify_custom_build" class="md-nav__link">
    verify_custom_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.verify_local_repository_context" class="md-nav__link">
    verify_local_repository_context()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context" class="md-nav__link">
    pipeline_context
  </a>
  
    <nav class="md-nav" aria-label="pipeline_context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context.PipelineContext" class="md-nav__link">
    PipelineContext
  </a>
  
    <nav class="md-nav" aria-label="PipelineContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context.PipelineContext.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context.get_pipeline_context" class="md-nav__link">
    get_pipeline_context()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_decorator" class="md-nav__link">
    pipeline_decorator
  </a>
  
    <nav class="md-nav" aria-label="pipeline_decorator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_decorator.pipeline" class="md-nav__link">
    pipeline()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition" class="md-nav__link">
    pipeline_definition
  </a>
  
    <nav class="md-nav" aria-label="pipeline_definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline" class="md-nav__link">
    Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.configuration" class="md-nav__link">
    configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.enable_cache" class="md-nav__link">
    enable_cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.invocations" class="md-nav__link">
    invocations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.is_prepared" class="md-nav__link">
    is_prepared
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.missing_parameters" class="md-nav__link">
    missing_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.model" class="md-nav__link">
    model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.required_parameters" class="md-nav__link">
    required_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.source_code" class="md-nav__link">
    source_code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.source_object" class="md-nav__link">
    source_object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__enter__" class="md-nav__link">
    __enter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__exit__" class="md-nav__link">
    __exit__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__suppress_configure_warnings__" class="md-nav__link">
    __suppress_configure_warnings__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.add_step_invocation" class="md-nav__link">
    add_step_invocation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.build" class="md-nav__link">
    build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.configure" class="md-nav__link">
    configure()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.create_run_template" class="md-nav__link">
    create_run_template()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.log_pipeline_deployment_metadata" class="md-nav__link">
    log_pipeline_deployment_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.prepare" class="md-nav__link">
    prepare()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.register" class="md-nav__link">
    register()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.resolve" class="md-nav__link">
    resolve()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.with_options" class="md-nav__link">
    with_options()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.write_run_configuration_template" class="md-nav__link">
    write_run_configuration_template()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils" class="md-nav__link">
    run_utils
  </a>
  
    <nav class="md-nav" aria-label="run_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.create_placeholder_run" class="md-nav__link">
    create_placeholder_run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.deploy_pipeline" class="md-nav__link">
    deploy_pipeline()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.get_all_sources_from_value" class="md-nav__link">
    get_all_sources_from_value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.get_default_run_name" class="md-nav__link">
    get_default_run_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.get_placeholder_run" class="md-nav__link">
    get_placeholder_run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.upload_notebook_cell_code_if_necessary" class="md-nav__link">
    upload_notebook_cell_code_if_necessary()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.validate_run_config_is_runnable_from_server" class="md-nav__link">
    validate_run_config_is_runnable_from_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.validate_stack_is_runnable_from_server" class="md-nav__link">
    validate_stack_is_runnable_from_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.wait_for_pipeline_run_to_finish" class="md-nav__link">
    wait_for_pipeline_run_to_finish()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-secret/" class="md-nav__link">
        Secret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-service_connectors/" class="md-nav__link">
        Service Connectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-services/" class="md-nav__link">
        Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-stack/" class="md-nav__link">
        Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-stack_deployments/" class="md-nav__link">
        Stack Deployments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-step_operators/" class="md-nav__link">
        Step Operators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-steps/" class="md-nav__link">
        Steps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-types/" class="md-nav__link">
        Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-zen_server/" class="md-nav__link">
        Zen Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core-zen_stores/" class="md-nav__link">
        Zen Stores
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Integration code docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Integration code docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Integration code docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-airflow/" class="md-nav__link">
        Airflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-argilla/" class="md-nav__link">
        Argilla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-aws/" class="md-nav__link">
        Aws
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-azure/" class="md-nav__link">
        Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-bentoml/" class="md-nav__link">
        Bentoml
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-bitbucket/" class="md-nav__link">
        Bitbucket
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-comet/" class="md-nav__link">
        Comet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-databricks/" class="md-nav__link">
        Databricks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-deepchecks/" class="md-nav__link">
        Deepchecks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-discord/" class="md-nav__link">
        Discord
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-evidently/" class="md-nav__link">
        Evidently
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-facets/" class="md-nav__link">
        Facets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-feast/" class="md-nav__link">
        Feast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-gcp/" class="md-nav__link">
        Gcp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-github/" class="md-nav__link">
        Github
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-gitlab/" class="md-nav__link">
        Gitlab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-great_expectations/" class="md-nav__link">
        Great Expectations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-huggingface/" class="md-nav__link">
        Huggingface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-hyperai/" class="md-nav__link">
        Hyperai
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-integration/" class="md-nav__link">
        Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-kaniko/" class="md-nav__link">
        Kaniko
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-kubeflow/" class="md-nav__link">
        Kubeflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-label_studio/" class="md-nav__link">
        Label Studio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-langchain/" class="md-nav__link">
        Langchain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-lightgbm/" class="md-nav__link">
        Lightgbm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-lightning/" class="md-nav__link">
        Lightning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-llama_index/" class="md-nav__link">
        Llama Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-mlflow/" class="md-nav__link">
        Mlflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-modal/" class="md-nav__link">
        Modal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-neptune/" class="md-nav__link">
        Neptune
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-neural_prophet/" class="md-nav__link">
        Neural Prophet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-numpy/" class="md-nav__link">
        Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-openai/" class="md-nav__link">
        Openai
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-pigeon/" class="md-nav__link">
        Pigeon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-pillow/" class="md-nav__link">
        Pillow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-polars/" class="md-nav__link">
        Polars
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-prodigy/" class="md-nav__link">
        Prodigy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-pycaret/" class="md-nav__link">
        Pycaret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-pytorch/" class="md-nav__link">
        Pytorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-pytorch_lightning/" class="md-nav__link">
        Pytorch Lightning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-registry/" class="md-nav__link">
        Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-s3/" class="md-nav__link">
        S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-scipy/" class="md-nav__link">
        Scipy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-seldon/" class="md-nav__link">
        Seldon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-sklearn/" class="md-nav__link">
        Sklearn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-skypilot/" class="md-nav__link">
        Skypilot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-skypilot_aws/" class="md-nav__link">
        Skypilot Aws
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-skypilot_azure/" class="md-nav__link">
        Skypilot Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-skypilot_gcp/" class="md-nav__link">
        Skypilot Gcp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-skypilot_kubernetes/" class="md-nav__link">
        Skypilot Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-skypilot_lambda/" class="md-nav__link">
        Skypilot Lambda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-slack/" class="md-nav__link">
        Slack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-spark/" class="md-nav__link">
        Spark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-tekton/" class="md-nav__link">
        Tekton
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-tensorboard/" class="md-nav__link">
        Tensorboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-tensorflow/" class="md-nav__link">
        Tensorflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-vllm/" class="md-nav__link">
        Vllm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-wandb/" class="md-nav__link">
        Wandb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-whylogs/" class="md-nav__link">
        Whylogs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration_code_docs/integrations-xgboost/" class="md-nav__link">
        Xgboost
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.pipelines" class="md-nav__link">
    pipelines
  </a>
  
    <nav class="md-nav" aria-label="pipelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils" class="md-nav__link">
    build_utils
  </a>
  
    <nav class="md-nav" aria-label="build_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.allows_download_from_code_repository" class="md-nav__link">
    allows_download_from_code_repository()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.build_required" class="md-nav__link">
    build_required()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.code_download_possible" class="md-nav__link">
    code_download_possible()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.compute_build_checksum" class="md-nav__link">
    compute_build_checksum()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.compute_stack_checksum" class="md-nav__link">
    compute_stack_checksum()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.create_pipeline_build" class="md-nav__link">
    create_pipeline_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.find_existing_build" class="md-nav__link">
    find_existing_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.log_code_repository_usage" class="md-nav__link">
    log_code_repository_usage()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.requires_download_from_code_repository" class="md-nav__link">
    requires_download_from_code_repository()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.requires_included_code" class="md-nav__link">
    requires_included_code()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.reuse_or_create_pipeline_build" class="md-nav__link">
    reuse_or_create_pipeline_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.should_upload_code" class="md-nav__link">
    should_upload_code()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.verify_custom_build" class="md-nav__link">
    verify_custom_build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.build_utils.verify_local_repository_context" class="md-nav__link">
    verify_local_repository_context()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context" class="md-nav__link">
    pipeline_context
  </a>
  
    <nav class="md-nav" aria-label="pipeline_context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context.PipelineContext" class="md-nav__link">
    PipelineContext
  </a>
  
    <nav class="md-nav" aria-label="PipelineContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context.PipelineContext.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_context.get_pipeline_context" class="md-nav__link">
    get_pipeline_context()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_decorator" class="md-nav__link">
    pipeline_decorator
  </a>
  
    <nav class="md-nav" aria-label="pipeline_decorator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_decorator.pipeline" class="md-nav__link">
    pipeline()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition" class="md-nav__link">
    pipeline_definition
  </a>
  
    <nav class="md-nav" aria-label="pipeline_definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline" class="md-nav__link">
    Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.configuration" class="md-nav__link">
    configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.enable_cache" class="md-nav__link">
    enable_cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.invocations" class="md-nav__link">
    invocations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.is_prepared" class="md-nav__link">
    is_prepared
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.missing_parameters" class="md-nav__link">
    missing_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.model" class="md-nav__link">
    model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.required_parameters" class="md-nav__link">
    required_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.source_code" class="md-nav__link">
    source_code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.source_object" class="md-nav__link">
    source_object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__enter__" class="md-nav__link">
    __enter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__exit__" class="md-nav__link">
    __exit__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.__suppress_configure_warnings__" class="md-nav__link">
    __suppress_configure_warnings__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.add_step_invocation" class="md-nav__link">
    add_step_invocation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.build" class="md-nav__link">
    build()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.configure" class="md-nav__link">
    configure()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.create_run_template" class="md-nav__link">
    create_run_template()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.log_pipeline_deployment_metadata" class="md-nav__link">
    log_pipeline_deployment_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.prepare" class="md-nav__link">
    prepare()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.register" class="md-nav__link">
    register()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.resolve" class="md-nav__link">
    resolve()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.with_options" class="md-nav__link">
    with_options()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.pipeline_definition.Pipeline.write_run_configuration_template" class="md-nav__link">
    write_run_configuration_template()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils" class="md-nav__link">
    run_utils
  </a>
  
    <nav class="md-nav" aria-label="run_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.create_placeholder_run" class="md-nav__link">
    create_placeholder_run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.deploy_pipeline" class="md-nav__link">
    deploy_pipeline()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.get_all_sources_from_value" class="md-nav__link">
    get_all_sources_from_value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.get_default_run_name" class="md-nav__link">
    get_default_run_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.get_placeholder_run" class="md-nav__link">
    get_placeholder_run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.upload_notebook_cell_code_if_necessary" class="md-nav__link">
    upload_notebook_cell_code_if_necessary()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.validate_run_config_is_runnable_from_server" class="md-nav__link">
    validate_run_config_is_runnable_from_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.validate_stack_is_runnable_from_server" class="md-nav__link">
    validate_stack_is_runnable_from_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.pipelines.run_utils.wait_for_pipeline_run_to_finish" class="md-nav__link">
    wait_for_pipeline_run_to_finish()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/zenml-io/zenml/docs/core_code_docs/core-pipelines.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="pipelines">Pipelines</h1>


  <div class="doc doc-object doc-module">



<h2 id="zenml.pipelines" class="doc doc-heading">
        <code>zenml.pipelines</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h2>

    <div class="doc doc-contents first">




  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h3 id="zenml.pipelines.build_utils" class="doc doc-heading">
        <code>build_utils</code>



</h3>

    <div class="doc doc-contents ">

      <p>Pipeline build utilities.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.allows_download_from_code_repository" class="doc doc-heading">
<code class="highlight language-python"><span class="n">allows_download_from_code_repository</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Checks whether a code repository can be used to download code.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether a code repository can be used to download code.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">allows_download_from_code_repository</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="n">PipelineDeploymentBase</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether a code repository can be used to download code.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether a code repository can be used to download code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">docker_settings</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_code_repository</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.build_required" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build_required</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Checks whether a build is required for the deployment and active stack.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment for which to check.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>If a build is required.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_required</span><span class="p">(</span><span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether a build is required for the deployment and active stack.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment for which to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If a build is required.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">get_docker_builds</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.code_download_possible" class="doc doc-heading">
<code class="highlight language-python"><span class="n">code_download_possible</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Checks whether code download is possible for the deployment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>code_repository</code></td>
        <td><code>Optional[BaseCodeRepository]</code></td>
        <td><p>If provided, this code repository can be used to
download the code inside the container images.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether code download is possible for the deployment.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">code_download_possible</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
    <span class="n">code_repository</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseCodeRepository&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether code download is possible for the deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment.</span>
<span class="sd">        code_repository: If provided, this code repository can be used to</span>
<span class="sd">            download the code inside the container images.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether code download is possible for the deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_artifact_store</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_code_repository</span>
            <span class="ow">and</span> <span class="n">code_repository</span>
        <span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.compute_build_checksum" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_build_checksum</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">stack</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Compute an overall checksum for a pipeline build.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>items</code></td>
        <td><code>List[BuildConfiguration]</code></td>
        <td><p>Items of the build.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stack</code></td>
        <td><code>Stack</code></td>
        <td><p>The stack associated with the build. Will be used to gather
its requirements.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>code_repository</code></td>
        <td><code>Optional[BaseCodeRepository]</code></td>
        <td><p>The code repository that will be used to download
files inside the build. Will be used for its dependency
specification.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The build checksum.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_build_checksum</span><span class="p">(</span>
    <span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;BuildConfiguration&quot;</span><span class="p">],</span>
    <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
    <span class="n">code_repository</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseCodeRepository&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute an overall checksum for a pipeline build.</span>

<span class="sd">    Args:</span>
<span class="sd">        items: Items of the build.</span>
<span class="sd">        stack: The stack associated with the build. Will be used to gather</span>
<span class="sd">            its requirements.</span>
<span class="sd">        code_repository: The code repository that will be used to download</span>
<span class="sd">            files inside the build. Will be used for its dependency</span>
<span class="sd">            specification.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The build checksum.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hash_</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>  <span class="c1"># nosec</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">PipelineBuildBase</span><span class="o">.</span><span class="n">get_image_key</span><span class="p">(</span>
            <span class="n">component_key</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">step_name</span>
        <span class="p">)</span>

        <span class="n">settings_checksum</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">compute_settings_checksum</span><span class="p">(</span>
            <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span>
            <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">hash_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">hash_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings_checksum</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">hash_</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.compute_stack_checksum" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_stack_checksum</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Compute a stack checksum.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>stack</code></td>
        <td><code>StackResponse</code></td>
        <td><p>The stack for which to compute the checksum.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The checksum.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_stack_checksum</span><span class="p">(</span><span class="n">stack</span><span class="p">:</span> <span class="n">StackResponse</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a stack checksum.</span>

<span class="sd">    Args:</span>
<span class="sd">        stack: The stack for which to compute the checksum.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The checksum.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hash_</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>  <span class="c1"># nosec</span>

    <span class="c1"># This checksum is used to see if the stack has been updated since a build</span>
    <span class="c1"># was created for it. We create this checksum not with specific requirements</span>
    <span class="c1"># as these might change with new ZenML releases, but they don&#39;t actually</span>
    <span class="c1"># invalidate those Docker images.</span>
    <span class="n">required_integrations</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="n">component</span><span class="o">.</span><span class="n">integration</span>
            <span class="k">for</span> <span class="n">components</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span>
            <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">integration</span> <span class="ow">and</span> <span class="n">component</span><span class="o">.</span><span class="n">integration</span> <span class="o">!=</span> <span class="s2">&quot;built-in&quot;</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">integration</span> <span class="ow">in</span> <span class="n">required_integrations</span><span class="p">:</span>
        <span class="n">hash_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">integration</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">hash_</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.create_pipeline_build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_pipeline_build</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">pipeline_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Builds images and registers the output in the server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The pipeline deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pipeline_id</code></td>
        <td><code>Optional[uuid.UUID]</code></td>
        <td><p>The ID of the pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>code_repository</code></td>
        <td><code>Optional[BaseCodeRepository]</code></td>
        <td><p>If provided, this code repository will be used to
download inside the build images.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[PipelineBuildResponse]</code></td>
      <td><p>The build output.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If multiple builds with the same key but different
settings were specified.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_pipeline_build</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
    <span class="n">pipeline_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">code_repository</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseCodeRepository&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineBuildResponse&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds images and registers the output in the server.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The pipeline deployment.</span>
<span class="sd">        pipeline_id: The ID of the pipeline.</span>
<span class="sd">        code_repository: If provided, this code repository will be used to</span>
<span class="sd">            download inside the build images.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The build output.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If multiple builds with the same key but different</span>
<span class="sd">            settings were specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
    <span class="n">stack_model</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack_model</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">active_stack</span>
    <span class="n">required_builds</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">get_docker_builds</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">required_builds</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No docker builds required.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Building Docker image(s) for pipeline `</span><span class="si">%s</span><span class="s2">`.&quot;</span><span class="p">,</span>
        <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">docker_image_builder</span> <span class="o">=</span> <span class="n">PipelineDockerImageBuilder</span><span class="p">()</span>
    <span class="n">images</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BuildItem</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">checksums</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">build_config</span> <span class="ow">in</span> <span class="n">required_builds</span><span class="p">:</span>
        <span class="n">combined_key</span> <span class="o">=</span> <span class="n">PipelineBuildBase</span><span class="o">.</span><span class="n">get_image_key</span><span class="p">(</span>
            <span class="n">component_key</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">step_name</span>
        <span class="p">)</span>
        <span class="n">checksum</span> <span class="o">=</span> <span class="n">build_config</span><span class="o">.</span><span class="n">compute_settings_checksum</span><span class="p">(</span>
            <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">combined_key</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
            <span class="n">previous_checksum</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">combined_key</span><span class="p">]</span><span class="o">.</span><span class="n">settings_checksum</span>

            <span class="k">if</span> <span class="n">previous_checksum</span> <span class="o">!=</span> <span class="n">checksum</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Trying to build image for key `</span><span class="si">{</span><span class="n">combined_key</span><span class="si">}</span><span class="s2">` but &quot;</span>
                    <span class="s2">&quot;an image for this key was already built with a &quot;</span>
                    <span class="s2">&quot;different configuration. This happens if multiple &quot;</span>
                    <span class="s2">&quot;stack components specified Docker builds for the same &quot;</span>
                    <span class="s2">&quot;key in the `StackComponent.get_docker_builds(...)` &quot;</span>
                    <span class="s2">&quot;method. If you&#39;re using custom components, make sure &quot;</span>
                    <span class="s2">&quot;to provide unique keys when returning your build &quot;</span>
                    <span class="s2">&quot;configurations to avoid this error.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="n">checksum</span> <span class="ow">in</span> <span class="n">checksums</span><span class="p">:</span>
            <span class="n">item_key</span> <span class="o">=</span> <span class="n">checksums</span><span class="p">[</span><span class="n">checksum</span><span class="p">]</span>
            <span class="n">image_name_or_digest</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">item_key</span><span class="p">]</span><span class="o">.</span><span class="n">image</span>
            <span class="n">contains_code</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">item_key</span><span class="p">]</span><span class="o">.</span><span class="n">contains_code</span>
            <span class="n">requires_code_download</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">item_key</span><span class="p">]</span><span class="o">.</span><span class="n">requires_code_download</span>
            <span class="n">dockerfile</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">item_key</span><span class="p">]</span><span class="o">.</span><span class="n">dockerfile</span>
            <span class="n">requirements</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">item_key</span><span class="p">]</span><span class="o">.</span><span class="n">requirements</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="n">build_config</span><span class="o">.</span><span class="n">step_name</span><span class="p">:</span>
                <span class="n">tag</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">build_config</span><span class="o">.</span><span class="n">step_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">tag</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">build_config</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">include_files</span> <span class="o">=</span> <span class="n">build_config</span><span class="o">.</span><span class="n">should_include_files</span><span class="p">(</span>
                <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">requires_code_download</span> <span class="o">=</span> <span class="n">build_config</span><span class="o">.</span><span class="n">should_download_files</span><span class="p">(</span>
                <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">pass_code_repo</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">build_config</span><span class="o">.</span><span class="n">should_download_files_from_code_repository</span><span class="p">(</span>
                    <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="p">(</span>
                <span class="n">image_name_or_digest</span><span class="p">,</span>
                <span class="n">dockerfile</span><span class="p">,</span>
                <span class="n">requirements</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="n">docker_image_builder</span><span class="o">.</span><span class="n">build_docker_image</span><span class="p">(</span>
                <span class="n">docker_settings</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span>
                <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
                <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span>
                <span class="n">include_files</span><span class="o">=</span><span class="n">include_files</span><span class="p">,</span>
                <span class="n">entrypoint</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span>
                <span class="n">extra_files</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">extra_files</span><span class="p">,</span>
                <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span> <span class="k">if</span> <span class="n">pass_code_repo</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">contains_code</span> <span class="o">=</span> <span class="n">include_files</span>

        <span class="n">images</span><span class="p">[</span><span class="n">combined_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">BuildItem</span><span class="p">(</span>
            <span class="n">image</span><span class="o">=</span><span class="n">image_name_or_digest</span><span class="p">,</span>
            <span class="n">dockerfile</span><span class="o">=</span><span class="n">dockerfile</span><span class="p">,</span>
            <span class="n">requirements</span><span class="o">=</span><span class="n">requirements</span><span class="p">,</span>
            <span class="n">settings_checksum</span><span class="o">=</span><span class="n">checksum</span><span class="p">,</span>
            <span class="n">contains_code</span><span class="o">=</span><span class="n">contains_code</span><span class="p">,</span>
            <span class="n">requires_code_download</span><span class="o">=</span><span class="n">requires_code_download</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">checksums</span><span class="p">[</span><span class="n">checksum</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_key</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Finished building Docker image(s).&quot;</span><span class="p">)</span>

    <span class="n">is_local</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="n">contains_code</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">contains_code</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">images</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">build_checksum</span> <span class="o">=</span> <span class="n">compute_build_checksum</span><span class="p">(</span>
        <span class="n">required_builds</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
    <span class="p">)</span>
    <span class="n">stack_checksum</span> <span class="o">=</span> <span class="n">compute_stack_checksum</span><span class="p">(</span><span class="n">stack</span><span class="o">=</span><span class="n">stack_model</span><span class="p">)</span>
    <span class="n">build_request</span> <span class="o">=</span> <span class="n">PipelineBuildRequest</span><span class="p">(</span>
        <span class="n">user</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">active_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">workspace</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">active_workspace</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">stack</span><span class="o">=</span><span class="n">stack_model</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
        <span class="n">is_local</span><span class="o">=</span><span class="n">is_local</span><span class="p">,</span>
        <span class="n">contains_code</span><span class="o">=</span><span class="n">contains_code</span><span class="p">,</span>
        <span class="n">images</span><span class="o">=</span><span class="n">images</span><span class="p">,</span>
        <span class="n">zenml_version</span><span class="o">=</span><span class="n">zenml</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span>
        <span class="n">python_version</span><span class="o">=</span><span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">(),</span>
        <span class="n">checksum</span><span class="o">=</span><span class="n">build_checksum</span><span class="p">,</span>
        <span class="n">stack_checksum</span><span class="o">=</span><span class="n">stack_checksum</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">create_build</span><span class="p">(</span><span class="n">build_request</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.find_existing_build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_existing_build</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Find an existing build for a deployment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment for which to find an existing build.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>code_repository</code></td>
        <td><code>Optional[BaseCodeRepository]</code></td>
        <td><p>The code repository that will be used to download
files in the images.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[PipelineBuildResponse]</code></td>
      <td><p>The existing build to reuse if found.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_existing_build</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
    <span class="n">code_repository</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseCodeRepository&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineBuildResponse&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find an existing build for a deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment for which to find an existing build.</span>
<span class="sd">        code_repository: The code repository that will be used to download</span>
<span class="sd">            files in the images.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The existing build to reuse if found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">active_stack</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span><span class="p">:</span>
        <span class="c1"># There can be no non-local builds that we can reuse if there is no</span>
        <span class="c1"># container registry in the stack.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">python_version_prefix</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">platform</span><span class="o">.</span><span class="n">python_version_tuple</span><span class="p">()[:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">required_builds</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">get_docker_builds</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">required_builds</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">build_checksum</span> <span class="o">=</span> <span class="n">compute_build_checksum</span><span class="p">(</span>
        <span class="n">required_builds</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
    <span class="p">)</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_builds</span><span class="p">(</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;desc:created&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">stack_id</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="c1"># Until we implement stack versioning, users can still update their</span>
        <span class="c1"># stack to update/remove the container registry. In that case, we might</span>
        <span class="c1"># try to pull an image from a container registry that we don&#39;t have</span>
        <span class="c1"># access to. This is why we add an additional check for the container</span>
        <span class="c1"># registry ID here. (This is still not perfect as users can update the</span>
        <span class="c1"># container registry URI or config, but the best we can do)</span>
        <span class="n">container_registry_id</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="c1"># The build is local and it&#39;s not clear whether the images</span>
        <span class="c1"># exist on the current machine or if they&#39;ve been overwritten.</span>
        <span class="c1"># TODO: Should we support this by storing the unique Docker ID for</span>
        <span class="c1">#   the image and checking if an image with that ID exists locally?</span>
        <span class="n">is_local</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="c1"># The build contains some code which might be different from the</span>
        <span class="c1"># local code the user is expecting to run</span>
        <span class="n">contains_code</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">zenml_version</span><span class="o">=</span><span class="n">zenml</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span>
        <span class="c1"># Match all patch versions of the same Python major + minor</span>
        <span class="n">python_version</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;startswith:</span><span class="si">{</span><span class="n">python_version_prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">checksum</span><span class="o">=</span><span class="n">build_checksum</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.log_code_repository_usage" class="doc doc-heading">
<code class="highlight language-python"><span class="n">log_code_repository_usage</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">local_repo_context</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Log what the code repository can (not) be used for given a deployment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>local_repo_context</code></td>
        <td><code>LocalRepositoryContext</code></td>
        <td><p>The local repository context.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">log_code_repository_usage</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="n">PipelineDeploymentBase</span><span class="p">,</span>
    <span class="n">local_repo_context</span><span class="p">:</span> <span class="s2">&quot;LocalRepositoryContext&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log what the code repository can (not) be used for given a deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment.</span>
<span class="sd">        local_repo_context: The local repository context.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">build_required</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span> <span class="ow">and</span> <span class="n">allows_download_from_code_repository</span><span class="p">(</span>
        <span class="n">deployment</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">is_dirty</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Unable to use code repository `</span><span class="si">%s</span><span class="s2">` to download code or track &quot;</span>
                <span class="s2">&quot;the commit hash as there are uncommitted or untracked files.&quot;</span><span class="p">,</span>
                <span class="n">local_repo_context</span><span class="o">.</span><span class="n">code_repository</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">has_local_changes</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Unable to use code repository `</span><span class="si">%s</span><span class="s2">` to download code as there &quot;</span>
                <span class="s2">&quot;are unpushed commits.&quot;</span><span class="p">,</span>
                <span class="n">local_repo_context</span><span class="o">.</span><span class="n">code_repository</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Using code repository `</span><span class="si">%s</span><span class="s2">` to download code for this run.&quot;</span><span class="p">,</span>
                <span class="n">local_repo_context</span><span class="o">.</span><span class="n">code_repository</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">is_dirty</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Unable to use code repository `</span><span class="si">%s</span><span class="s2">` to track the commit hash as &quot;</span>
            <span class="s2">&quot;there are uncommitted or untracked files.&quot;</span><span class="p">,</span>
            <span class="n">local_repo_context</span><span class="o">.</span><span class="n">code_repository</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.requires_download_from_code_repository" class="doc doc-heading">
<code class="highlight language-python"><span class="n">requires_download_from_code_repository</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Checks whether the deployment needs to download code from a repository.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>If the deployment needs to download code from a code repository.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">requires_download_from_code_repository</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether the deployment needs to download code from a repository.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If the deployment needs to download code from a code repository.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">docker_settings</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_artifact_store</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_including_files_in_images</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_code_repository</span><span class="p">:</span>
            <span class="c1"># The other two options are false, which means download from a</span>
            <span class="c1"># code repo is required.</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.requires_included_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">requires_included_code</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Checks whether the deployment requires included code.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>code_repository</code></td>
        <td><code>Optional[BaseCodeRepository]</code></td>
        <td><p>If provided, this code repository can be used to
download the code inside the container images.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>If the deployment requires code included in the container images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">requires_included_code</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
    <span class="n">code_repository</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseCodeRepository&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether the deployment requires included code.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment.</span>
<span class="sd">        code_repository: If provided, this code repository can be used to</span>
<span class="sd">            download the code inside the container images.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If the deployment requires code included in the container images.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">docker_settings</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_artifact_store</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_code_repository</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">code_repository</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_including_files_in_images</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.reuse_or_create_pipeline_build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reuse_or_create_pipeline_build</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">allow_build_reuse</span><span class="p">,</span> <span class="n">pipeline_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">build</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Loads or creates a pipeline build.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The pipeline deployment for which to load or create the
build.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>allow_build_reuse</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the build is allowed to reuse an
existing build.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pipeline_id</code></td>
        <td><code>Optional[uuid.UUID]</code></td>
        <td><p>Optional ID of the pipeline to reference in the build.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>build</code></td>
        <td><code>Union[UUID, PipelineBuildBase]</code></td>
        <td><p>Optional existing build. If given, the build will be fetched
(or registered) in the database. If not given, a new build will
be created.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>code_repository</code></td>
        <td><code>Optional[BaseCodeRepository]</code></td>
        <td><p>If provided, this code repository can be used to
download code inside the container images.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[PipelineBuildResponse]</code></td>
      <td><p>The build response.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reuse_or_create_pipeline_build</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
    <span class="n">allow_build_reuse</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">pipeline_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">build</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;UUID&quot;</span><span class="p">,</span> <span class="s2">&quot;PipelineBuildBase&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">code_repository</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseCodeRepository&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineBuildResponse&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads or creates a pipeline build.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The pipeline deployment for which to load or create the</span>
<span class="sd">            build.</span>
<span class="sd">        allow_build_reuse: If True, the build is allowed to reuse an</span>
<span class="sd">            existing build.</span>
<span class="sd">        pipeline_id: Optional ID of the pipeline to reference in the build.</span>
<span class="sd">        build: Optional existing build. If given, the build will be fetched</span>
<span class="sd">            (or registered) in the database. If not given, a new build will</span>
<span class="sd">            be created.</span>
<span class="sd">        code_repository: If provided, this code repository can be used to</span>
<span class="sd">            download code inside the container images.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The build response.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">build</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">allow_build_reuse</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">deployment</span><span class="o">.</span><span class="n">should_prevent_build_reuse</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">requires_included_code</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
            <span class="p">)</span>
            <span class="ow">and</span> <span class="n">build_required</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">existing_build</span> <span class="o">=</span> <span class="n">find_existing_build</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">existing_build</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;Reusing existing build `</span><span class="si">%s</span><span class="s2">` for stack `</span><span class="si">%s</span><span class="s2">`.&quot;</span><span class="p">,</span>
                    <span class="n">existing_build</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="n">existing_build</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;Unable to find a build to reuse. A previous build can be &quot;</span>
                    <span class="s2">&quot;reused when the following conditions are met:</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;  * The existing build was created for the same stack, &quot;</span>
                    <span class="s2">&quot;ZenML version and Python version</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;  * The stack contains a container registry</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;  * The Docker settings of the pipeline and all its steps &quot;</span>
                    <span class="s2">&quot;are the same as for the existing build.&quot;</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">create_pipeline_build</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
            <span class="n">pipeline_id</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
            <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">build</span><span class="p">,</span> <span class="n">UUID</span><span class="p">):</span>
        <span class="n">build_model</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">get_build</span><span class="p">(</span><span class="n">build_id</span><span class="o">=</span><span class="n">build</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">build_request</span> <span class="o">=</span> <span class="n">PipelineBuildRequest</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">workspace</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_workspace</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">stack</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack_model</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
            <span class="o">**</span><span class="n">build</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">build_model</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">create_build</span><span class="p">(</span><span class="n">build</span><span class="o">=</span><span class="n">build_request</span><span class="p">)</span>

    <span class="n">verify_custom_build</span><span class="p">(</span>
        <span class="n">build</span><span class="o">=</span><span class="n">build_model</span><span class="p">,</span>
        <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
        <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">build_model</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.should_upload_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">should_upload_code</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">can_download_from_code_repository</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Checks whether the current code should be uploaded for the deployment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>build</code></td>
        <td><code>Optional[zenml.models.v2.core.pipeline_build.PipelineBuildResponse]</code></td>
        <td><p>The build for the deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>can_download_from_code_repository</code></td>
        <td><code>bool</code></td>
        <td><p>Whether the code can be downloaded
from a code repository.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether the current code should be uploaded for the deployment.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">should_upload_code</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="n">PipelineDeploymentBase</span><span class="p">,</span>
    <span class="n">build</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PipelineBuildResponse</span><span class="p">],</span>
    <span class="n">can_download_from_code_repository</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether the current code should be uploaded for the deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment.</span>
<span class="sd">        build: The build for the deployment.</span>
<span class="sd">        can_download_from_code_repository: Whether the code can be downloaded</span>
<span class="sd">            from a code repository.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the current code should be uploaded for the deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">build</span><span class="p">:</span>
        <span class="c1"># No build means we don&#39;t need to download code into a Docker container</span>
        <span class="c1"># for step execution. In other remote orchestrators that don&#39;t use</span>
        <span class="c1"># Docker containers but instead use e.g. Wheels to run, the code should</span>
        <span class="c1"># already be included.</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">docker_settings</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">can_download_from_code_repository</span>
            <span class="ow">and</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_code_repository</span>
        <span class="p">):</span>
            <span class="c1"># No upload needed for this step</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">docker_settings</span><span class="o">.</span><span class="n">allow_download_from_artifact_store</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.verify_custom_build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verify_custom_build</span><span class="p">(</span><span class="n">build</span><span class="p">,</span> <span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Verify a custom build for a pipeline deployment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>build</code></td>
        <td><code>PipelineBuildResponse</code></td>
        <td><p>The build to verify.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment for which to verify the build.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>code_repository</code></td>
        <td><code>Optional[BaseCodeRepository]</code></td>
        <td><p>Code repository that will be used to download files
for the deployment.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the build can't be used for the deployment.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">verify_custom_build</span><span class="p">(</span>
    <span class="n">build</span><span class="p">:</span> <span class="s2">&quot;PipelineBuildResponse&quot;</span><span class="p">,</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
    <span class="n">code_repository</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseCodeRepository&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify a custom build for a pipeline deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        build: The build to verify.</span>
<span class="sd">        deployment: The deployment for which to verify the build.</span>
<span class="sd">        code_repository: Code repository that will be used to download files</span>
<span class="sd">            for the deployment.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the build can&#39;t be used for the deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>
    <span class="n">required_builds</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">get_docker_builds</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">build</span><span class="o">.</span><span class="n">stack</span> <span class="ow">and</span> <span class="n">build</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">stack</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The stack `</span><span class="si">%s</span><span class="s2">` used for the build `</span><span class="si">%s</span><span class="s2">` is not the same as the &quot;</span>
            <span class="s2">&quot;stack `</span><span class="si">%s</span><span class="s2">` that the pipeline will run on. This could lead &quot;</span>
            <span class="s2">&quot;to issues if the stacks have different build requirements.&quot;</span><span class="p">,</span>
            <span class="n">build</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">build</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">build</span><span class="o">.</span><span class="n">contains_code</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The build you specified for this run contains code and will run &quot;</span>
            <span class="s2">&quot;with the step code that was included in the Docker images which &quot;</span>
            <span class="s2">&quot;might differ from the local code in your client environment.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">build</span><span class="o">.</span><span class="n">requires_code_download</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">requires_included_code</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;The `DockerSettings` of the pipeline or one of its &quot;</span>
                <span class="s2">&quot;steps specify that code should be included in the Docker &quot;</span>
                <span class="s2">&quot;image, but the build you &quot;</span>
                <span class="s2">&quot;specified requires code download. Either update your &quot;</span>
                <span class="s2">&quot;`DockerSettings` or specify a different build and try &quot;</span>
                <span class="s2">&quot;again.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">requires_download_from_code_repository</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">code_repository</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;The `DockerSettings` of the pipeline or one of its &quot;</span>
                <span class="s2">&quot;steps specify that code should be downloaded from a &quot;</span>
                <span class="s2">&quot;code repository but &quot;</span>
                <span class="s2">&quot;there is no code repository active at your current source &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;root `</span><span class="si">{</span><span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span><span class="si">}</span><span class="s2">`.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">code_download_possible</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;The `DockerSettings` of the pipeline or one of its &quot;</span>
                <span class="s2">&quot;steps specify that code can not be downloaded from the &quot;</span>
                <span class="s2">&quot;artifact store, but the build you specified requires code &quot;</span>
                <span class="s2">&quot;download. Either update your `DockerSettings` or specify a &quot;</span>
                <span class="s2">&quot;different build and try again.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">build</span><span class="o">.</span><span class="n">checksum</span><span class="p">:</span>
        <span class="n">build_checksum</span> <span class="o">=</span> <span class="n">compute_build_checksum</span><span class="p">(</span>
            <span class="n">required_builds</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">build_checksum</span> <span class="o">!=</span> <span class="n">build</span><span class="o">.</span><span class="n">checksum</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;The Docker settings used for the build `</span><span class="si">%s</span><span class="s2">` are &quot;</span>
                <span class="s2">&quot;not the same as currently specified for your pipeline. &quot;</span>
                <span class="s2">&quot;This means that the build you specified to run this &quot;</span>
                <span class="s2">&quot;pipeline might be outdated and most likely contains &quot;</span>
                <span class="s2">&quot;outdated requirements.&quot;</span><span class="p">,</span>
                <span class="n">build</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># No checksum given for the entire build, we manually check that</span>
        <span class="c1"># all the images exist and the setting match</span>
        <span class="k">for</span> <span class="n">build_config</span> <span class="ow">in</span> <span class="n">required_builds</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
                    <span class="n">component_key</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
                    <span class="n">step</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">step_name</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;The build you specified is missing an image for key: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">build_config</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">build_config</span><span class="o">.</span><span class="n">compute_settings_checksum</span><span class="p">(</span>
                <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span> <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span>
            <span class="p">)</span> <span class="o">!=</span> <span class="n">build</span><span class="o">.</span><span class="n">get_settings_checksum</span><span class="p">(</span>
                <span class="n">component_key</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">build_config</span><span class="o">.</span><span class="n">step_name</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;The Docker settings used to build the image `</span><span class="si">%s</span><span class="s2">` are &quot;</span>
                    <span class="s2">&quot;not the same as currently specified for your pipeline. &quot;</span>
                    <span class="s2">&quot;This means that the build you specified to run this &quot;</span>
                    <span class="s2">&quot;pipeline might be outdated and most likely contains &quot;</span>
                    <span class="s2">&quot;outdated code or requirements.&quot;</span><span class="p">,</span>
                    <span class="n">image</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">build</span><span class="o">.</span><span class="n">is_local</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;You manually specified a local build to run your pipeline. &quot;</span>
            <span class="s2">&quot;This might lead to errors if the images don&#39;t exist on &quot;</span>
            <span class="s2">&quot;your local machine or the image tags have been &quot;</span>
            <span class="s2">&quot;overwritten since the original build happened.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.build_utils.verify_local_repository_context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verify_local_repository_context</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">local_repo_context</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Verifies the local repository.</p>
<p>If the local repository exists and has no local changes, code download
inside the images is possible.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The pipeline deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>local_repo_context</code></td>
        <td><code>Optional[LocalRepositoryContext]</code></td>
        <td><p>The local repository active at the source root.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the deployment requires code download but code download
is not possible.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[zenml.code_repositories.base_code_repository.BaseCodeRepository]</code></td>
      <td><p>The code repository from which to download files for the runs of the
deployment, or None if code download is not possible.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/build_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">verify_local_repository_context</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
    <span class="n">local_repo_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;LocalRepositoryContext&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseCodeRepository</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verifies the local repository.</span>

<span class="sd">    If the local repository exists and has no local changes, code download</span>
<span class="sd">    inside the images is possible.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The pipeline deployment.</span>
<span class="sd">        local_repo_context: The local repository active at the source root.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the deployment requires code download but code download</span>
<span class="sd">            is not possible.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The code repository from which to download files for the runs of the</span>
<span class="sd">        deployment, or None if code download is not possible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">build_required</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">requires_download_from_code_repository</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">local_repo_context</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;The `DockerSettings` of the pipeline or one of its &quot;</span>
                    <span class="s2">&quot;steps specify that code should be downloaded from a &quot;</span>
                    <span class="s2">&quot;code repository, but &quot;</span>
                    <span class="s2">&quot;there is no code repository active at your current source &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;root `</span><span class="si">{</span><span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span><span class="si">}</span><span class="s2">`.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">is_dirty</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;The `DockerSettings` of the pipeline or one of its &quot;</span>
                    <span class="s2">&quot;steps specify that code should be downloaded from a &quot;</span>
                    <span class="s2">&quot;code repository, but &quot;</span>
                    <span class="s2">&quot;the code repository active at your current source root &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span><span class="si">}</span><span class="s2">` has uncommitted &quot;</span>
                    <span class="s2">&quot;changes.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">has_local_changes</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;The `DockerSettings` of the pipeline or one of its &quot;</span>
                    <span class="s2">&quot;steps specify that code should be downloaded from a &quot;</span>
                    <span class="s2">&quot;code repository, but &quot;</span>
                    <span class="s2">&quot;the code repository active at your current source root &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span><span class="si">}</span><span class="s2">` has unpushed &quot;</span>
                    <span class="s2">&quot;changes.&quot;</span>
                <span class="p">)</span>

    <span class="n">code_repository</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">local_repo_context</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">has_local_changes</span><span class="p">:</span>
        <span class="n">code_repository</span> <span class="o">=</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">code_repository</span>

    <span class="k">return</span> <span class="n">code_repository</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.pipelines.pipeline_context" class="doc doc-heading">
        <code>pipeline_context</code>



</h3>

    <div class="doc doc-contents ">

      <p>Pipeline context class.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h4 id="zenml.pipelines.pipeline_context.PipelineContext" class="doc doc-heading">
        <code>
PipelineContext        </code>



</h4>

    <div class="doc doc-contents ">

      <p>Provides pipeline configuration context.</p>
<p>Usage example:</p>
<pre><code class="language-python">from zenml import get_pipeline_context

...

@pipeline(
    extra={
        &quot;complex_parameter&quot;: [
            (&quot;sklearn.tree&quot;, &quot;DecisionTreeClassifier&quot;),
            (&quot;sklearn.ensemble&quot;, &quot;RandomForestClassifier&quot;),
        ]
    }
)
def my_pipeline():
    context = get_pipeline_context()

    after = []
    search_steps_prefix = &quot;hp_tuning_search_&quot;
    for i, model_search_configuration in enumerate(
        context.extra[&quot;complex_parameter&quot;]
    ):
        step_name = f&quot;{search_steps_prefix}{i}&quot;
        cross_validation(
            model_package=model_search_configuration[0],
            model_class=model_search_configuration[1],
            id=step_name
        )
        after.append(step_name)
    select_best_model(
        search_steps_prefix=search_steps_prefix,
        after=after,
    )
</code></pre>

        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PipelineContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides pipeline configuration context.</span>

<span class="sd">    Usage example:</span>

<span class="sd">    ```python</span>
<span class="sd">    from zenml import get_pipeline_context</span>

<span class="sd">    ...</span>

<span class="sd">    @pipeline(</span>
<span class="sd">        extra={</span>
<span class="sd">            &quot;complex_parameter&quot;: [</span>
<span class="sd">                (&quot;sklearn.tree&quot;, &quot;DecisionTreeClassifier&quot;),</span>
<span class="sd">                (&quot;sklearn.ensemble&quot;, &quot;RandomForestClassifier&quot;),</span>
<span class="sd">            ]</span>
<span class="sd">        }</span>
<span class="sd">    )</span>
<span class="sd">    def my_pipeline():</span>
<span class="sd">        context = get_pipeline_context()</span>

<span class="sd">        after = []</span>
<span class="sd">        search_steps_prefix = &quot;hp_tuning_search_&quot;</span>
<span class="sd">        for i, model_search_configuration in enumerate(</span>
<span class="sd">            context.extra[&quot;complex_parameter&quot;]</span>
<span class="sd">        ):</span>
<span class="sd">            step_name = f&quot;{search_steps_prefix}{i}&quot;</span>
<span class="sd">            cross_validation(</span>
<span class="sd">                model_package=model_search_configuration[0],</span>
<span class="sd">                model_class=model_search_configuration[1],</span>
<span class="sd">                id=step_name</span>
<span class="sd">            )</span>
<span class="sd">            after.append(step_name)</span>
<span class="sd">        select_best_model(</span>
<span class="sd">            search_steps_prefix=search_steps_prefix,</span>
<span class="sd">            after=after,</span>
<span class="sd">        )</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_configuration</span><span class="p">:</span> <span class="s2">&quot;PipelineConfiguration&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the context of the current pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            pipeline_configuration: The configuration of the pipeline derived</span>
<span class="sd">                from Pipeline class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_cache</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_artifact_metadata</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_artifact_metadata</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_artifact_visualization</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_artifact_visualization</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_step_logs</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_step_logs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extra</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">extra</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">model</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_context.PipelineContext.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_configuration</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Initialize the context of the current pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>pipeline_configuration</code></td>
        <td><code>PipelineConfiguration</code></td>
        <td><p>The configuration of the pipeline derived
from Pipeline class.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_configuration</span><span class="p">:</span> <span class="s2">&quot;PipelineConfiguration&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the context of the current pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        pipeline_configuration: The configuration of the pipeline derived</span>
<span class="sd">            from Pipeline class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_cache</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_cache</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_artifact_metadata</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_artifact_metadata</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_artifact_visualization</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_artifact_visualization</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_step_logs</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_step_logs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">settings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extra</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">extra</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">model</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.pipeline_context.get_pipeline_context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_pipeline_context</span><span class="p">()</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Get the context of the current pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>PipelineContext</code></td>
      <td><p>The context of the current pipeline.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If no active pipeline is found.</p></td>
      </tr>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If inside a running step.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_pipeline_context</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s2">&quot;PipelineContext&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the context of the current pipeline.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The context of the current pipeline.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no active pipeline is found.</span>
<span class="sd">        RuntimeError: If inside a running step.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.pipelines.pipeline_definition</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>

    <span class="k">if</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.steps.step_context</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_step_context</span>

            <span class="n">get_step_context</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No active pipeline found.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Inside a step use `from zenml import get_step_context` &quot;</span>
                <span class="s2">&quot;instead.&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">PipelineContext</span><span class="p">(</span>
        <span class="n">pipeline_configuration</span><span class="o">=</span><span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span><span class="o">.</span><span class="n">configuration</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.pipelines.pipeline_decorator" class="doc doc-heading">
        <code>pipeline_decorator</code>



</h3>

    <div class="doc doc-contents ">

      <p>ZenML pipeline decorator definition.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.pipeline_decorator.pipeline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pipeline</span><span class="p">(</span><span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_cache</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_artifact_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_step_logs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_failure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_success</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">substitutions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Decorator to create a pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>_func</code></td>
        <td><code>Optional[F]</code></td>
        <td><p>The decorated function.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The name of the pipeline. If left empty, the name of the
decorated function will be used as a fallback.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_cache</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>Whether to use caching or not.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_artifact_metadata</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>Whether to enable artifact metadata or not.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_step_logs</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If step logs should be enabled for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>settings</code></td>
        <td><code>Optional[Dict[str, SettingsOrDict]]</code></td>
        <td><p>Settings for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>Tags to apply to runs of the pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>extra</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>Extra configurations for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>on_failure</code></td>
        <td><code>Optional[HookSpecification]</code></td>
        <td><p>Callback function in event of failure of the step. Can be a
function with a single argument of type <code>BaseException</code>, or a source
path to such a function (e.g. <code>module.my_function</code>).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>on_success</code></td>
        <td><code>Optional[HookSpecification]</code></td>
        <td><p>Callback function in event of success of the step. Can be a
function with no arguments, or a source path to such a function
(e.g. <code>module.my_function</code>).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td><code>Optional[Model]</code></td>
        <td><p>configuration of the model in the Model Control Plane.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>substitutions</code></td>
        <td><code>Optional[Dict[str, str]]</code></td>
        <td><p>Extra placeholders to use in the name templates.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[Pipeline, Callable[[F], Pipeline]]</code></td>
      <td><p>A pipeline instance.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_decorator.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pipeline</span><span class="p">(</span>
    <span class="n">_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_cache</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_artifact_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_step_logs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extra</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_failure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_success</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">substitutions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Pipeline&quot;</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;F&quot;</span><span class="p">],</span> <span class="s2">&quot;Pipeline&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to create a pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        _func: The decorated function.</span>
<span class="sd">        name: The name of the pipeline. If left empty, the name of the</span>
<span class="sd">            decorated function will be used as a fallback.</span>
<span class="sd">        enable_cache: Whether to use caching or not.</span>
<span class="sd">        enable_artifact_metadata: Whether to enable artifact metadata or not.</span>
<span class="sd">        enable_step_logs: If step logs should be enabled for this pipeline.</span>
<span class="sd">        settings: Settings for this pipeline.</span>
<span class="sd">        tags: Tags to apply to runs of the pipeline.</span>
<span class="sd">        extra: Extra configurations for this pipeline.</span>
<span class="sd">        on_failure: Callback function in event of failure of the step. Can be a</span>
<span class="sd">            function with a single argument of type `BaseException`, or a source</span>
<span class="sd">            path to such a function (e.g. `module.my_function`).</span>
<span class="sd">        on_success: Callback function in event of success of the step. Can be a</span>
<span class="sd">            function with no arguments, or a source path to such a function</span>
<span class="sd">            (e.g. `module.my_function`).</span>
<span class="sd">        model: configuration of the model in the Model Control Plane.</span>
<span class="sd">        substitutions: Extra placeholders to use in the name templates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A pipeline instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">inner_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="s2">&quot;F&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pipeline&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.pipelines.pipeline_definition</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span> <span class="ow">or</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">enable_cache</span><span class="o">=</span><span class="n">enable_cache</span><span class="p">,</span>
            <span class="n">enable_artifact_metadata</span><span class="o">=</span><span class="n">enable_artifact_metadata</span><span class="p">,</span>
            <span class="n">enable_step_logs</span><span class="o">=</span><span class="n">enable_step_logs</span><span class="p">,</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">extra</span><span class="o">=</span><span class="n">extra</span><span class="p">,</span>
            <span class="n">on_failure</span><span class="o">=</span><span class="n">on_failure</span><span class="p">,</span>
            <span class="n">on_success</span><span class="o">=</span><span class="n">on_success</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">entrypoint</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
            <span class="n">substitutions</span><span class="o">=</span><span class="n">substitutions</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span>
        <span class="k">return</span> <span class="n">p</span>

    <span class="k">return</span> <span class="n">inner_decorator</span> <span class="k">if</span> <span class="n">_func</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">inner_decorator</span><span class="p">(</span><span class="n">_func</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.pipelines.pipeline_definition" class="doc doc-heading">
        <code>pipeline_definition</code>



</h3>

    <div class="doc doc-contents ">

      <p>Definition of a ZenML pipeline.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h4 id="zenml.pipelines.pipeline_definition.Pipeline" class="doc doc-heading">
        <code>
Pipeline        </code>



</h4>

    <div class="doc doc-contents ">

      <p>ZenML pipeline class.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Pipeline</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ZenML pipeline class.&quot;&quot;&quot;</span>

    <span class="c1"># The active pipeline is the pipeline to which step invocations will be</span>
    <span class="c1"># added when a step is called. It is set using a context manager when a</span>
    <span class="c1"># pipeline is called (see Pipeline.__call__ for more context)</span>
    <span class="n">ACTIVE_PIPELINE</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Pipeline&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">entrypoint</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span>
        <span class="n">enable_cache</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_artifact_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_artifact_visualization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_step_logs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">extra</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_failure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_success</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">substitutions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the pipeline.</span>
<span class="sd">            entrypoint: The entrypoint function of the pipeline.</span>
<span class="sd">            enable_cache: If caching should be enabled for this pipeline.</span>
<span class="sd">            enable_artifact_metadata: If artifact metadata should be enabled for</span>
<span class="sd">                this pipeline.</span>
<span class="sd">            enable_artifact_visualization: If artifact visualization should be</span>
<span class="sd">                enabled for this pipeline.</span>
<span class="sd">            enable_step_logs: If step logs should be enabled for this pipeline.</span>
<span class="sd">            settings: Settings for this pipeline.</span>
<span class="sd">            tags: Tags to apply to runs of this pipeline.</span>
<span class="sd">            extra: Extra configurations for this pipeline.</span>
<span class="sd">            on_failure: Callback function in event of failure of the step. Can</span>
<span class="sd">                be a function with a single argument of type `BaseException`, or</span>
<span class="sd">                a source path to such a function (e.g. `module.my_function`).</span>
<span class="sd">            on_success: Callback function in event of success of the step. Can</span>
<span class="sd">                be a function with no arguments, or a source path to such a</span>
<span class="sd">                function (e.g. `module.my_function`).</span>
<span class="sd">            model: configuration of the model in the Model Control Plane.</span>
<span class="sd">            substitutions: Extra placeholders to use in the name templates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invocations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StepInvocation</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span> <span class="o">=</span> <span class="n">PipelineConfiguration</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_configure_warnings__</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
                <span class="n">enable_cache</span><span class="o">=</span><span class="n">enable_cache</span><span class="p">,</span>
                <span class="n">enable_artifact_metadata</span><span class="o">=</span><span class="n">enable_artifact_metadata</span><span class="p">,</span>
                <span class="n">enable_artifact_visualization</span><span class="o">=</span><span class="n">enable_artifact_visualization</span><span class="p">,</span>
                <span class="n">enable_step_logs</span><span class="o">=</span><span class="n">enable_step_logs</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
                <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
                <span class="n">extra</span><span class="o">=</span><span class="n">extra</span><span class="p">,</span>
                <span class="n">on_failure</span><span class="o">=</span><span class="n">on_failure</span><span class="p">,</span>
                <span class="n">on_success</span><span class="o">=</span><span class="n">on_success</span><span class="p">,</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                <span class="n">substitutions</span><span class="o">=</span><span class="n">substitutions</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span> <span class="o">=</span> <span class="n">entrypoint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of the pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">enable_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If caching is enabled for the pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            If caching is enabled for the pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">enable_cache</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PipelineConfiguration</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The configuration of the pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The configuration of the pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">invocations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StepInvocation</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the step invocations of this pipeline.</span>

<span class="sd">        This dictionary will only be populated once the pipeline has been</span>
<span class="sd">        called.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The step invocations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invocations</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Source&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolves the pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The pipeline source.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span> <span class="n">skip_validation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">source_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The source object of this pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The source object of this pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">source_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The source code of this pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The source code of this pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_object</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PipelineResponse&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the registered pipeline model for this instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The registered pipeline model.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the pipeline has not been registered yet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>

        <span class="n">pipelines</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">list_pipelines</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pipelines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pipelines</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Cannot get the model of pipeline &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; because it has &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;not been registered yet. Please ensure that the pipeline has &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;been run or built and try again.&quot;</span>
        <span class="p">)</span>

    <span class="nd">@contextmanager</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__suppress_configure_warnings__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager to suppress warnings in `Pipeline.configure(...)`.</span>

<span class="sd">        Used to suppress warnings when called from inner code and not user-facing code.</span>

<span class="sd">        Yields:</span>
<span class="sd">            Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">yield</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">enable_cache</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_artifact_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_artifact_visualization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_step_logs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">extra</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_failure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_success</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">merge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">substitutions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configures the pipeline.</span>

<span class="sd">        Configuration merging example:</span>
<span class="sd">        * `merge==True`:</span>
<span class="sd">            pipeline.configure(extra={&quot;key1&quot;: 1})</span>
<span class="sd">            pipeline.configure(extra={&quot;key2&quot;: 2}, merge=True)</span>
<span class="sd">            pipeline.configuration.extra # {&quot;key1&quot;: 1, &quot;key2&quot;: 2}</span>
<span class="sd">        * `merge==False`:</span>
<span class="sd">            pipeline.configure(extra={&quot;key1&quot;: 1})</span>
<span class="sd">            pipeline.configure(extra={&quot;key2&quot;: 2}, merge=False)</span>
<span class="sd">            pipeline.configuration.extra # {&quot;key2&quot;: 2}</span>

<span class="sd">        Args:</span>
<span class="sd">            enable_cache: If caching should be enabled for this pipeline.</span>
<span class="sd">            enable_artifact_metadata: If artifact metadata should be enabled for</span>
<span class="sd">                this pipeline.</span>
<span class="sd">            enable_artifact_visualization: If artifact visualization should be</span>
<span class="sd">                enabled for this pipeline.</span>
<span class="sd">            enable_step_logs: If step logs should be enabled for this pipeline.</span>
<span class="sd">            settings: settings for this pipeline.</span>
<span class="sd">            tags: Tags to apply to runs of this pipeline.</span>
<span class="sd">            extra: Extra configurations for this pipeline.</span>
<span class="sd">            on_failure: Callback function in event of failure of the step. Can</span>
<span class="sd">                be a function with a single argument of type `BaseException`, or</span>
<span class="sd">                a source path to such a function (e.g. `module.my_function`).</span>
<span class="sd">            on_success: Callback function in event of success of the step. Can</span>
<span class="sd">                be a function with no arguments, or a source path to such a</span>
<span class="sd">                function (e.g. `module.my_function`).</span>
<span class="sd">            merge: If `True`, will merge the given dictionary configurations</span>
<span class="sd">                like `extra` and `settings` with existing</span>
<span class="sd">                configurations. If `False` the given configurations will</span>
<span class="sd">                overwrite all existing ones. See the general description of this</span>
<span class="sd">                method for an example.</span>
<span class="sd">            model: configuration of the model version in the Model Control Plane.</span>
<span class="sd">            parameters: input parameters for the pipeline.</span>
<span class="sd">            substitutions: Extra placeholders to use in the name templates.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The pipeline instance that this method was called on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">failure_hook_source</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">on_failure</span><span class="p">:</span>
            <span class="c1"># string of on_failure hook function to be used for this pipeline</span>
            <span class="n">failure_hook_source</span> <span class="o">=</span> <span class="n">resolve_and_validate_hook</span><span class="p">(</span><span class="n">on_failure</span><span class="p">)</span>

        <span class="n">success_hook_source</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">on_success</span><span class="p">:</span>
            <span class="c1"># string of on_success hook function to be used for this pipeline</span>
            <span class="n">success_hook_source</span> <span class="o">=</span> <span class="n">resolve_and_validate_hook</span><span class="p">(</span><span class="n">on_success</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">merge</span> <span class="ow">and</span> <span class="n">tags</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
            <span class="c1"># Merge tags explicitly here as the recursive update later only</span>
            <span class="c1"># merges dicts</span>
            <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span><span class="o">.</span><span class="n">tags</span> <span class="o">+</span> <span class="n">tags</span>

        <span class="n">values</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">remove_none_values</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;enable_cache&quot;</span><span class="p">:</span> <span class="n">enable_cache</span><span class="p">,</span>
                <span class="s2">&quot;enable_artifact_metadata&quot;</span><span class="p">:</span> <span class="n">enable_artifact_metadata</span><span class="p">,</span>
                <span class="s2">&quot;enable_artifact_visualization&quot;</span><span class="p">:</span> <span class="n">enable_artifact_visualization</span><span class="p">,</span>
                <span class="s2">&quot;enable_step_logs&quot;</span><span class="p">:</span> <span class="n">enable_step_logs</span><span class="p">,</span>
                <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="p">,</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">tags</span><span class="p">,</span>
                <span class="s2">&quot;extra&quot;</span><span class="p">:</span> <span class="n">extra</span><span class="p">,</span>
                <span class="s2">&quot;failure_hook_source&quot;</span><span class="p">:</span> <span class="n">failure_hook_source</span><span class="p">,</span>
                <span class="s2">&quot;success_hook_source&quot;</span><span class="p">:</span> <span class="n">success_hook_source</span><span class="p">,</span>
                <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
                <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="n">parameters</span><span class="p">,</span>
                <span class="s2">&quot;substitutions&quot;</span><span class="p">:</span> <span class="n">substitutions</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span><span class="p">:</span>
            <span class="n">to_be_reapplied</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">param_</span><span class="p">,</span> <span class="n">value_</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">param_</span> <span class="ow">in</span> <span class="n">PipelineRunConfiguration</span><span class="o">.</span><span class="n">model_fields</span>
                    <span class="ow">and</span> <span class="n">param_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span>
                    <span class="ow">and</span> <span class="n">value_</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">[</span><span class="n">param_</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">to_be_reapplied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">param_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">[</span><span class="n">param_</span><span class="p">],</span> <span class="n">value_</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="n">to_be_reapplied</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">reapply_during_run_warning</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;The value of parameter &#39;</span><span class="si">{name}</span><span class="s2">&#39; has changed from &quot;</span>
                    <span class="s2">&quot;&#39;</span><span class="si">{file_value}</span><span class="s2">&#39; to &#39;</span><span class="si">{new_value}</span><span class="s2">&#39; set in your configuration &quot;</span>
                    <span class="s2">&quot;file.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_value</span><span class="p">,</span> <span class="n">new_value</span> <span class="ow">in</span> <span class="n">to_be_reapplied</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="n">reapply_during_run_warning</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">file_value</span><span class="o">=</span><span class="n">file_value</span><span class="p">,</span> <span class="n">new_value</span><span class="o">=</span><span class="n">new_value</span>
                    <span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="s2">&quot;Configuration file value will be used during pipeline &quot;</span>
                    <span class="s2">&quot;run, so you change will not be efficient. Consider &quot;</span>
                    <span class="s2">&quot;updating your configuration file instead.&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">config</span> <span class="o">=</span> <span class="n">PipelineConfigurationUpdate</span><span class="p">(</span><span class="o">**</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_configuration</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="n">merge</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">required_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of required parameters for the pipeline entrypoint.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of required parameters for the pipeline entrypoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span> <span class="n">follow_wrapped</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">name</span>
            <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">signature</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span>
        <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">missing_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of missing parameters for the pipeline entrypoint.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of missing parameters for the pipeline entrypoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">available_parameters</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">parameters</span> <span class="ow">or</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">params_from_file</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">available_parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params_from_file</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required_parameters</span><span class="p">)</span> <span class="o">-</span> <span class="n">available_parameters</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_prepared</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If the pipeline is prepared.</span>

<span class="sd">        Prepared means that the pipeline entrypoint has been called and the</span>
<span class="sd">        pipeline is fully defined.</span>

<span class="sd">        Returns:</span>
<span class="sd">            If the pipeline is prepared.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">invocations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares the pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: Pipeline entrypoint input arguments.</span>
<span class="sd">            **kwargs: Pipeline entrypoint input keyword arguments.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the pipeline has parameters configured differently in</span>
<span class="sd">                configuration file and code.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Clear existing parameters and invocations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invocations</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">conflicting_parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">parameters_</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">parameters</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">from_file_</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">parameters_</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">recursive_update</span><span class="p">(</span><span class="n">parameters_</span><span class="p">,</span> <span class="n">from_file_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parameters_</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v_runtime</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters_</span><span class="p">:</span>
                    <span class="n">v_config</span> <span class="o">=</span> <span class="n">parameters_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">v_config</span> <span class="o">!=</span> <span class="n">v_runtime</span><span class="p">:</span>
                        <span class="n">conflicting_parameters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_config</span><span class="p">,</span> <span class="n">v_runtime</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">conflicting_parameters</span><span class="p">:</span>
                <span class="n">is_plural</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">conflicting_parameters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Configured parameter</span><span class="si">{</span><span class="n">is_plural</span><span class="si">}</span><span class="s2"> for the pipeline `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` conflict</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">is_plural</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;s&#39;</span><span class="si">}</span><span class="s2"> with parameter</span><span class="si">{</span><span class="n">is_plural</span><span class="si">}</span><span class="s2"> passed in runtime:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">conflicting_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">`: config=`</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">` | runtime=`</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">`</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;This happens, if you define values for pipeline parameters in configuration file and pass same parameters from the code. Example:</span>
<span class="s2">```</span>
<span class="s2"># config.yaml</span>
<span class="s2">    parameters:</span>
<span class="s2">        param_name: value1</span>


<span class="s2"># pipeline.py</span>
<span class="s2">@pipeline</span>
<span class="s2">def pipeline_(param_name: str):</span>
<span class="s2">    step_name()</span>

<span class="s2">if __name__==&quot;__main__&quot;:</span>
<span class="s2">    pipeline_.with_options(config_path=&quot;config.yaml&quot;)(param_name=&quot;value2&quot;)</span>
<span class="s2">```</span>
<span class="s2">To avoid this consider setting pipeline parameters only in one place (config or code).</span>
<span class="s2">&quot;&quot;&quot;</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v_config</span> <span class="ow">in</span> <span class="n">parameters_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_config</span>

        <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
            <span class="c1"># Enter the context manager, so we become the active pipeline. This</span>
            <span class="c1"># means that all steps that get called while the entrypoint function</span>
            <span class="c1"># is executed will be added as invocation to this pipeline instance.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_call_entrypoint</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PipelineResponse&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register the pipeline in the server.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The registered pipeline model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Activating the built-in integrations to load all materializers</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.integrations.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">integration_registry</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>
        <span class="n">integration_registry</span><span class="o">.</span><span class="n">activate_integrations</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span>
            <span class="n">exclude_defaults</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">}</span>
        <span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The pipeline `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` that you&#39;re registering has &quot;</span>
                <span class="s2">&quot;custom configurations applied to it. These will not be &quot;</span>
                <span class="s2">&quot;registered with the pipeline and won&#39;t be set when you build &quot;</span>
                <span class="s2">&quot;images or run the pipeline from the CLI. To provide these &quot;</span>
                <span class="s2">&quot;configurations, use the `--config` option of the `zenml &quot;</span>
                <span class="s2">&quot;pipeline build/run` commands.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">step_configurations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
            <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;StepConfigurationUpdateOrDict&quot;</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineBuildResponse&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Builds Docker images for the pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            settings: Settings for the pipeline.</span>
<span class="sd">            step_configurations: Configurations for steps of the pipeline.</span>
<span class="sd">            config_path: Path to a yaml configuration file. This file will</span>
<span class="sd">                be parsed as a</span>
<span class="sd">                `zenml.config.pipeline_configurations.PipelineRunConfiguration`</span>
<span class="sd">                object. Options provided in this file will be overwritten by</span>
<span class="sd">                options provided in code using the other arguments of this</span>
<span class="sd">                method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The build output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">track_handler</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">AnalyticsEvent</span><span class="o">.</span><span class="n">BUILD_PIPELINE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>

            <span class="n">compile_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_args</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">compile_args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;unlisted&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">compile_args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;prevent_build_reuse&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">config_path</span><span class="p">:</span>
                <span class="n">compile_args</span><span class="p">[</span><span class="s2">&quot;config_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_path</span>
            <span class="k">if</span> <span class="n">step_configurations</span><span class="p">:</span>
                <span class="n">compile_args</span><span class="p">[</span><span class="s2">&quot;step_configurations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_configurations</span>
            <span class="k">if</span> <span class="n">settings</span><span class="p">:</span>
                <span class="n">compile_args</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span>

            <span class="n">deployment</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile</span><span class="p">(</span><span class="o">**</span><span class="n">compile_args</span><span class="p">)</span>
            <span class="n">pipeline_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register</span><span class="p">()</span><span class="o">.</span><span class="n">id</span>

            <span class="n">local_repo</span> <span class="o">=</span> <span class="n">code_repository_utils</span><span class="o">.</span><span class="n">find_active_code_repository</span><span class="p">()</span>
            <span class="n">code_repository</span> <span class="o">=</span> <span class="n">build_utils</span><span class="o">.</span><span class="n">verify_local_repository_context</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">local_repo_context</span><span class="o">=</span><span class="n">local_repo</span>
            <span class="p">)</span>

            <span class="k">return</span> <span class="n">build_utils</span><span class="o">.</span><span class="n">create_pipeline_build</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
                <span class="n">pipeline_id</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
                <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_deployment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_cache</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_artifact_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_artifact_visualization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_step_logs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Schedule</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">build</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;UUID&quot;</span><span class="p">,</span> <span class="s2">&quot;PipelineBuildBase&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">step_configurations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
            <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;StepConfigurationUpdateOrDict&quot;</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">extra</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unlisted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prevent_build_reuse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">skip_schedule_registration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PipelineDeploymentResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pipeline deployment.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_name: Name of the pipeline run.</span>
<span class="sd">            enable_cache: If caching should be enabled for this pipeline run.</span>
<span class="sd">            enable_artifact_metadata: If artifact metadata should be enabled</span>
<span class="sd">                for this pipeline run.</span>
<span class="sd">            enable_artifact_visualization: If artifact visualization should be</span>
<span class="sd">                enabled for this pipeline run.</span>
<span class="sd">            enable_step_logs: If step logs should be enabled for this pipeline.</span>
<span class="sd">            schedule: Optional schedule to use for the run.</span>
<span class="sd">            build: Optional build to use for the run.</span>
<span class="sd">            settings: Settings for this pipeline run.</span>
<span class="sd">            step_configurations: Configurations for steps of the pipeline.</span>
<span class="sd">            extra: Extra configurations for this pipeline run.</span>
<span class="sd">            config_path: Path to a yaml configuration file. This file will</span>
<span class="sd">                be parsed as a</span>
<span class="sd">                `zenml.config.pipeline_configurations.PipelineRunConfiguration`</span>
<span class="sd">                object. Options provided in this file will be overwritten by</span>
<span class="sd">                options provided in code using the other arguments of this</span>
<span class="sd">                method.</span>
<span class="sd">            unlisted: Whether the pipeline run should be unlisted (not assigned</span>
<span class="sd">                to any pipeline).</span>
<span class="sd">            prevent_build_reuse: DEPRECATED: Use</span>
<span class="sd">                `DockerSettings.prevent_build_reuse` instead.</span>
<span class="sd">            skip_schedule_registration: Whether to skip schedule registration.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The pipeline deployment.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the orchestrator doesn&#39;t support scheduling, but a</span>
<span class="sd">                schedule was given</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">deployment</span><span class="p">,</span> <span class="n">schedule</span><span class="p">,</span> <span class="n">build</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile</span><span class="p">(</span>
            <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span>
            <span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span><span class="p">,</span>
            <span class="n">enable_cache</span><span class="o">=</span><span class="n">enable_cache</span><span class="p">,</span>
            <span class="n">enable_artifact_metadata</span><span class="o">=</span><span class="n">enable_artifact_metadata</span><span class="p">,</span>
            <span class="n">enable_artifact_visualization</span><span class="o">=</span><span class="n">enable_artifact_visualization</span><span class="p">,</span>
            <span class="n">enable_step_logs</span><span class="o">=</span><span class="n">enable_step_logs</span><span class="p">,</span>
            <span class="n">steps</span><span class="o">=</span><span class="n">step_configurations</span><span class="p">,</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
            <span class="n">schedule</span><span class="o">=</span><span class="n">schedule</span><span class="p">,</span>
            <span class="n">build</span><span class="o">=</span><span class="n">build</span><span class="p">,</span>
            <span class="n">extra</span><span class="o">=</span><span class="n">extra</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">skip_pipeline_registration</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">handle_bool_env_var</span><span class="p">(</span>
            <span class="n">constants</span><span class="o">.</span><span class="n">ENV_ZENML_SKIP_PIPELINE_REGISTRATION</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">register_pipeline</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span><span class="n">skip_pipeline_registration</span> <span class="ow">or</span> <span class="n">unlisted</span><span class="p">)</span>

        <span class="n">pipeline_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">register_pipeline</span><span class="p">:</span>
            <span class="n">pipeline_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register</span><span class="p">()</span><span class="o">.</span><span class="n">id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pipeline </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is unlisted.&quot;</span><span class="p">)</span>

        <span class="n">stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="n">schedule_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">schedule</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_schedule_registration</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">orchestrator</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">is_schedulable</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Stack </span><span class="si">{</span><span class="n">stack</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> does not support scheduling. &quot;</span>
                    <span class="s2">&quot;Not all orchestrator types support scheduling, &quot;</span>
                    <span class="s2">&quot;kindly consult with &quot;</span>
                    <span class="s2">&quot;https://docs.zenml.io/how-to/build-pipelines/schedule-a-pipeline &quot;</span>
                    <span class="s2">&quot;for details.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">schedule</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">schedule_name</span> <span class="o">=</span> <span class="n">schedule</span><span class="o">.</span><span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">schedule_name</span> <span class="o">=</span> <span class="n">format_name_template</span><span class="p">(</span>
                    <span class="n">deployment</span><span class="o">.</span><span class="n">run_name_template</span><span class="p">,</span>
                    <span class="n">substitutions</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">substitutions</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack_model</span><span class="o">.</span><span class="n">components</span>
            <span class="n">orchestrator</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="n">StackComponentType</span><span class="o">.</span><span class="n">ORCHESTRATOR</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">schedule_model</span> <span class="o">=</span> <span class="n">ScheduleRequest</span><span class="p">(</span>
                <span class="n">workspace</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_workspace</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">user</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">pipeline_id</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
                <span class="n">orchestrator_id</span><span class="o">=</span><span class="n">orchestrator</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">schedule_name</span><span class="p">,</span>
                <span class="n">active</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">cron_expression</span><span class="o">=</span><span class="n">schedule</span><span class="o">.</span><span class="n">cron_expression</span><span class="p">,</span>
                <span class="n">start_time</span><span class="o">=</span><span class="n">schedule</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span>
                <span class="n">end_time</span><span class="o">=</span><span class="n">schedule</span><span class="o">.</span><span class="n">end_time</span><span class="p">,</span>
                <span class="n">interval_second</span><span class="o">=</span><span class="n">schedule</span><span class="o">.</span><span class="n">interval_second</span><span class="p">,</span>
                <span class="n">catchup</span><span class="o">=</span><span class="n">schedule</span><span class="o">.</span><span class="n">catchup</span><span class="p">,</span>
                <span class="n">run_once_start_time</span><span class="o">=</span><span class="n">schedule</span><span class="o">.</span><span class="n">run_once_start_time</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">schedule_id</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">create_schedule</span><span class="p">(</span><span class="n">schedule_model</span><span class="p">)</span><span class="o">.</span><span class="n">id</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Created schedule `</span><span class="si">{</span><span class="n">schedule_name</span><span class="si">}</span><span class="s2">` for pipeline &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`.&quot;</span>
            <span class="p">)</span>

        <span class="n">stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="n">upload_notebook_cell_code_if_necessary</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span>
        <span class="p">)</span>

        <span class="n">local_repo_context</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">code_repository_utils</span><span class="o">.</span><span class="n">find_active_code_repository</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">code_repository</span> <span class="o">=</span> <span class="n">build_utils</span><span class="o">.</span><span class="n">verify_local_repository_context</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">local_repo_context</span><span class="o">=</span><span class="n">local_repo_context</span>
        <span class="p">)</span>
        <span class="n">can_download_from_code_repository</span> <span class="o">=</span> <span class="n">code_repository</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">local_repo_context</span><span class="p">:</span>
            <span class="n">build_utils</span><span class="o">.</span><span class="n">log_code_repository_usage</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">local_repo_context</span><span class="o">=</span><span class="n">local_repo_context</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">prevent_build_reuse</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Passing `prevent_build_reuse=True` to &quot;</span>
                <span class="s2">&quot;`pipeline.with_opitions(...)` is deprecated. Use &quot;</span>
                <span class="s2">&quot;`DockerSettings.prevent_build_reuse` instead.&quot;</span>
            <span class="p">)</span>

        <span class="n">build_model</span> <span class="o">=</span> <span class="n">build_utils</span><span class="o">.</span><span class="n">reuse_or_create_pipeline_build</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
            <span class="n">pipeline_id</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
            <span class="n">allow_build_reuse</span><span class="o">=</span><span class="ow">not</span> <span class="n">prevent_build_reuse</span><span class="p">,</span>
            <span class="n">build</span><span class="o">=</span><span class="n">build</span><span class="p">,</span>
            <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">build_id</span> <span class="o">=</span> <span class="n">build_model</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">build_model</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">code_reference</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">local_repo_context</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">local_repo_context</span><span class="o">.</span><span class="n">is_dirty</span><span class="p">:</span>
            <span class="n">source_root</span> <span class="o">=</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span>
            <span class="n">subdirectory</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Path</span><span class="p">(</span><span class="n">source_root</span><span class="p">)</span>
                <span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
                <span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">local_repo_context</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">code_reference</span> <span class="o">=</span> <span class="n">CodeReferenceRequest</span><span class="p">(</span>
                <span class="n">commit</span><span class="o">=</span><span class="n">local_repo_context</span><span class="o">.</span><span class="n">current_commit</span><span class="p">,</span>
                <span class="n">subdirectory</span><span class="o">=</span><span class="n">subdirectory</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
                <span class="n">code_repository</span><span class="o">=</span><span class="n">local_repo_context</span><span class="o">.</span><span class="n">code_repository</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">code_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">build_utils</span><span class="o">.</span><span class="n">should_upload_code</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
            <span class="n">build</span><span class="o">=</span><span class="n">build_model</span><span class="p">,</span>
            <span class="n">can_download_from_code_repository</span><span class="o">=</span><span class="n">can_download_from_code_repository</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">code_archive</span> <span class="o">=</span> <span class="n">code_utils</span><span class="o">.</span><span class="n">CodeArchive</span><span class="p">(</span>
                <span class="n">root</span><span class="o">=</span><span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Archiving pipeline code...&quot;</span><span class="p">)</span>
            <span class="n">code_path</span> <span class="o">=</span> <span class="n">code_utils</span><span class="o">.</span><span class="n">upload_code_if_necessary</span><span class="p">(</span><span class="n">code_archive</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">PipelineDeploymentRequest</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">workspace</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_workspace</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
            <span class="n">build</span><span class="o">=</span><span class="n">build_id</span><span class="p">,</span>
            <span class="n">schedule</span><span class="o">=</span><span class="n">schedule_id</span><span class="p">,</span>
            <span class="n">code_reference</span><span class="o">=</span><span class="n">code_reference</span><span class="p">,</span>
            <span class="n">code_path</span><span class="o">=</span><span class="n">code_path</span><span class="p">,</span>
            <span class="o">**</span><span class="n">deployment</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">create_deployment</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PipelineRunResponse</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the pipeline on the active stack.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The pipeline run or `None` if running with a schedule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">SHOULD_PREVENT_PIPELINE_EXECUTION</span><span class="p">:</span>
            <span class="c1"># An environment variable was set to stop the execution of</span>
            <span class="c1"># pipelines. This is done to prevent execution of module-level</span>
            <span class="c1"># pipeline.run() calls when importing modules needed to run a step.</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Preventing execution of pipeline &#39;</span><span class="si">%s</span><span class="s2">&#39;. If this is not &quot;</span>
                <span class="s2">&quot;intended behavior, make sure to unset the environment &quot;</span>
                <span class="s2">&quot;variable &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">constants</span><span class="o">.</span><span class="n">ENV_ZENML_PREVENT_PIPELINE_EXECUTION</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initiating a new run for the pipeline: `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">track_handler</span><span class="p">(</span><span class="n">AnalyticsEvent</span><span class="o">.</span><span class="n">RUN_PIPELINE</span><span class="p">)</span> <span class="k">as</span> <span class="n">analytics_handler</span><span class="p">:</span>
            <span class="n">stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>
            <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_deployment</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_args</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log_pipeline_deployment_metadata</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>
            <span class="n">run</span> <span class="o">=</span> <span class="n">create_placeholder_run</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>

            <span class="n">analytics_handler</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pipeline_analytics_metadata</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
                <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span>
                <span class="n">run_id</span><span class="o">=</span><span class="n">run</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">run</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">run</span><span class="p">:</span>
                <span class="n">run_url</span> <span class="o">=</span> <span class="n">dashboard_utils</span><span class="o">.</span><span class="n">get_run_url</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">run_url</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dashboard URL for Pipeline Run: </span><span class="si">{</span><span class="n">run_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="s2">&quot;You can visualize your pipeline runs in the `ZenML &quot;</span>
                        <span class="s2">&quot;Dashboard`. In order to try it locally, please run &quot;</span>
                        <span class="s2">&quot;`zenml login --local`.&quot;</span>
                    <span class="p">)</span>

            <span class="n">deploy_pipeline</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span> <span class="n">placeholder_run</span><span class="o">=</span><span class="n">run</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">run</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">get_pipeline_run</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log_pipeline_deployment_metadata</span><span class="p">(</span>
        <span class="n">deployment_model</span><span class="p">:</span> <span class="n">PipelineDeploymentResponse</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays logs based on the deployment model upon running a pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment_model: The model for the pipeline deployment</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Log about the caching status</span>
            <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_cache</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Caching is disabled by default for &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`.&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Log about the used builds</span>
            <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using a build:&quot;</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot; Image(s): &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">image</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="c1"># Log about version mismatches between local and build</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">zenml</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>

                <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">zenml_version</span> <span class="o">!=</span> <span class="n">__version__</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;ZenML version (different than the local version): &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">zenml_version</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                <span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">python_version</span>
                    <span class="o">!=</span> <span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">()</span>
                <span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Python version (different than the local version): &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

            <span class="c1"># Log about the user, stack and components</span>
            <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using user: `</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">stack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using stack: `</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="p">(</span>
                    <span class="n">component_type</span><span class="p">,</span>
                    <span class="n">component_models</span><span class="p">,</span>
                <span class="p">)</span> <span class="ow">in</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">component_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: `</span><span class="si">{</span><span class="n">component_models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span>
                    <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logging pipeline deployment metadata failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_run_configuration_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Stack&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes a run configuration yaml template.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: The path where the template will be written.</span>
<span class="sd">            stack: The stack for which the template should be generated. If</span>
<span class="sd">                not given, the active stack will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.config.base_settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConfigurationLevel</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.config.step_configurations</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
            <span class="n">PartialArtifactConfiguration</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>

        <span class="n">stack</span> <span class="o">=</span> <span class="n">stack</span> <span class="ow">or</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>

        <span class="n">setting_classes</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">setting_classes</span>
        <span class="n">setting_classes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings_utils</span><span class="o">.</span><span class="n">get_general_settings</span><span class="p">())</span>

        <span class="n">pipeline_settings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">step_settings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">setting_class</span> <span class="ow">in</span> <span class="n">setting_classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">TemplateGenerator</span><span class="p">(</span><span class="n">setting_class</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ConfigurationLevel</span><span class="o">.</span><span class="n">PIPELINE</span> <span class="ow">in</span> <span class="n">setting_class</span><span class="o">.</span><span class="n">LEVEL</span><span class="p">:</span>
                <span class="n">pipeline_settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
            <span class="k">if</span> <span class="n">ConfigurationLevel</span><span class="o">.</span><span class="n">STEP</span> <span class="ow">in</span> <span class="n">setting_class</span><span class="o">.</span><span class="n">LEVEL</span><span class="p">:</span>
                <span class="n">step_settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>

        <span class="n">steps</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">invocation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">invocations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">invocation</span><span class="o">.</span><span class="n">step</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">name</span><span class="p">:</span> <span class="n">PartialArtifactConfiguration</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">step</span><span class="o">.</span><span class="n">entrypoint_definition</span><span class="o">.</span><span class="n">outputs</span>
            <span class="p">}</span>
            <span class="n">step_template</span> <span class="o">=</span> <span class="n">StepConfigurationUpdate</span><span class="p">(</span>
                <span class="n">parameters</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">settings</span><span class="o">=</span><span class="n">step_settings</span><span class="p">,</span>
                <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">steps</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_template</span>

        <span class="n">run_config</span> <span class="o">=</span> <span class="n">PipelineRunConfiguration</span><span class="p">(</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">pipeline_settings</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span>
        <span class="p">)</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">TemplateGenerator</span><span class="p">(</span><span class="n">run_config</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">yaml_string</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
        <span class="n">yaml_string</span> <span class="o">=</span> <span class="n">yaml_utils</span><span class="o">.</span><span class="n">comment_out_yaml</span><span class="p">(</span><span class="n">yaml_string</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_string</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_configuration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="n">PipelineConfigurationUpdate</span><span class="p">,</span>
        <span class="n">merge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies an update to the pipeline configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: The configuration update.</span>
<span class="sd">            merge: Whether to merge the updates with the existing configuration</span>
<span class="sd">                or not. See the `BasePipeline.configure(...)` method for a</span>
<span class="sd">                detailed explanation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_configuration</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span> <span class="o">=</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">merge</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Updated pipeline configuration:&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_configuration</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">PipelineConfigurationUpdate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates a configuration update.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: The configuration update to validate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">settings_utils</span><span class="o">.</span><span class="n">validate_setting_keys</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">settings</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_pipeline_analytics_metadata</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
        <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the pipeline deployment metadata.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: The pipeline deployment to track.</span>
<span class="sd">            stack: The stack on which the pipeline will be deployed.</span>
<span class="sd">            run_id: The ID of the pipeline run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the metadata about the pipeline deployment</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">custom_materializer</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">materializer_source</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">source</span><span class="o">.</span><span class="n">is_internal</span><span class="p">:</span>
                        <span class="n">custom_materializer</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">stack_creator</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">get_stack</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">user</span>
        <span class="n">active_user</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_user</span>
        <span class="n">own_stack</span> <span class="o">=</span> <span class="n">stack_creator</span> <span class="ow">and</span> <span class="n">stack_creator</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">active_user</span><span class="o">.</span><span class="n">id</span>

        <span class="n">stack_metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">component_type</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">flavor</span>
            <span class="k">for</span> <span class="n">component_type</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;store_type&quot;</span><span class="p">:</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="o">**</span><span class="n">stack_metadata</span><span class="p">,</span>
            <span class="s2">&quot;total_steps&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">invocations</span><span class="p">),</span>
            <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="p">),</span>
            <span class="s2">&quot;custom_materializer&quot;</span><span class="p">:</span> <span class="n">custom_materializer</span><span class="p">,</span>
            <span class="s2">&quot;own_stack&quot;</span><span class="p">:</span> <span class="n">own_stack</span><span class="p">,</span>
            <span class="s2">&quot;pipeline_run_id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span> <span class="k">if</span> <span class="n">run_id</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">run_configuration_args</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
        <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span>
        <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Schedule&quot;</span><span class="p">],</span>
        <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PipelineBuildBase&quot;</span><span class="p">,</span> <span class="n">UUID</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compiles the pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            config_path: Path to a config file.</span>
<span class="sd">            **run_configuration_args: Configurations for the pipeline run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple containing the deployment, schedule and build of</span>
<span class="sd">            the compiled pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Activating the built-in integrations to load all materializers</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.integrations.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">integration_registry</span>

        <span class="n">integration_registry</span><span class="o">.</span><span class="n">activate_integrations</span><span class="p">()</span>

        <span class="n">_from_config_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_config_file</span><span class="p">(</span>
            <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span>
            <span class="n">matcher</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">PipelineRunConfiguration</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_reconfigure_from_file_with_overrides</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">)</span>

        <span class="n">run_config</span> <span class="o">=</span> <span class="n">PipelineRunConfiguration</span><span class="p">(</span><span class="o">**</span><span class="n">_from_config_file</span><span class="p">)</span>

        <span class="n">new_values</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">remove_none_values</span><span class="p">(</span><span class="n">run_configuration_args</span><span class="p">)</span>
        <span class="n">update</span> <span class="o">=</span> <span class="n">PipelineRunConfiguration</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">new_values</span><span class="p">)</span>

        <span class="c1"># Update with the values in code so they take precedence</span>
        <span class="n">run_config</span> <span class="o">=</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">run_config</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">)</span>
        <span class="n">run_config</span> <span class="o">=</span> <span class="n">env_utils</span><span class="o">.</span><span class="n">substitute_env_variable_placeholders</span><span class="p">(</span><span class="n">run_config</span><span class="p">)</span>

        <span class="n">deployment</span> <span class="o">=</span> <span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">stack</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span><span class="p">,</span>
            <span class="n">run_configuration</span><span class="o">=</span><span class="n">run_config</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="n">env_utils</span><span class="o">.</span><span class="n">substitute_env_variable_placeholders</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">deployment</span><span class="p">,</span> <span class="n">run_config</span><span class="o">.</span><span class="n">schedule</span><span class="p">,</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PipelineResponse&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register the pipeline in the server.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The registered pipeline model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_get</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">PipelineResponse</span><span class="p">:</span>
            <span class="n">matching_pipelines</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_pipelines</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;desc:created&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">matching_pipelines</span><span class="o">.</span><span class="n">total</span><span class="p">:</span>
                <span class="n">registered_pipeline</span> <span class="o">=</span> <span class="n">matching_pipelines</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">registered_pipeline</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching pipelines found.&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_get</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="n">request</span> <span class="o">=</span> <span class="n">PipelineRequest</span><span class="p">(</span>
                <span class="n">workspace</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">active_workspace</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">user</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">active_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">registered_pipeline</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">create_pipeline</span><span class="p">(</span>
                    <span class="n">pipeline</span><span class="o">=</span><span class="n">request</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;Registered new pipeline: `</span><span class="si">%s</span><span class="s2">`.&quot;</span><span class="p">,</span>
                    <span class="n">registered_pipeline</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="n">registered_pipeline</span>
            <span class="k">except</span> <span class="n">EntityExistsError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_get</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compute_unique_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_spec</span><span class="p">:</span> <span class="n">PipelineSpec</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes a unique identifier from the pipeline spec and steps.</span>

<span class="sd">        Args:</span>
<span class="sd">            pipeline_spec: Compiled spec of the pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The unique identifier of the pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">packaging</span><span class="w"> </span><span class="kn">import</span> <span class="n">version</span>

        <span class="n">hash_</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>  <span class="c1"># nosec</span>
        <span class="n">hash_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pipeline_spec</span><span class="o">.</span><span class="n">json_with_string_sources</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">pipeline_spec</span><span class="o">.</span><span class="n">version</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;0.4&quot;</span><span class="p">):</span>
            <span class="c1"># Only add this for newer versions to keep backwards compatibility</span>
            <span class="n">hash_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_code</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">step_spec</span> <span class="ow">in</span> <span class="n">pipeline_spec</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
            <span class="n">invocation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">invocations</span><span class="p">[</span><span class="n">step_spec</span><span class="o">.</span><span class="n">pipeline_parameter_name</span><span class="p">]</span>
            <span class="n">step_source</span> <span class="o">=</span> <span class="n">invocation</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">source_code</span>
            <span class="n">hash_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">step_source</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">hash_</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_step_invocation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">step</span><span class="p">:</span> <span class="s2">&quot;BaseStep&quot;</span><span class="p">,</span>
        <span class="n">input_artifacts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StepArtifact</span><span class="p">],</span>
        <span class="n">external_artifacts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ExternalArtifact&quot;</span><span class="p">,</span> <span class="s2">&quot;ArtifactVersionResponse&quot;</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="n">model_artifacts_or_metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;ModelVersionDataLazyLoader&quot;</span><span class="p">],</span>
        <span class="n">client_lazy_loaders</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;ClientLazyLoader&quot;</span><span class="p">],</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">default_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">upstream_steps</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">custom_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">allow_id_suffix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a step invocation to the pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            step: The step for which to add an invocation.</span>
<span class="sd">            input_artifacts: The input artifacts for the invocation.</span>
<span class="sd">            external_artifacts: The external artifacts for the invocation.</span>
<span class="sd">            model_artifacts_or_metadata: The model artifacts or metadata for</span>
<span class="sd">                the invocation.</span>
<span class="sd">            client_lazy_loaders: The client lazy loaders for the invocation.</span>
<span class="sd">            parameters: The parameters for the invocation.</span>
<span class="sd">            default_parameters: The default parameters for the invocation.</span>
<span class="sd">            upstream_steps: The upstream steps for the invocation.</span>
<span class="sd">            custom_id: Custom ID to use for the invocation.</span>
<span class="sd">            allow_id_suffix: Whether a suffix can be appended to the invocation</span>
<span class="sd">                ID.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the method is called on an inactive pipeline.</span>
<span class="sd">            RuntimeError: If the invocation was called with an artifact from</span>
<span class="sd">                a different pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The step invocation ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;A step invocation can only be added to an active pipeline.&quot;</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="n">input_artifacts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">artifact</span><span class="o">.</span><span class="n">pipeline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Got invalid input artifact for invocation of step &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">step</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: The input artifact was produced by a step &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;inside a different pipeline </span><span class="si">{</span><span class="n">artifact</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="n">invocation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_invocation_id</span><span class="p">(</span>
            <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">,</span> <span class="n">allow_suffix</span><span class="o">=</span><span class="n">allow_id_suffix</span>
        <span class="p">)</span>
        <span class="n">invocation</span> <span class="o">=</span> <span class="n">StepInvocation</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">invocation_id</span><span class="p">,</span>
            <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span>
            <span class="n">input_artifacts</span><span class="o">=</span><span class="n">input_artifacts</span><span class="p">,</span>
            <span class="n">external_artifacts</span><span class="o">=</span><span class="n">external_artifacts</span><span class="p">,</span>
            <span class="n">model_artifacts_or_metadata</span><span class="o">=</span><span class="n">model_artifacts_or_metadata</span><span class="p">,</span>
            <span class="n">client_lazy_loaders</span><span class="o">=</span><span class="n">client_lazy_loaders</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
            <span class="n">default_parameters</span><span class="o">=</span><span class="n">default_parameters</span><span class="p">,</span>
            <span class="n">upstream_steps</span><span class="o">=</span><span class="n">upstream_steps</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invocations</span><span class="p">[</span><span class="n">invocation_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">invocation</span>
        <span class="k">return</span> <span class="n">invocation_id</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compute_invocation_id</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">step</span><span class="p">:</span> <span class="s2">&quot;BaseStep&quot;</span><span class="p">,</span>
        <span class="n">custom_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">allow_suffix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the invocation ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            step: The step for which to compute the ID.</span>
<span class="sd">            custom_id: Custom ID to use for the invocation.</span>
<span class="sd">            allow_suffix: Whether a suffix can be appended to the invocation</span>
<span class="sd">                ID.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If no ID suffix is allowed and an invocation for the</span>
<span class="sd">                same ID already exists.</span>
<span class="sd">            RuntimeError: If no unique invocation ID can be found.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The invocation ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="n">id_</span> <span class="o">=</span> <span class="n">custom_id</span> <span class="ow">or</span> <span class="n">step</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="n">id_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">invocations</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">id_</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_suffix</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Duplicate step ID&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
            <span class="n">id_</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">id_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">invocations</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">id_</span>

        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to find step ID&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Activate the pipeline context.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If a different pipeline is already active.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The pipeline instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Unable to enter pipeline context. A different pipeline &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is already active.&quot;</span>
            <span class="p">)</span>

        <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deactivates the pipeline context.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: The arguments passed to the context exit handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_config_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parses the given configuration file and sets `self._from_config_file`.</span>

<span class="sd">        Args:</span>
<span class="sd">            config_path: Path to a yaml configuration file.</span>
<span class="sd">            matcher: List of keys to match in the configuration file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parsed config file according to matcher settings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_from_config_file</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">config_path</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">_from_config_file</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">)</span>

            <span class="n">_from_config_file</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">remove_none_values</span><span class="p">(</span>
                <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">_from_config_file</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">matcher</span><span class="p">}</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;model&quot;</span> <span class="ow">in</span> <span class="n">_from_config_file</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;model&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">:</span>
                    <span class="n">_from_config_file</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">[</span>
                        <span class="s2">&quot;model&quot;</span>
                    <span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.model.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Model</span>

                    <span class="n">_from_config_file</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span>
                        <span class="n">_from_config_file</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="n">_from_config_file</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">with_options</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Schedule</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">build</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;UUID&quot;</span><span class="p">,</span> <span class="s2">&quot;PipelineBuildBase&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">step_configurations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
            <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;StepConfigurationUpdateOrDict&quot;</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;StepConfigurationUpdateOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unlisted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prevent_build_reuse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pipeline&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copies the pipeline and applies the given configurations.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_name: Name of the pipeline run.</span>
<span class="sd">            schedule: Optional schedule to use for the run.</span>
<span class="sd">            build: Optional build to use for the run.</span>
<span class="sd">            step_configurations: Configurations for steps of the pipeline.</span>
<span class="sd">            steps: Configurations for steps of the pipeline. This is equivalent</span>
<span class="sd">                to `step_configurations`, and will be ignored if</span>
<span class="sd">                `step_configurations` is set as well.</span>
<span class="sd">            config_path: Path to a yaml configuration file. This file will</span>
<span class="sd">                be parsed as a</span>
<span class="sd">                `zenml.config.pipeline_configurations.PipelineRunConfiguration`</span>
<span class="sd">                object. Options provided in this file will be overwritten by</span>
<span class="sd">                options provided in code using the other arguments of this</span>
<span class="sd">                method.</span>
<span class="sd">            unlisted: Whether the pipeline run should be unlisted (not assigned</span>
<span class="sd">                to any pipeline).</span>
<span class="sd">            prevent_build_reuse: DEPRECATED: Use</span>
<span class="sd">                `DockerSettings.prevent_build_reuse` instead.</span>
<span class="sd">            **kwargs: Pipeline configuration options. These will be passed</span>
<span class="sd">                to the `pipeline.configure(...)` method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The copied pipeline instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">steps</span> <span class="ow">and</span> <span class="n">step_configurations</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Step configurations were passed using both the &quot;</span>
                <span class="s2">&quot;`step_configurations` and `steps` keywords, ignoring the &quot;</span>
                <span class="s2">&quot;values passed using the `steps` keyword.&quot;</span>
            <span class="p">)</span>

        <span class="n">pipeline_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">pipeline_copy</span><span class="o">.</span><span class="n">_reconfigure_from_file_with_overrides</span><span class="p">(</span>
            <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="n">run_args</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">remove_none_values</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;run_name&quot;</span><span class="p">:</span> <span class="n">run_name</span><span class="p">,</span>
                <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="n">schedule</span><span class="p">,</span>
                <span class="s2">&quot;build&quot;</span><span class="p">:</span> <span class="n">build</span><span class="p">,</span>
                <span class="s2">&quot;step_configurations&quot;</span><span class="p">:</span> <span class="n">step_configurations</span> <span class="ow">or</span> <span class="n">steps</span><span class="p">,</span>
                <span class="s2">&quot;config_path&quot;</span><span class="p">:</span> <span class="n">config_path</span><span class="p">,</span>
                <span class="s2">&quot;unlisted&quot;</span><span class="p">:</span> <span class="n">unlisted</span><span class="p">,</span>
                <span class="s2">&quot;prevent_build_reuse&quot;</span><span class="p">:</span> <span class="n">prevent_build_reuse</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">pipeline_copy</span><span class="o">.</span><span class="n">_run_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">run_args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pipeline_copy</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pipeline&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copies the pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The pipeline copy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PipelineRunResponse</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a call of the pipeline.</span>

<span class="sd">        This method does one of two things:</span>
<span class="sd">        * If there is an active pipeline context, it calls the pipeline</span>
<span class="sd">          entrypoint function within that context and the step invocations</span>
<span class="sd">          will be added to the active pipeline.</span>
<span class="sd">        * If no pipeline is active, it activates this pipeline before calling</span>
<span class="sd">          the entrypoint function.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: Entrypoint function arguments.</span>
<span class="sd">            **kwargs: Entrypoint function keyword arguments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            If called within another pipeline, returns the outputs of the</span>
<span class="sd">            `entrypoint` method. Otherwise, returns the pipeline run or `None`</span>
<span class="sd">            if running with a schedule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span><span class="p">:</span>
            <span class="c1"># Calling a pipeline inside a pipeline, we return the potential</span>
            <span class="c1"># outputs of the entrypoint function</span>

            <span class="c1"># TODO: This currently ignores the configuration of the pipeline</span>
            <span class="c1">#   and instead applies the configuration of the previously active</span>
            <span class="c1">#   pipeline. Is this what we want?</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_call_entrypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calls the pipeline entrypoint function with the given arguments.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: Entrypoint function arguments.</span>
<span class="sd">            **kwargs: Entrypoint function keyword arguments.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If an input argument is missing or not JSON</span>
<span class="sd">                serializable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validated_args</span> <span class="o">=</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">validate_function_args</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span>
                <span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid or missing pipeline function entrypoint arguments. &quot;</span>
                <span class="s2">&quot;Only JSON serializable inputs are allowed as pipeline inputs. &quot;</span>
                <span class="s2">&quot;Check out the pydantic error above for more details.&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">validated_args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">(</span><span class="o">**</span><span class="n">validated_args</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_if_possible</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares the pipeline if possible.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the pipeline is not prepared and the preparation</span>
<span class="sd">                requires parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_prepared</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">missing_parameters</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing_parameters</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Failed while trying to prepare pipeline </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;The entrypoint function of the pipeline requires &quot;</span>
                    <span class="s2">&quot;arguments which have not been configured yet: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">missing_parameters</span><span class="si">}</span><span class="s2">. Please provide those parameters by &quot;</span>
                    <span class="s2">&quot;calling `pipeline_instance.configure(parameters=...)` or &quot;</span>
                    <span class="s2">&quot;by calling `pipeline_instance.prepare(...)` and try again.&quot;</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_run_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunTemplateResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a run template for the pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the run template.</span>
<span class="sd">            **kwargs: Keyword arguments for the client method to create a run</span>
<span class="sd">                template.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The created run template.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_deployment</span><span class="p">(</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_args</span><span class="p">,</span> <span class="n">skip_schedule_registration</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">create_run_template</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">deployment_id</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_reconfigure_from_file_with_overrides</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the pipeline configuration from config file.</span>

<span class="sd">        Accepts overrides as kwargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            config_path: Path to a yaml configuration file. This file will</span>
<span class="sd">                be parsed as a</span>
<span class="sd">                `zenml.config.pipeline_configurations.PipelineRunConfiguration`</span>
<span class="sd">                object. Options provided in this file will be overwritten by</span>
<span class="sd">                options provided in code using the other arguments of this</span>
<span class="sd">                method.</span>
<span class="sd">            **kwargs: Pipeline configuration options. These will be passed</span>
<span class="sd">                to the `pipeline.configure(...)` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">config_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_config_file</span><span class="p">(</span>
                <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span>
                <span class="n">matcher</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="n">_from_config_file</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">recursive_update</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">,</span> <span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_configure_warnings__</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="o">**</span><span class="n">_from_config_file</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.configuration" class="doc doc-heading">
<code class="highlight language-python"><span class="n">configuration</span><span class="p">:</span> <span class="n">PipelineConfiguration</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>The configuration of the pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>PipelineConfiguration</code></td>
      <td><p>The configuration of the pipeline.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.enable_cache" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enable_cache</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>If caching is enabled for the pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[bool]</code></td>
      <td><p>If caching is enabled for the pipeline.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.invocations" class="doc doc-heading">
<code class="highlight language-python"><span class="n">invocations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">zenml</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">step_invocation</span><span class="o">.</span><span class="n">StepInvocation</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Returns the step invocations of this pipeline.</p>
<p>This dictionary will only be populated once the pipeline has been
called.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, zenml.steps.step_invocation.StepInvocation]</code></td>
      <td><p>The step invocations.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.is_prepared" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_prepared</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>If the pipeline is prepared.</p>
<p>Prepared means that the pipeline entrypoint has been called and the
pipeline is fully defined.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>If the pipeline is prepared.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.missing_parameters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">missing_parameters</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>List of missing parameters for the pipeline entrypoint.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>List of missing parameters for the pipeline entrypoint.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">model</span><span class="p">:</span> <span class="n">PipelineResponse</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Gets the registered pipeline model for this instance.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>PipelineResponse</code></td>
      <td><p>The registered pipeline model.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the pipeline has not been registered yet.</p></td>
      </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>The name of the pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The name of the pipeline.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.required_parameters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">required_parameters</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>List of required parameters for the pipeline entrypoint.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>List of required parameters for the pipeline entrypoint.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.source_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">source_code</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>The source code of this pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The source code of this pipeline.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.source_object" class="doc doc-heading">
<code class="highlight language-python"><span class="n">source_object</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>The source object of this pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Any</code></td>
      <td><p>The source object of this pipeline.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>






  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Handle a call of the pipeline.</p>
<p>This method does one of two things:
* If there is an active pipeline context, it calls the pipeline
  entrypoint function within that context and the step invocations
  will be added to the active pipeline.
* If no pipeline is active, it activates this pipeline before calling
  the entrypoint function.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td><code>Any</code></td>
        <td><p>Entrypoint function arguments.</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>Any</code></td>
        <td><p>Entrypoint function keyword arguments.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[zenml.models.v2.core.pipeline_run.PipelineRunResponse]</code></td>
      <td><p>If called within another pipeline, returns the outputs of the
<code>entrypoint</code> method. Otherwise, returns the pipeline run or <code>None</code>
if running with a schedule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PipelineRunResponse</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle a call of the pipeline.</span>

<span class="sd">    This method does one of two things:</span>
<span class="sd">    * If there is an active pipeline context, it calls the pipeline</span>
<span class="sd">      entrypoint function within that context and the step invocations</span>
<span class="sd">      will be added to the active pipeline.</span>
<span class="sd">    * If no pipeline is active, it activates this pipeline before calling</span>
<span class="sd">      the entrypoint function.</span>

<span class="sd">    Args:</span>
<span class="sd">        *args: Entrypoint function arguments.</span>
<span class="sd">        **kwargs: Entrypoint function keyword arguments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If called within another pipeline, returns the outputs of the</span>
<span class="sd">        `entrypoint` method. Otherwise, returns the pipeline run or `None`</span>
<span class="sd">        if running with a schedule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span><span class="p">:</span>
        <span class="c1"># Calling a pipeline inside a pipeline, we return the potential</span>
        <span class="c1"># outputs of the entrypoint function</span>

        <span class="c1"># TODO: This currently ignores the configuration of the pipeline</span>
        <span class="c1">#   and instead applies the configuration of the previously active</span>
        <span class="c1">#   pipeline. Is this what we want?</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.__enter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Activate the pipeline context.</p>

<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If a different pipeline is already active.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Self</code></td>
      <td><p>The pipeline instance.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Activate the pipeline context.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If a different pipeline is already active.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The pipeline instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Unable to enter pipeline context. A different pipeline &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is already active.&quot;</span>
        <span class="p">)</span>

    <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.__exit__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Deactivates the pipeline context.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td><code>Any</code></td>
        <td><p>The arguments passed to the context exit handler.</p></td>
        <td><code>()</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deactivates the pipeline context.</span>

<span class="sd">    Args:</span>
<span class="sd">        *args: The arguments passed to the context exit handler.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">entrypoint</span><span class="p">,</span> <span class="n">enable_cache</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_artifact_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_artifact_visualization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_step_logs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_failure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_success</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">substitutions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Initializes a pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the pipeline.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>entrypoint</code></td>
        <td><code>~F</code></td>
        <td><p>The entrypoint function of the pipeline.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>enable_cache</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If caching should be enabled for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_artifact_metadata</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If artifact metadata should be enabled for
this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_artifact_visualization</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If artifact visualization should be
enabled for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_step_logs</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If step logs should be enabled for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>settings</code></td>
        <td><code>Optional[Mapping[str, SettingsOrDict]]</code></td>
        <td><p>Settings for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>Tags to apply to runs of this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>extra</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>Extra configurations for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>on_failure</code></td>
        <td><code>Optional[HookSpecification]</code></td>
        <td><p>Callback function in event of failure of the step. Can
be a function with a single argument of type <code>BaseException</code>, or
a source path to such a function (e.g. <code>module.my_function</code>).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>on_success</code></td>
        <td><code>Optional[HookSpecification]</code></td>
        <td><p>Callback function in event of success of the step. Can
be a function with no arguments, or a source path to such a
function (e.g. <code>module.my_function</code>).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td><code>Optional[Model]</code></td>
        <td><p>configuration of the model in the Model Control Plane.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>substitutions</code></td>
        <td><code>Optional[Dict[str, str]]</code></td>
        <td><p>Extra placeholders to use in the name templates.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">entrypoint</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span>
    <span class="n">enable_cache</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_artifact_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_artifact_visualization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_step_logs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extra</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_failure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_success</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">substitutions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the pipeline.</span>
<span class="sd">        entrypoint: The entrypoint function of the pipeline.</span>
<span class="sd">        enable_cache: If caching should be enabled for this pipeline.</span>
<span class="sd">        enable_artifact_metadata: If artifact metadata should be enabled for</span>
<span class="sd">            this pipeline.</span>
<span class="sd">        enable_artifact_visualization: If artifact visualization should be</span>
<span class="sd">            enabled for this pipeline.</span>
<span class="sd">        enable_step_logs: If step logs should be enabled for this pipeline.</span>
<span class="sd">        settings: Settings for this pipeline.</span>
<span class="sd">        tags: Tags to apply to runs of this pipeline.</span>
<span class="sd">        extra: Extra configurations for this pipeline.</span>
<span class="sd">        on_failure: Callback function in event of failure of the step. Can</span>
<span class="sd">            be a function with a single argument of type `BaseException`, or</span>
<span class="sd">            a source path to such a function (e.g. `module.my_function`).</span>
<span class="sd">        on_success: Callback function in event of success of the step. Can</span>
<span class="sd">            be a function with no arguments, or a source path to such a</span>
<span class="sd">            function (e.g. `module.my_function`).</span>
<span class="sd">        model: configuration of the model in the Model Control Plane.</span>
<span class="sd">        substitutions: Extra placeholders to use in the name templates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_invocations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StepInvocation</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_run_args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span> <span class="o">=</span> <span class="n">PipelineConfiguration</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_configure_warnings__</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
            <span class="n">enable_cache</span><span class="o">=</span><span class="n">enable_cache</span><span class="p">,</span>
            <span class="n">enable_artifact_metadata</span><span class="o">=</span><span class="n">enable_artifact_metadata</span><span class="p">,</span>
            <span class="n">enable_artifact_visualization</span><span class="o">=</span><span class="n">enable_artifact_visualization</span><span class="p">,</span>
            <span class="n">enable_step_logs</span><span class="o">=</span><span class="n">enable_step_logs</span><span class="p">,</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">extra</span><span class="o">=</span><span class="n">extra</span><span class="p">,</span>
            <span class="n">on_failure</span><span class="o">=</span><span class="n">on_failure</span><span class="p">,</span>
            <span class="n">on_success</span><span class="o">=</span><span class="n">on_success</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">substitutions</span><span class="o">=</span><span class="n">substitutions</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span> <span class="o">=</span> <span class="n">entrypoint</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.__suppress_configure_warnings__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__suppress_configure_warnings__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Context manager to suppress warnings in <code>Pipeline.configure(...)</code>.</p>
<p>Used to suppress warnings when called from inner code and not user-facing code.</p>

<p><strong>Yields:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Iterator[Any]</code></td>
      <td><p>Nothing.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">__suppress_configure_warnings__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager to suppress warnings in `Pipeline.configure(...)`.</span>

<span class="sd">    Used to suppress warnings when called from inner code and not user-facing code.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Nothing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">yield</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.add_step_invocation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_step_invocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">input_artifacts</span><span class="p">,</span> <span class="n">external_artifacts</span><span class="p">,</span> <span class="n">model_artifacts_or_metadata</span><span class="p">,</span> <span class="n">client_lazy_loaders</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">default_parameters</span><span class="p">,</span> <span class="n">upstream_steps</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_id_suffix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Adds a step invocation to the pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>step</code></td>
        <td><code>BaseStep</code></td>
        <td><p>The step for which to add an invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>input_artifacts</code></td>
        <td><code>Dict[str, zenml.steps.entrypoint_function_utils.StepArtifact]</code></td>
        <td><p>The input artifacts for the invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>external_artifacts</code></td>
        <td><code>Dict[str, Union[ExternalArtifact, ArtifactVersionResponse]]</code></td>
        <td><p>The external artifacts for the invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model_artifacts_or_metadata</code></td>
        <td><code>Dict[str, ModelVersionDataLazyLoader]</code></td>
        <td><p>The model artifacts or metadata for
the invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>client_lazy_loaders</code></td>
        <td><code>Dict[str, ClientLazyLoader]</code></td>
        <td><p>The client lazy loaders for the invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parameters</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>The parameters for the invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>default_parameters</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>The default parameters for the invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>upstream_steps</code></td>
        <td><code>Set[str]</code></td>
        <td><p>The upstream steps for the invocation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>custom_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Custom ID to use for the invocation.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>allow_id_suffix</code></td>
        <td><code>bool</code></td>
        <td><p>Whether a suffix can be appended to the invocation
ID.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the method is called on an inactive pipeline.</p></td>
      </tr>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the invocation was called with an artifact from
a different pipeline.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The step invocation ID.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_step_invocation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">step</span><span class="p">:</span> <span class="s2">&quot;BaseStep&quot;</span><span class="p">,</span>
    <span class="n">input_artifacts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StepArtifact</span><span class="p">],</span>
    <span class="n">external_artifacts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ExternalArtifact&quot;</span><span class="p">,</span> <span class="s2">&quot;ArtifactVersionResponse&quot;</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="n">model_artifacts_or_metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;ModelVersionDataLazyLoader&quot;</span><span class="p">],</span>
    <span class="n">client_lazy_loaders</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;ClientLazyLoader&quot;</span><span class="p">],</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">default_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">upstream_steps</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">custom_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_id_suffix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a step invocation to the pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        step: The step for which to add an invocation.</span>
<span class="sd">        input_artifacts: The input artifacts for the invocation.</span>
<span class="sd">        external_artifacts: The external artifacts for the invocation.</span>
<span class="sd">        model_artifacts_or_metadata: The model artifacts or metadata for</span>
<span class="sd">            the invocation.</span>
<span class="sd">        client_lazy_loaders: The client lazy loaders for the invocation.</span>
<span class="sd">        parameters: The parameters for the invocation.</span>
<span class="sd">        default_parameters: The default parameters for the invocation.</span>
<span class="sd">        upstream_steps: The upstream steps for the invocation.</span>
<span class="sd">        custom_id: Custom ID to use for the invocation.</span>
<span class="sd">        allow_id_suffix: Whether a suffix can be appended to the invocation</span>
<span class="sd">            ID.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the method is called on an inactive pipeline.</span>
<span class="sd">        RuntimeError: If the invocation was called with an artifact from</span>
<span class="sd">            a different pipeline.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The step invocation ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">ACTIVE_PIPELINE</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;A step invocation can only be added to an active pipeline.&quot;</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="n">input_artifacts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">artifact</span><span class="o">.</span><span class="n">pipeline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Got invalid input artifact for invocation of step &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">step</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: The input artifact was produced by a step &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;inside a different pipeline </span><span class="si">{</span><span class="n">artifact</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="n">invocation_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_invocation_id</span><span class="p">(</span>
        <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">,</span> <span class="n">allow_suffix</span><span class="o">=</span><span class="n">allow_id_suffix</span>
    <span class="p">)</span>
    <span class="n">invocation</span> <span class="o">=</span> <span class="n">StepInvocation</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="n">invocation_id</span><span class="p">,</span>
        <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span>
        <span class="n">input_artifacts</span><span class="o">=</span><span class="n">input_artifacts</span><span class="p">,</span>
        <span class="n">external_artifacts</span><span class="o">=</span><span class="n">external_artifacts</span><span class="p">,</span>
        <span class="n">model_artifacts_or_metadata</span><span class="o">=</span><span class="n">model_artifacts_or_metadata</span><span class="p">,</span>
        <span class="n">client_lazy_loaders</span><span class="o">=</span><span class="n">client_lazy_loaders</span><span class="p">,</span>
        <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
        <span class="n">default_parameters</span><span class="o">=</span><span class="n">default_parameters</span><span class="p">,</span>
        <span class="n">upstream_steps</span><span class="o">=</span><span class="n">upstream_steps</span><span class="p">,</span>
        <span class="n">pipeline</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_invocations</span><span class="p">[</span><span class="n">invocation_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">invocation</span>
    <span class="k">return</span> <span class="n">invocation_id</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step_configurations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Builds Docker images for the pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>settings</code></td>
        <td><code>Optional[Mapping[str, SettingsOrDict]]</code></td>
        <td><p>Settings for the pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>step_configurations</code></td>
        <td><code>Optional[Mapping[str, StepConfigurationUpdateOrDict]]</code></td>
        <td><p>Configurations for steps of the pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>config_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path to a yaml configuration file. This file will
be parsed as a
<code>zenml.config.pipeline_configurations.PipelineRunConfiguration</code>
object. Options provided in this file will be overwritten by
options provided in code using the other arguments of this
method.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[PipelineBuildResponse]</code></td>
      <td><p>The build output.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">step_configurations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;StepConfigurationUpdateOrDict&quot;</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineBuildResponse&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds Docker images for the pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        settings: Settings for the pipeline.</span>
<span class="sd">        step_configurations: Configurations for steps of the pipeline.</span>
<span class="sd">        config_path: Path to a yaml configuration file. This file will</span>
<span class="sd">            be parsed as a</span>
<span class="sd">            `zenml.config.pipeline_configurations.PipelineRunConfiguration`</span>
<span class="sd">            object. Options provided in this file will be overwritten by</span>
<span class="sd">            options provided in code using the other arguments of this</span>
<span class="sd">            method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The build output.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">track_handler</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">AnalyticsEvent</span><span class="o">.</span><span class="n">BUILD_PIPELINE</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>

        <span class="n">compile_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_args</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">compile_args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;unlisted&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">compile_args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;prevent_build_reuse&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config_path</span><span class="p">:</span>
            <span class="n">compile_args</span><span class="p">[</span><span class="s2">&quot;config_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_path</span>
        <span class="k">if</span> <span class="n">step_configurations</span><span class="p">:</span>
            <span class="n">compile_args</span><span class="p">[</span><span class="s2">&quot;step_configurations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_configurations</span>
        <span class="k">if</span> <span class="n">settings</span><span class="p">:</span>
            <span class="n">compile_args</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span>

        <span class="n">deployment</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile</span><span class="p">(</span><span class="o">**</span><span class="n">compile_args</span><span class="p">)</span>
        <span class="n">pipeline_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register</span><span class="p">()</span><span class="o">.</span><span class="n">id</span>

        <span class="n">local_repo</span> <span class="o">=</span> <span class="n">code_repository_utils</span><span class="o">.</span><span class="n">find_active_code_repository</span><span class="p">()</span>
        <span class="n">code_repository</span> <span class="o">=</span> <span class="n">build_utils</span><span class="o">.</span><span class="n">verify_local_repository_context</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span> <span class="n">local_repo_context</span><span class="o">=</span><span class="n">local_repo</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">build_utils</span><span class="o">.</span><span class="n">create_pipeline_build</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
            <span class="n">pipeline_id</span><span class="o">=</span><span class="n">pipeline_id</span><span class="p">,</span>
            <span class="n">code_repository</span><span class="o">=</span><span class="n">code_repository</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.configure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable_cache</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_artifact_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_artifact_visualization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_step_logs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_failure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_success</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">substitutions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Configures the pipeline.</p>
<p>Configuration merging example:
* <code>merge==True</code>:
    pipeline.configure(extra={"key1": 1})
    pipeline.configure(extra={"key2": 2}, merge=True)
    pipeline.configuration.extra # {"key1": 1, "key2": 2}
* <code>merge==False</code>:
    pipeline.configure(extra={"key1": 1})
    pipeline.configure(extra={"key2": 2}, merge=False)
    pipeline.configuration.extra # {"key2": 2}</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>enable_cache</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If caching should be enabled for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_artifact_metadata</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If artifact metadata should be enabled for
this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_artifact_visualization</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If artifact visualization should be
enabled for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>enable_step_logs</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>If step logs should be enabled for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>settings</code></td>
        <td><code>Optional[Mapping[str, SettingsOrDict]]</code></td>
        <td><p>settings for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>Tags to apply to runs of this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>extra</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>Extra configurations for this pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>on_failure</code></td>
        <td><code>Optional[HookSpecification]</code></td>
        <td><p>Callback function in event of failure of the step. Can
be a function with a single argument of type <code>BaseException</code>, or
a source path to such a function (e.g. <code>module.my_function</code>).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>on_success</code></td>
        <td><code>Optional[HookSpecification]</code></td>
        <td><p>Callback function in event of success of the step. Can
be a function with no arguments, or a source path to such a
function (e.g. <code>module.my_function</code>).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>merge</code></td>
        <td><code>bool</code></td>
        <td><p>If <code>True</code>, will merge the given dictionary configurations
like <code>extra</code> and <code>settings</code> with existing
configurations. If <code>False</code> the given configurations will
overwrite all existing ones. See the general description of this
method for an example.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td><code>Optional[Model]</code></td>
        <td><p>configuration of the model version in the Model Control Plane.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>parameters</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>input parameters for the pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>substitutions</code></td>
        <td><code>Optional[Dict[str, str]]</code></td>
        <td><p>Extra placeholders to use in the name templates.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Self</code></td>
      <td><p>The pipeline instance that this method was called on.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">enable_cache</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_artifact_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_artifact_visualization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_step_logs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;SettingsOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extra</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_failure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_success</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;HookSpecification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">merge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">substitutions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configures the pipeline.</span>

<span class="sd">    Configuration merging example:</span>
<span class="sd">    * `merge==True`:</span>
<span class="sd">        pipeline.configure(extra={&quot;key1&quot;: 1})</span>
<span class="sd">        pipeline.configure(extra={&quot;key2&quot;: 2}, merge=True)</span>
<span class="sd">        pipeline.configuration.extra # {&quot;key1&quot;: 1, &quot;key2&quot;: 2}</span>
<span class="sd">    * `merge==False`:</span>
<span class="sd">        pipeline.configure(extra={&quot;key1&quot;: 1})</span>
<span class="sd">        pipeline.configure(extra={&quot;key2&quot;: 2}, merge=False)</span>
<span class="sd">        pipeline.configuration.extra # {&quot;key2&quot;: 2}</span>

<span class="sd">    Args:</span>
<span class="sd">        enable_cache: If caching should be enabled for this pipeline.</span>
<span class="sd">        enable_artifact_metadata: If artifact metadata should be enabled for</span>
<span class="sd">            this pipeline.</span>
<span class="sd">        enable_artifact_visualization: If artifact visualization should be</span>
<span class="sd">            enabled for this pipeline.</span>
<span class="sd">        enable_step_logs: If step logs should be enabled for this pipeline.</span>
<span class="sd">        settings: settings for this pipeline.</span>
<span class="sd">        tags: Tags to apply to runs of this pipeline.</span>
<span class="sd">        extra: Extra configurations for this pipeline.</span>
<span class="sd">        on_failure: Callback function in event of failure of the step. Can</span>
<span class="sd">            be a function with a single argument of type `BaseException`, or</span>
<span class="sd">            a source path to such a function (e.g. `module.my_function`).</span>
<span class="sd">        on_success: Callback function in event of success of the step. Can</span>
<span class="sd">            be a function with no arguments, or a source path to such a</span>
<span class="sd">            function (e.g. `module.my_function`).</span>
<span class="sd">        merge: If `True`, will merge the given dictionary configurations</span>
<span class="sd">            like `extra` and `settings` with existing</span>
<span class="sd">            configurations. If `False` the given configurations will</span>
<span class="sd">            overwrite all existing ones. See the general description of this</span>
<span class="sd">            method for an example.</span>
<span class="sd">        model: configuration of the model version in the Model Control Plane.</span>
<span class="sd">        parameters: input parameters for the pipeline.</span>
<span class="sd">        substitutions: Extra placeholders to use in the name templates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The pipeline instance that this method was called on.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">failure_hook_source</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">on_failure</span><span class="p">:</span>
        <span class="c1"># string of on_failure hook function to be used for this pipeline</span>
        <span class="n">failure_hook_source</span> <span class="o">=</span> <span class="n">resolve_and_validate_hook</span><span class="p">(</span><span class="n">on_failure</span><span class="p">)</span>

    <span class="n">success_hook_source</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">on_success</span><span class="p">:</span>
        <span class="c1"># string of on_success hook function to be used for this pipeline</span>
        <span class="n">success_hook_source</span> <span class="o">=</span> <span class="n">resolve_and_validate_hook</span><span class="p">(</span><span class="n">on_success</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">merge</span> <span class="ow">and</span> <span class="n">tags</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
        <span class="c1"># Merge tags explicitly here as the recursive update later only</span>
        <span class="c1"># merges dicts</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span><span class="o">.</span><span class="n">tags</span> <span class="o">+</span> <span class="n">tags</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">remove_none_values</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;enable_cache&quot;</span><span class="p">:</span> <span class="n">enable_cache</span><span class="p">,</span>
            <span class="s2">&quot;enable_artifact_metadata&quot;</span><span class="p">:</span> <span class="n">enable_artifact_metadata</span><span class="p">,</span>
            <span class="s2">&quot;enable_artifact_visualization&quot;</span><span class="p">:</span> <span class="n">enable_artifact_visualization</span><span class="p">,</span>
            <span class="s2">&quot;enable_step_logs&quot;</span><span class="p">:</span> <span class="n">enable_step_logs</span><span class="p">,</span>
            <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="p">,</span>
            <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">tags</span><span class="p">,</span>
            <span class="s2">&quot;extra&quot;</span><span class="p">:</span> <span class="n">extra</span><span class="p">,</span>
            <span class="s2">&quot;failure_hook_source&quot;</span><span class="p">:</span> <span class="n">failure_hook_source</span><span class="p">,</span>
            <span class="s2">&quot;success_hook_source&quot;</span><span class="p">:</span> <span class="n">success_hook_source</span><span class="p">,</span>
            <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="n">parameters</span><span class="p">,</span>
            <span class="s2">&quot;substitutions&quot;</span><span class="p">:</span> <span class="n">substitutions</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__suppress_warnings_flag__</span><span class="p">:</span>
        <span class="n">to_be_reapplied</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">param_</span><span class="p">,</span> <span class="n">value_</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">param_</span> <span class="ow">in</span> <span class="n">PipelineRunConfiguration</span><span class="o">.</span><span class="n">model_fields</span>
                <span class="ow">and</span> <span class="n">param_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span>
                <span class="ow">and</span> <span class="n">value_</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">[</span><span class="n">param_</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">to_be_reapplied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">param_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="p">[</span><span class="n">param_</span><span class="p">],</span> <span class="n">value_</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="n">to_be_reapplied</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">reapply_during_run_warning</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;The value of parameter &#39;</span><span class="si">{name}</span><span class="s2">&#39; has changed from &quot;</span>
                <span class="s2">&quot;&#39;</span><span class="si">{file_value}</span><span class="s2">&#39; to &#39;</span><span class="si">{new_value}</span><span class="s2">&#39; set in your configuration &quot;</span>
                <span class="s2">&quot;file.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_value</span><span class="p">,</span> <span class="n">new_value</span> <span class="ow">in</span> <span class="n">to_be_reapplied</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">reapply_during_run_warning</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">file_value</span><span class="o">=</span><span class="n">file_value</span><span class="p">,</span> <span class="n">new_value</span><span class="o">=</span><span class="n">new_value</span>
                <span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;Configuration file value will be used during pipeline &quot;</span>
                <span class="s2">&quot;run, so you change will not be efficient. Consider &quot;</span>
                <span class="s2">&quot;updating your configuration file instead.&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">config</span> <span class="o">=</span> <span class="n">PipelineConfigurationUpdate</span><span class="p">(</span><span class="o">**</span><span class="n">values</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_apply_configuration</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="n">merge</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.copy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Copies the pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Pipeline</code></td>
      <td><p>The pipeline copy.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pipeline&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copies the pipeline.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The pipeline copy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.create_run_template" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_run_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Create a run template for the pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the run template.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>Any</code></td>
        <td><p>Keyword arguments for the client method to create a run
template.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>RunTemplateResponse</code></td>
      <td><p>The created run template.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_run_template</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunTemplateResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a run template for the pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the run template.</span>
<span class="sd">        **kwargs: Keyword arguments for the client method to create a run</span>
<span class="sd">            template.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The created run template.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>
    <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_deployment</span><span class="p">(</span>
        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_args</span><span class="p">,</span> <span class="n">skip_schedule_registration</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">create_run_template</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">deployment_id</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.log_pipeline_deployment_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">log_pipeline_deployment_metadata</span><span class="p">(</span><span class="n">deployment_model</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Displays logs based on the deployment model upon running a pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment_model</code></td>
        <td><code>PipelineDeploymentResponse</code></td>
        <td><p>The model for the pipeline deployment</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">log_pipeline_deployment_metadata</span><span class="p">(</span>
    <span class="n">deployment_model</span><span class="p">:</span> <span class="n">PipelineDeploymentResponse</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays logs based on the deployment model upon running a pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment_model: The model for the pipeline deployment</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Log about the caching status</span>
        <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">enable_cache</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Caching is disabled by default for &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Log about the used builds</span>
        <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using a build:&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot; Image(s): &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">image</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="c1"># Log about version mismatches between local and build</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">zenml</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>

            <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">zenml_version</span> <span class="o">!=</span> <span class="n">__version__</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ZenML version (different than the local version): &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">zenml_version</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">python_version</span>
                <span class="o">!=</span> <span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Python version (different than the local version): &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Log about the user, stack and components</span>
        <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using user: `</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">stack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using stack: `</span><span class="si">{</span><span class="n">deployment_model</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="p">(</span>
                <span class="n">component_type</span><span class="p">,</span>
                <span class="n">component_models</span><span class="p">,</span>
            <span class="p">)</span> <span class="ow">in</span> <span class="n">deployment_model</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">component_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: `</span><span class="si">{</span><span class="n">component_models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span>
                <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logging pipeline deployment metadata failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.prepare" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Prepares the pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td><code>Any</code></td>
        <td><p>Pipeline entrypoint input arguments.</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>Any</code></td>
        <td><p>Pipeline entrypoint input keyword arguments.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the pipeline has parameters configured differently in
configuration file and code.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code>    <span class="k">def</span><span class="w"> </span><span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares the pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: Pipeline entrypoint input arguments.</span>
<span class="sd">            **kwargs: Pipeline entrypoint input keyword arguments.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the pipeline has parameters configured differently in</span>
<span class="sd">                configuration file and code.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Clear existing parameters and invocations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invocations</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">conflicting_parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">parameters_</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">parameters</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">from_file_</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_config_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">parameters_</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">recursive_update</span><span class="p">(</span><span class="n">parameters_</span><span class="p">,</span> <span class="n">from_file_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parameters_</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v_runtime</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters_</span><span class="p">:</span>
                    <span class="n">v_config</span> <span class="o">=</span> <span class="n">parameters_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">v_config</span> <span class="o">!=</span> <span class="n">v_runtime</span><span class="p">:</span>
                        <span class="n">conflicting_parameters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_config</span><span class="p">,</span> <span class="n">v_runtime</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">conflicting_parameters</span><span class="p">:</span>
                <span class="n">is_plural</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">conflicting_parameters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Configured parameter</span><span class="si">{</span><span class="n">is_plural</span><span class="si">}</span><span class="s2"> for the pipeline `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` conflict</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">is_plural</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;s&#39;</span><span class="si">}</span><span class="s2"> with parameter</span><span class="si">{</span><span class="n">is_plural</span><span class="si">}</span><span class="s2"> passed in runtime:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">conflicting_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">`: config=`</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">` | runtime=`</span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">`</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;This happens, if you define values for pipeline parameters in configuration file and pass same parameters from the code. Example:</span>
<span class="s2">```</span>
<span class="s2"># config.yaml</span>
<span class="s2">    parameters:</span>
<span class="s2">        param_name: value1</span>


<span class="s2"># pipeline.py</span>
<span class="s2">@pipeline</span>
<span class="s2">def pipeline_(param_name: str):</span>
<span class="s2">    step_name()</span>

<span class="s2">if __name__==&quot;__main__&quot;:</span>
<span class="s2">    pipeline_.with_options(config_path=&quot;config.yaml&quot;)(param_name=&quot;value2&quot;)</span>
<span class="s2">```</span>
<span class="s2">To avoid this consider setting pipeline parameters only in one place (config or code).</span>
<span class="s2">&quot;&quot;&quot;</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v_config</span> <span class="ow">in</span> <span class="n">parameters_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_config</span>

        <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
            <span class="c1"># Enter the context manager, so we become the active pipeline. This</span>
            <span class="c1"># means that all steps that get called while the entrypoint function</span>
            <span class="c1"># is executed will be added as invocation to this pipeline instance.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_call_entrypoint</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Register the pipeline in the server.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>PipelineResponse</code></td>
      <td><p>The registered pipeline model.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PipelineResponse&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register the pipeline in the server.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The registered pipeline model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Activating the built-in integrations to load all materializers</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.integrations.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">integration_registry</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>
    <span class="n">integration_registry</span><span class="o">.</span><span class="n">activate_integrations</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span>
        <span class="n">exclude_defaults</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">}</span>
    <span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The pipeline `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` that you&#39;re registering has &quot;</span>
            <span class="s2">&quot;custom configurations applied to it. These will not be &quot;</span>
            <span class="s2">&quot;registered with the pipeline and won&#39;t be set when you build &quot;</span>
            <span class="s2">&quot;images or run the pipeline from the CLI. To provide these &quot;</span>
            <span class="s2">&quot;configurations, use the `--config` option of the `zenml &quot;</span>
            <span class="s2">&quot;pipeline build/run` commands.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.resolve" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Resolves the pipeline.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Source</code></td>
      <td><p>The pipeline source.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Source&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolves the pipeline.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The pipeline source.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span> <span class="n">skip_validation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.with_options" class="doc doc-heading">
<code class="highlight language-python"><span class="n">with_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">build</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step_configurations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unlisted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prevent_build_reuse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Copies the pipeline and applies the given configurations.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>run_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Name of the pipeline run.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>schedule</code></td>
        <td><code>Optional[zenml.config.schedule.Schedule]</code></td>
        <td><p>Optional schedule to use for the run.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>build</code></td>
        <td><code>Union[str, UUID, PipelineBuildBase]</code></td>
        <td><p>Optional build to use for the run.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>step_configurations</code></td>
        <td><code>Optional[Mapping[str, StepConfigurationUpdateOrDict]]</code></td>
        <td><p>Configurations for steps of the pipeline.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>Optional[Mapping[str, StepConfigurationUpdateOrDict]]</code></td>
        <td><p>Configurations for steps of the pipeline. This is equivalent
to <code>step_configurations</code>, and will be ignored if
<code>step_configurations</code> is set as well.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>config_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path to a yaml configuration file. This file will
be parsed as a
<code>zenml.config.pipeline_configurations.PipelineRunConfiguration</code>
object. Options provided in this file will be overwritten by
options provided in code using the other arguments of this
method.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>unlisted</code></td>
        <td><code>bool</code></td>
        <td><p>Whether the pipeline run should be unlisted (not assigned
to any pipeline).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>prevent_build_reuse</code></td>
        <td><code>bool</code></td>
        <td><p>DEPRECATED: Use
<code>DockerSettings.prevent_build_reuse</code> instead.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>Any</code></td>
        <td><p>Pipeline configuration options. These will be passed
to the <code>pipeline.configure(...)</code> method.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Pipeline</code></td>
      <td><p>The copied pipeline instance.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">with_options</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Schedule</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">build</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;UUID&quot;</span><span class="p">,</span> <span class="s2">&quot;PipelineBuildBase&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">step_configurations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;StepConfigurationUpdateOrDict&quot;</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;StepConfigurationUpdateOrDict&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unlisted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prevent_build_reuse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pipeline&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copies the pipeline and applies the given configurations.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_name: Name of the pipeline run.</span>
<span class="sd">        schedule: Optional schedule to use for the run.</span>
<span class="sd">        build: Optional build to use for the run.</span>
<span class="sd">        step_configurations: Configurations for steps of the pipeline.</span>
<span class="sd">        steps: Configurations for steps of the pipeline. This is equivalent</span>
<span class="sd">            to `step_configurations`, and will be ignored if</span>
<span class="sd">            `step_configurations` is set as well.</span>
<span class="sd">        config_path: Path to a yaml configuration file. This file will</span>
<span class="sd">            be parsed as a</span>
<span class="sd">            `zenml.config.pipeline_configurations.PipelineRunConfiguration`</span>
<span class="sd">            object. Options provided in this file will be overwritten by</span>
<span class="sd">            options provided in code using the other arguments of this</span>
<span class="sd">            method.</span>
<span class="sd">        unlisted: Whether the pipeline run should be unlisted (not assigned</span>
<span class="sd">            to any pipeline).</span>
<span class="sd">        prevent_build_reuse: DEPRECATED: Use</span>
<span class="sd">            `DockerSettings.prevent_build_reuse` instead.</span>
<span class="sd">        **kwargs: Pipeline configuration options. These will be passed</span>
<span class="sd">            to the `pipeline.configure(...)` method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The copied pipeline instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">steps</span> <span class="ow">and</span> <span class="n">step_configurations</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Step configurations were passed using both the &quot;</span>
            <span class="s2">&quot;`step_configurations` and `steps` keywords, ignoring the &quot;</span>
            <span class="s2">&quot;values passed using the `steps` keyword.&quot;</span>
        <span class="p">)</span>

    <span class="n">pipeline_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">pipeline_copy</span><span class="o">.</span><span class="n">_reconfigure_from_file_with_overrides</span><span class="p">(</span>
        <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="n">run_args</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">remove_none_values</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;run_name&quot;</span><span class="p">:</span> <span class="n">run_name</span><span class="p">,</span>
            <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="n">schedule</span><span class="p">,</span>
            <span class="s2">&quot;build&quot;</span><span class="p">:</span> <span class="n">build</span><span class="p">,</span>
            <span class="s2">&quot;step_configurations&quot;</span><span class="p">:</span> <span class="n">step_configurations</span> <span class="ow">or</span> <span class="n">steps</span><span class="p">,</span>
            <span class="s2">&quot;config_path&quot;</span><span class="p">:</span> <span class="n">config_path</span><span class="p">,</span>
            <span class="s2">&quot;unlisted&quot;</span><span class="p">:</span> <span class="n">unlisted</span><span class="p">,</span>
            <span class="s2">&quot;prevent_build_reuse&quot;</span><span class="p">:</span> <span class="n">prevent_build_reuse</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">pipeline_copy</span><span class="o">.</span><span class="n">_run_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">run_args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pipeline_copy</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="zenml.pipelines.pipeline_definition.Pipeline.write_run_configuration_template" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_run_configuration_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Writes a run configuration yaml template.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The path where the template will be written.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stack</code></td>
        <td><code>Optional[Stack]</code></td>
        <td><p>The stack for which the template should be generated. If
not given, the active stack will be used.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/pipeline_definition.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_run_configuration_template</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Stack&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a run configuration yaml template.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: The path where the template will be written.</span>
<span class="sd">        stack: The stack for which the template should be generated. If</span>
<span class="sd">            not given, the active stack will be used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.config.base_settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConfigurationLevel</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">zenml.config.step_configurations</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
        <span class="n">PartialArtifactConfiguration</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_if_possible</span><span class="p">()</span>

    <span class="n">stack</span> <span class="o">=</span> <span class="n">stack</span> <span class="ow">or</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>

    <span class="n">setting_classes</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">setting_classes</span>
    <span class="n">setting_classes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings_utils</span><span class="o">.</span><span class="n">get_general_settings</span><span class="p">())</span>

    <span class="n">pipeline_settings</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">step_settings</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">setting_class</span> <span class="ow">in</span> <span class="n">setting_classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">TemplateGenerator</span><span class="p">(</span><span class="n">setting_class</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ConfigurationLevel</span><span class="o">.</span><span class="n">PIPELINE</span> <span class="ow">in</span> <span class="n">setting_class</span><span class="o">.</span><span class="n">LEVEL</span><span class="p">:</span>
            <span class="n">pipeline_settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="k">if</span> <span class="n">ConfigurationLevel</span><span class="o">.</span><span class="n">STEP</span> <span class="ow">in</span> <span class="n">setting_class</span><span class="o">.</span><span class="n">LEVEL</span><span class="p">:</span>
            <span class="n">step_settings</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>

    <span class="n">steps</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">invocation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">invocations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">invocation</span><span class="o">.</span><span class="n">step</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="n">PartialArtifactConfiguration</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">step</span><span class="o">.</span><span class="n">entrypoint_definition</span><span class="o">.</span><span class="n">outputs</span>
        <span class="p">}</span>
        <span class="n">step_template</span> <span class="o">=</span> <span class="n">StepConfigurationUpdate</span><span class="p">(</span>
            <span class="n">parameters</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">step_settings</span><span class="p">,</span>
            <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">steps</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_template</span>

    <span class="n">run_config</span> <span class="o">=</span> <span class="n">PipelineRunConfiguration</span><span class="p">(</span>
        <span class="n">settings</span><span class="o">=</span><span class="n">pipeline_settings</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span>
    <span class="p">)</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">TemplateGenerator</span><span class="p">(</span><span class="n">run_config</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">yaml_string</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
    <span class="n">yaml_string</span> <span class="o">=</span> <span class="n">yaml_utils</span><span class="o">.</span><span class="n">comment_out_yaml</span><span class="p">(</span><span class="n">yaml_string</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_string</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.pipelines.run_utils" class="doc doc-heading">
        <code>run_utils</code>



</h3>

    <div class="doc doc-contents ">

      <p>Utility functions for running pipelines.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.create_placeholder_run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_placeholder_run</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Create a placeholder run for the deployment.</p>
<p>If the deployment contains a schedule, no placeholder run will be
created.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentResponse</code></td>
        <td><p>The deployment for which to create the placeholder run.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[PipelineRunResponse]</code></td>
      <td><p>The placeholder run or <code>None</code> if no run was created.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_placeholder_run</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineRunResponse&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a placeholder run for the deployment.</span>

<span class="sd">    If the deployment contains a schedule, no placeholder run will be</span>
<span class="sd">    created.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment for which to create the placeholder run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The placeholder run or `None` if no run was created.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">deployment</span><span class="o">.</span><span class="n">user</span>

    <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">utc_now</span><span class="p">()</span>
    <span class="n">run_request</span> <span class="o">=</span> <span class="n">PipelineRunRequest</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">string_utils</span><span class="o">.</span><span class="n">format_name_template</span><span class="p">(</span>
            <span class="n">name_template</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">run_name_template</span><span class="p">,</span>
            <span class="n">substitutions</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">_get_full_substitutions</span><span class="p">(</span>
                <span class="n">start_time</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="c1"># We set the start time on the placeholder run already to</span>
        <span class="c1"># make it consistent with the {time} placeholder in the</span>
        <span class="c1"># run name. This means the placeholder run will usually</span>
        <span class="c1"># have longer durations than scheduled runs, as for them</span>
        <span class="c1"># the start_time is only set once the first step starts</span>
        <span class="c1"># running.</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
        <span class="n">orchestrator_run_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">user</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">workspace</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">workspace</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">pipeline</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">ExecutionStatus</span><span class="o">.</span><span class="n">INITIALIZING</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">create_run</span><span class="p">(</span><span class="n">run_request</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.deploy_pipeline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deploy_pipeline</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">stack</span><span class="p">,</span> <span class="n">placeholder_run</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Run a deployment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentResponse</code></td>
        <td><p>The deployment to run.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stack</code></td>
        <td><code>Stack</code></td>
        <td><p>The stack on which to run the deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>placeholder_run</code></td>
        <td><code>Optional[PipelineRunResponse]</code></td>
        <td><p>An optional placeholder run for the deployment.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Any exception that happened while deploying or running
(in case it happens synchronously) the pipeline.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">deploy_pipeline</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
    <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
    <span class="n">placeholder_run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineRunResponse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment to run.</span>
<span class="sd">        stack: The stack on which to run the deployment.</span>
<span class="sd">        placeholder_run: An optional placeholder run for the deployment.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: Any exception that happened while deploying or running</span>
<span class="sd">            (in case it happens synchronously) the pipeline.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prevent execution of nested pipelines which might lead to</span>
    <span class="c1"># unexpected behavior</span>
    <span class="n">previous_value</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SHOULD_PREVENT_PIPELINE_EXECUTION</span>
    <span class="n">constants</span><span class="o">.</span><span class="n">SHOULD_PREVENT_PIPELINE_EXECUTION</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">prepare_pipeline_deployment</span><span class="p">(</span><span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">deploy_pipeline</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span><span class="p">,</span>
            <span class="n">placeholder_run</span><span class="o">=</span><span class="n">placeholder_run</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">placeholder_run</span>
            <span class="ow">and</span> <span class="n">Client</span><span class="p">()</span>
            <span class="o">.</span><span class="n">get_pipeline_run</span><span class="p">(</span><span class="n">placeholder_run</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">hydrate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">status</span>
            <span class="o">==</span> <span class="n">ExecutionStatus</span><span class="o">.</span><span class="n">INITIALIZING</span>
        <span class="p">):</span>
            <span class="c1"># The run failed during the initialization phase -&gt; We change it&#39;s</span>
            <span class="c1"># status to `Failed`</span>
            <span class="n">publish_failed_pipeline_run</span><span class="p">(</span><span class="n">placeholder_run</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">e</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">constants</span><span class="o">.</span><span class="n">SHOULD_PREVENT_PIPELINE_EXECUTION</span> <span class="o">=</span> <span class="n">previous_value</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.get_all_sources_from_value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_all_sources_from_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Get all source objects from a value.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>value</code></td>
        <td><code>Any</code></td>
        <td><p>The value from which to get all the source objects.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[zenml.config.source.Source]</code></td>
      <td><p>List of source objects for the given value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_sources_from_value</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Source</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all source objects from a value.</span>

<span class="sd">    Args:</span>
<span class="sd">        value: The value from which to get all the source objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of source objects for the given value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Source</span><span class="p">):</span>
        <span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">sources</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_all_sources_from_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">sources</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_all_sources_from_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">sources</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_all_sources_from_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sources</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.get_default_run_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_default_run_name</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Gets the default name for a pipeline run.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>pipeline_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the pipeline which will be run.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Run name.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_default_run_name</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the default name for a pipeline run.</span>

<span class="sd">    Args:</span>
<span class="sd">        pipeline_name: Name of the pipeline which will be run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Run name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pipeline_name</span><span class="si">}</span><span class="s2">-</span><span class="se">{{</span><span class="s2">date</span><span class="se">}}</span><span class="s2">-</span><span class="se">{{</span><span class="s2">time</span><span class="se">}}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.get_placeholder_run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_placeholder_run</span><span class="p">(</span><span class="n">deployment_id</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Get the placeholder run for a deployment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment_id</code></td>
        <td><code>UUID</code></td>
        <td><p>ID of the deployment for which to get the placeholder
run.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[PipelineRunResponse]</code></td>
      <td><p>The placeholder run or <code>None</code> if there exists no placeholder run for the
deployment.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_placeholder_run</span><span class="p">(</span>
    <span class="n">deployment_id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineRunResponse&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the placeholder run for a deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment_id: ID of the deployment for which to get the placeholder</span>
<span class="sd">            run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The placeholder run or `None` if there exists no placeholder run for the</span>
<span class="sd">        deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">runs</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">list_pipeline_runs</span><span class="p">(</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;asc:created&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">deployment_id</span><span class="o">=</span><span class="n">deployment_id</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">ExecutionStatus</span><span class="o">.</span><span class="n">INITIALIZING</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">runs</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">run</span> <span class="o">=</span> <span class="n">runs</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">run</span><span class="o">.</span><span class="n">orchestrator_run_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">run</span>

    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.upload_notebook_cell_code_if_necessary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upload_notebook_cell_code_if_necessary</span><span class="p">(</span><span class="n">deployment</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Upload notebook cell code if necessary.</p>
<p>This function checks if any of the steps of the pipeline that will be
executed in a different process are defined in a notebook. If that is the
case, it will extract that notebook cell code into python files and upload
an archive of all the necessary files to the artifact store.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBase</code></td>
        <td><p>The deployment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stack</code></td>
        <td><code>Stack</code></td>
        <td><p>The stack on which the deployment will happen.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the code for one of the steps that will run out of
process cannot be extracted into a python file.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">upload_notebook_cell_code_if_necessary</span><span class="p">(</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBase&quot;</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload notebook cell code if necessary.</span>

<span class="sd">    This function checks if any of the steps of the pipeline that will be</span>
<span class="sd">    executed in a different process are defined in a notebook. If that is the</span>
<span class="sd">    case, it will extract that notebook cell code into python files and upload</span>
<span class="sd">    an archive of all the necessary files to the artifact store.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The deployment.</span>
<span class="sd">        stack: The stack on which the deployment will happen.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the code for one of the steps that will run out of</span>
<span class="sd">            process cannot be extracted into a python file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">should_upload</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">resolved_notebook_sources</span> <span class="o">=</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">get_resolved_notebook_sources</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">source</span>

        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">NOTEBOOK</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">orchestrator</span><span class="o">.</span><span class="n">flavor</span> <span class="o">!=</span> <span class="s2">&quot;local&quot;</span>
                <span class="ow">or</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">step_operator</span>
            <span class="p">):</span>
                <span class="n">should_upload</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">cell_code</span> <span class="o">=</span> <span class="n">resolved_notebook_sources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">source</span><span class="o">.</span><span class="n">import_path</span><span class="p">,</span> <span class="kc">None</span>
                <span class="p">)</span>

                <span class="c1"># Code does not run in-process, which means we need to</span>
                <span class="c1"># extract the step code into a python file</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">cell_code</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Unable to run step </span><span class="si">{</span><span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. This step is &quot;</span>
                        <span class="s2">&quot;defined in a notebook and you&#39;re trying to run it &quot;</span>
                        <span class="s2">&quot;in a remote environment, but ZenML was not able to &quot;</span>
                        <span class="s2">&quot;detect the step code in the notebook. To fix &quot;</span>
                        <span class="s2">&quot;this error, define your step in a python file instead &quot;</span>
                        <span class="s2">&quot;of a notebook.&quot;</span>
                    <span class="p">)</span>

    <span class="k">if</span> <span class="n">should_upload</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Uploading notebook code...&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">cell_code</span> <span class="ow">in</span> <span class="n">resolved_notebook_sources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">notebook_utils</span><span class="o">.</span><span class="n">warn_about_notebook_cell_magic_commands</span><span class="p">(</span>
                <span class="n">cell_code</span><span class="o">=</span><span class="n">cell_code</span>
            <span class="p">)</span>
            <span class="n">module_name</span> <span class="o">=</span> <span class="n">notebook_utils</span><span class="o">.</span><span class="n">compute_cell_replacement_module_name</span><span class="p">(</span>
                <span class="n">cell_code</span><span class="o">=</span><span class="n">cell_code</span>
            <span class="p">)</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">.py&quot;</span>

            <span class="n">code_utils</span><span class="o">.</span><span class="n">upload_notebook_code</span><span class="p">(</span>
                <span class="n">artifact_store</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">artifact_store</span><span class="p">,</span>
                <span class="n">cell_code</span><span class="o">=</span><span class="n">cell_code</span><span class="p">,</span>
                <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">all_deployment_sources</span> <span class="o">=</span> <span class="n">get_all_sources_from_value</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">all_deployment_sources</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">SourceType</span><span class="o">.</span><span class="n">NOTEBOOK</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;artifact_store_id&quot;</span><span class="p">,</span> <span class="n">stack</span><span class="o">.</span><span class="n">artifact_store</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Upload finished.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.validate_run_config_is_runnable_from_server" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_run_config_is_runnable_from_server</span><span class="p">(</span><span class="n">run_configuration</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Validates that the run configuration can be used to run from the server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>run_configuration</code></td>
        <td><code>PipelineRunConfiguration</code></td>
        <td><p>The run configuration to validate.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If there are values in the run configuration that are not
allowed when running a pipeline from the server.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_run_config_is_runnable_from_server</span><span class="p">(</span>
    <span class="n">run_configuration</span><span class="p">:</span> <span class="s2">&quot;PipelineRunConfiguration&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates that the run configuration can be used to run from the server.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_configuration: The run configuration to validate.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If there are values in the run configuration that are not</span>
<span class="sd">            allowed when running a pipeline from the server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">run_configuration</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Can&#39;t set parameters when running pipeline via Rest API.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">run_configuration</span><span class="o">.</span><span class="n">build</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set build when running pipeline via Rest API.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">run_configuration</span><span class="o">.</span><span class="n">schedule</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Can&#39;t set schedule when running pipeline via Rest API.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">run_configuration</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;docker&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Can&#39;t set DockerSettings when running pipeline via Rest API.&quot;</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">step_update</span> <span class="ow">in</span> <span class="n">run_configuration</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">step_update</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;docker&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Can&#39;t set DockerSettings when running pipeline via Rest API.&quot;</span>
            <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.validate_stack_is_runnable_from_server" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_stack_is_runnable_from_server</span><span class="p">(</span><span class="n">zen_store</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Validate if a stack model is runnable from the server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>zen_store</code></td>
        <td><code>BaseZenStore</code></td>
        <td><p>ZenStore to use for listing flavors.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stack</code></td>
        <td><code>StackResponse</code></td>
        <td><p>The stack to validate.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the stack has components of a custom flavor or local
components.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_stack_is_runnable_from_server</span><span class="p">(</span>
    <span class="n">zen_store</span><span class="p">:</span> <span class="n">BaseZenStore</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">StackResponse</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate if a stack model is runnable from the server.</span>

<span class="sd">    Args:</span>
<span class="sd">        zen_store: ZenStore to use for listing flavors.</span>
<span class="sd">        stack: The stack to validate.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the stack has components of a custom flavor or local</span>
<span class="sd">            components.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">component_list</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">component</span> <span class="o">=</span> <span class="n">component_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">flavors</span> <span class="o">=</span> <span class="n">zen_store</span><span class="o">.</span><span class="n">list_flavors</span><span class="p">(</span>
            <span class="n">FlavorFilter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">component</span><span class="o">.</span><span class="n">flavor_name</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">component</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flavors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">flavor_model</span> <span class="o">=</span> <span class="n">flavors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">flavor_model</span><span class="o">.</span><span class="n">workspace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No custom stack component flavors allowed.&quot;</span><span class="p">)</span>

        <span class="n">flavor</span> <span class="o">=</span> <span class="n">Flavor</span><span class="o">.</span><span class="n">from_model</span><span class="p">(</span><span class="n">flavor_model</span><span class="p">)</span>
        <span class="n">component_config</span> <span class="o">=</span> <span class="n">flavor</span><span class="o">.</span><span class="n">config_class</span><span class="p">(</span><span class="o">**</span><span class="n">component</span><span class="o">.</span><span class="n">configuration</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">component_config</span><span class="o">.</span><span class="n">is_local</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No local stack components allowed.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="zenml.pipelines.run_utils.wait_for_pipeline_run_to_finish" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wait_for_pipeline_run_to_finish</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Waits until a pipeline run is finished.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>run_id</code></td>
        <td><code>UUID</code></td>
        <td><p>ID of the run for which to wait.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>PipelineRunResponse</code></td>
      <td><p>Model of the finished run.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/pipelines/run_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wait_for_pipeline_run_to_finish</span><span class="p">(</span><span class="n">run_id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PipelineRunResponse&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Waits until a pipeline run is finished.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_id: ID of the run for which to wait.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Model of the finished run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sleep_interval</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">max_sleep_interval</span> <span class="o">=</span> <span class="mi">64</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">get_pipeline_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">run</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">is_finished</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">run</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Waiting for pipeline run with ID </span><span class="si">%s</span><span class="s2"> to finish (current status: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">run_id</span><span class="p">,</span>
            <span class="n">run</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_interval</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sleep_interval</span> <span class="o">&lt;</span> <span class="n">max_sleep_interval</span><span class="p">:</span>
            <span class="n">sleep_interval</span> <span class="o">*=</span> <span class="mi">2</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../core-orchestrators/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Orchestrators" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Orchestrators
            </div>
          </div>
        </a>
      
      
        
        <a href="../core-plugins/" class="md-footer__link md-footer__link--next" aria-label="Next: Plugins" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Plugins
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 ZenML GmbH – <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  




<h4>This website uses cookies</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>