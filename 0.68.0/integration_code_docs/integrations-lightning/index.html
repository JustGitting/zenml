
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sdkdocs.zenml.io/0.68.0/integration_code_docs/integrations-lightning/">
      
      <link rel="icon" href="../../_assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.5.10">
    
    
      
        <title>Lightning - ZenML API Reference</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

<script>
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM";;analytics.SNIPPET_VERSION="4.15.3";
  analytics.load("CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM");
  analytics.page();
  }}();
</script>
<script defer data-domain="apidocs.zenml.io" src="https://plausible.io/js/plausible.js"></script>


  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lightning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ZenML API Reference" class="md-header__button md-logo" aria-label="ZenML API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZenML API Reference
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lightning
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ZenML API Reference" class="md-nav__button md-logo" aria-label="ZenML API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ZenML API Reference
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        ZenML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        CLI docs
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Core code docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core code docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Core code docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-actions/" class="md-nav__link">
        Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-alerter/" class="md-nav__link">
        Alerter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-analytics/" class="md-nav__link">
        Analytics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-annotators/" class="md-nav__link">
        Annotators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-api/" class="md-nav__link">
        Api
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-artifact_stores/" class="md-nav__link">
        Artifact Stores
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-artifacts/" class="md-nav__link">
        Artifacts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-client/" class="md-nav__link">
        Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-client_lazy_loader/" class="md-nav__link">
        Client Lazy Loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-code_repositories/" class="md-nav__link">
        Code Repositories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-config/" class="md-nav__link">
        Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-console/" class="md-nav__link">
        Console
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-container_registries/" class="md-nav__link">
        Container Registries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-data_validators/" class="md-nav__link">
        Data Validators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-entrypoints/" class="md-nav__link">
        Entrypoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-enums/" class="md-nav__link">
        Enums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-environment/" class="md-nav__link">
        Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-event_hub/" class="md-nav__link">
        Event Hub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-event_sources/" class="md-nav__link">
        Event Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-experiment_trackers/" class="md-nav__link">
        Experiment Trackers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-feature_stores/" class="md-nav__link">
        Feature Stores
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-hooks/" class="md-nav__link">
        Hooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-image_builders/" class="md-nav__link">
        Image Builders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-io/" class="md-nav__link">
        Io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-logger/" class="md-nav__link">
        Logger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-logging/" class="md-nav__link">
        Logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-materializers/" class="md-nav__link">
        Materializers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-metadata/" class="md-nav__link">
        Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-model/" class="md-nav__link">
        Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-model_deployers/" class="md-nav__link">
        Model Deployers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-model_registries/" class="md-nav__link">
        Model Registries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-orchestrators/" class="md-nav__link">
        Orchestrators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-pipelines/" class="md-nav__link">
        Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-secret/" class="md-nav__link">
        Secret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-service_connectors/" class="md-nav__link">
        Service Connectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-services/" class="md-nav__link">
        Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-stack/" class="md-nav__link">
        Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-stack_deployments/" class="md-nav__link">
        Stack Deployments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-step_operators/" class="md-nav__link">
        Step Operators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-steps/" class="md-nav__link">
        Steps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-types/" class="md-nav__link">
        Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-zen_server/" class="md-nav__link">
        Zen Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-zen_stores/" class="md-nav__link">
        Zen Stores
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Integration code docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Integration code docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Integration code docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-airflow/" class="md-nav__link">
        Airflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-argilla/" class="md-nav__link">
        Argilla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-aws/" class="md-nav__link">
        Aws
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-azure/" class="md-nav__link">
        Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-bentoml/" class="md-nav__link">
        Bentoml
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-bitbucket/" class="md-nav__link">
        Bitbucket
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-comet/" class="md-nav__link">
        Comet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-databricks/" class="md-nav__link">
        Databricks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-deepchecks/" class="md-nav__link">
        Deepchecks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-discord/" class="md-nav__link">
        Discord
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-evidently/" class="md-nav__link">
        Evidently
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-facets/" class="md-nav__link">
        Facets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-feast/" class="md-nav__link">
        Feast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-gcp/" class="md-nav__link">
        Gcp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-github/" class="md-nav__link">
        Github
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-gitlab/" class="md-nav__link">
        Gitlab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-great_expectations/" class="md-nav__link">
        Great Expectations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-huggingface/" class="md-nav__link">
        Huggingface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-hyperai/" class="md-nav__link">
        Hyperai
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-integration/" class="md-nav__link">
        Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-kaniko/" class="md-nav__link">
        Kaniko
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-kubeflow/" class="md-nav__link">
        Kubeflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-label_studio/" class="md-nav__link">
        Label Studio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-langchain/" class="md-nav__link">
        Langchain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-lightgbm/" class="md-nav__link">
        Lightgbm
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Lightning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Lightning
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.integrations.lightning" class="md-nav__link">
    lightning
  </a>
  
    <nav class="md-nav" aria-label="lightning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.LightningIntegration" class="md-nav__link">
    LightningIntegration
  </a>
  
    <nav class="md-nav" aria-label="LightningIntegration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.LightningIntegration.flavors" class="md-nav__link">
    flavors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors" class="md-nav__link">
    flavors
  </a>
  
    <nav class="md-nav" aria-label="flavors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor" class="md-nav__link">
    lightning_orchestrator_flavor
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator_flavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig" class="md-nav__link">
    LightningOrchestratorConfig
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestratorConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_local" class="md-nav__link">
    is_local
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_schedulable" class="md-nav__link">
    is_schedulable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_synchronous" class="md-nav__link">
    is_synchronous
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor" class="md-nav__link">
    LightningOrchestratorFlavor
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestratorFlavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.config_class" class="md-nav__link">
    config_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.docs_url" class="md-nav__link">
    docs_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.implementation_class" class="md-nav__link">
    implementation_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.logo_url" class="md-nav__link">
    logo_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.sdk_docs_url" class="md-nav__link">
    sdk_docs_url
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorSettings" class="md-nav__link">
    LightningOrchestratorSettings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators" class="md-nav__link">
    orchestrators
  </a>
  
    <nav class="md-nav" aria-label="orchestrators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator" class="md-nav__link">
    lightning_orchestrator
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator" class="md-nav__link">
    LightningOrchestrator
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.config" class="md-nav__link">
    config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.pipeline_directory" class="md-nav__link">
    pipeline_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.root_directory" class="md-nav__link">
    root_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.settings_class" class="md-nav__link">
    settings_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.validator" class="md-nav__link">
    validator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.get_orchestrator_run_id" class="md-nav__link">
    get_orchestrator_run_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.prepare_or_run_pipeline" class="md-nav__link">
    prepare_or_run_pipeline()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.prepare_or_run_pipeline--how-it-works" class="md-nav__link">
    How it works:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.setup_credentials" class="md-nav__link">
    setup_credentials()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint" class="md-nav__link">
    lightning_orchestrator_entrypoint
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator_entrypoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint.main" class="md-nav__link">
    main()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint.parse_args" class="md-nav__link">
    parse_args()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration" class="md-nav__link">
    lightning_orchestrator_entrypoint_configuration
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator_entrypoint_configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration" class="md-nav__link">
    LightningOrchestratorEntrypointConfiguration
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestratorEntrypointConfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_arguments" class="md-nav__link">
    get_entrypoint_arguments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_command" class="md-nav__link">
    get_entrypoint_command()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_options" class="md-nav__link">
    get_entrypoint_options()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.utils.gather_requirements" class="md-nav__link">
    gather_requirements()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.utils.sanitize_studio_name" class="md-nav__link">
    sanitize_studio_name()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-llama_index/" class="md-nav__link">
        Llama Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-mlflow/" class="md-nav__link">
        Mlflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-neptune/" class="md-nav__link">
        Neptune
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-neural_prophet/" class="md-nav__link">
        Neural Prophet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-numpy/" class="md-nav__link">
        Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-openai/" class="md-nav__link">
        Openai
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pigeon/" class="md-nav__link">
        Pigeon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pillow/" class="md-nav__link">
        Pillow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-polars/" class="md-nav__link">
        Polars
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-prodigy/" class="md-nav__link">
        Prodigy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pycaret/" class="md-nav__link">
        Pycaret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pytorch/" class="md-nav__link">
        Pytorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pytorch_lightning/" class="md-nav__link">
        Pytorch Lightning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-registry/" class="md-nav__link">
        Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-s3/" class="md-nav__link">
        S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-scipy/" class="md-nav__link">
        Scipy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-seldon/" class="md-nav__link">
        Seldon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-sklearn/" class="md-nav__link">
        Sklearn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-skypilot/" class="md-nav__link">
        Skypilot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-skypilot_aws/" class="md-nav__link">
        Skypilot Aws
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-skypilot_azure/" class="md-nav__link">
        Skypilot Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-skypilot_gcp/" class="md-nav__link">
        Skypilot Gcp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-skypilot_kubernetes/" class="md-nav__link">
        Skypilot Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-skypilot_lambda/" class="md-nav__link">
        Skypilot Lambda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-slack/" class="md-nav__link">
        Slack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-spark/" class="md-nav__link">
        Spark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-tekton/" class="md-nav__link">
        Tekton
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-tensorboard/" class="md-nav__link">
        Tensorboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-tensorflow/" class="md-nav__link">
        Tensorflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-wandb/" class="md-nav__link">
        Wandb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-whylogs/" class="md-nav__link">
        Whylogs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-xgboost/" class="md-nav__link">
        Xgboost
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.integrations.lightning" class="md-nav__link">
    lightning
  </a>
  
    <nav class="md-nav" aria-label="lightning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.LightningIntegration" class="md-nav__link">
    LightningIntegration
  </a>
  
    <nav class="md-nav" aria-label="LightningIntegration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.LightningIntegration.flavors" class="md-nav__link">
    flavors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors" class="md-nav__link">
    flavors
  </a>
  
    <nav class="md-nav" aria-label="flavors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor" class="md-nav__link">
    lightning_orchestrator_flavor
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator_flavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig" class="md-nav__link">
    LightningOrchestratorConfig
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestratorConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_local" class="md-nav__link">
    is_local
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_schedulable" class="md-nav__link">
    is_schedulable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_synchronous" class="md-nav__link">
    is_synchronous
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor" class="md-nav__link">
    LightningOrchestratorFlavor
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestratorFlavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.config_class" class="md-nav__link">
    config_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.docs_url" class="md-nav__link">
    docs_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.implementation_class" class="md-nav__link">
    implementation_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.logo_url" class="md-nav__link">
    logo_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.sdk_docs_url" class="md-nav__link">
    sdk_docs_url
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorSettings" class="md-nav__link">
    LightningOrchestratorSettings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators" class="md-nav__link">
    orchestrators
  </a>
  
    <nav class="md-nav" aria-label="orchestrators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator" class="md-nav__link">
    lightning_orchestrator
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator" class="md-nav__link">
    LightningOrchestrator
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.config" class="md-nav__link">
    config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.pipeline_directory" class="md-nav__link">
    pipeline_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.root_directory" class="md-nav__link">
    root_directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.settings_class" class="md-nav__link">
    settings_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.validator" class="md-nav__link">
    validator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.get_orchestrator_run_id" class="md-nav__link">
    get_orchestrator_run_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.prepare_or_run_pipeline" class="md-nav__link">
    prepare_or_run_pipeline()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.prepare_or_run_pipeline--how-it-works" class="md-nav__link">
    How it works:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.setup_credentials" class="md-nav__link">
    setup_credentials()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint" class="md-nav__link">
    lightning_orchestrator_entrypoint
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator_entrypoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint.main" class="md-nav__link">
    main()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint.parse_args" class="md-nav__link">
    parse_args()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration" class="md-nav__link">
    lightning_orchestrator_entrypoint_configuration
  </a>
  
    <nav class="md-nav" aria-label="lightning_orchestrator_entrypoint_configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration" class="md-nav__link">
    LightningOrchestratorEntrypointConfiguration
  </a>
  
    <nav class="md-nav" aria-label="LightningOrchestratorEntrypointConfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_arguments" class="md-nav__link">
    get_entrypoint_arguments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_command" class="md-nav__link">
    get_entrypoint_command()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_options" class="md-nav__link">
    get_entrypoint_options()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.utils.gather_requirements" class="md-nav__link">
    gather_requirements()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.lightning.orchestrators.utils.sanitize_studio_name" class="md-nav__link">
    sanitize_studio_name()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/zenml-io/zenml/docs/integration_code_docs/integrations-lightning.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="lightning">Lightning</h1>


  <div class="doc doc-object doc-module">



<h2 id="zenml.integrations.lightning" class="doc doc-heading">
        <code>zenml.integrations.lightning</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h2>

    <div class="doc doc-contents first">

      <p>Initialization of the Lightning integration for ZenML.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h3 id="zenml.integrations.lightning.LightningIntegration" class="doc doc-heading">
        <code>
LightningIntegration            (<a class="autorefs autorefs-internal" title="zenml.integrations.integration.Integration" href="../integrations-integration/#zenml.integrations.integration.Integration">Integration</a>)
        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Definition of Lightning Integration for ZenML.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LightningIntegration</span><span class="p">(</span><span class="n">Integration</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Definition of Lightning Integration for ZenML.&quot;&quot;&quot;</span>

    <span class="n">NAME</span> <span class="o">=</span> <span class="n">LIGHTNING</span>
    <span class="n">REQUIREMENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lightning-sdk&gt;=0.1.17&quot;</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">flavors</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Flavor</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Declare the stack component flavors for the Lightning integration.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of stack component flavors for this integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.lightning.flavors</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">LightningOrchestratorFlavor</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">LightningOrchestratorFlavor</span><span class="p">,</span>
        <span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">











  <div class="doc doc-object doc-method">



<h4 id="zenml.integrations.lightning.LightningIntegration.flavors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flavors</span><span class="p">()</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Declare the stack component flavors for the Lightning integration.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Type[zenml.stack.flavor.Flavor]]</code></td>
      <td><p>List of stack component flavors for this integration.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">flavors</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Flavor</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Declare the stack component flavors for the Lightning integration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of stack component flavors for this integration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">zenml.integrations.lightning.flavors</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">LightningOrchestratorFlavor</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span>
        <span class="n">LightningOrchestratorFlavor</span><span class="p">,</span>
    <span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.lightning.flavors" class="doc doc-heading">
        <code>flavors</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Lightning integration flavors.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor" class="doc doc-heading">
        <code>lightning_orchestrator_flavor</code>



</h4>

    <div class="doc doc-contents ">

      <p>Lightning orchestrator base config and settings.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig" class="doc doc-heading">
        <code>
LightningOrchestratorConfig            (<a class="autorefs autorefs-internal" title="zenml.orchestrators.base_orchestrator.BaseOrchestratorConfig" href="../../core_code_docs/core-orchestrators/#zenml.orchestrators.base_orchestrator.BaseOrchestratorConfig">BaseOrchestratorConfig</a>, <a class="autorefs autorefs-internal" title="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorSettings" href="#zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorSettings">LightningOrchestratorSettings</a>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Lightning orchestrator base config.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/flavors/lightning_orchestrator_flavor.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LightningOrchestratorConfig</span><span class="p">(</span>
    <span class="n">BaseOrchestratorConfig</span><span class="p">,</span> <span class="n">LightningOrchestratorSettings</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lightning orchestrator base config.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_local</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if this stack component is running locally.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if this config is for a local component, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_synchronous</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the orchestrator runs synchronous or not.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the orchestrator runs synchronous or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">synchronous</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_schedulable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the orchestrator is schedulable or not.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the orchestrator is schedulable or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">


















  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_local" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_local</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Checks if this stack component is running locally.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if this config is for a local component, False otherwise.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_schedulable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_schedulable</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Whether the orchestrator is schedulable or not.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether the orchestrator is schedulable or not.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig.is_synchronous" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_synchronous</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Whether the orchestrator runs synchronous or not.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether the orchestrator runs synchronous or not.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor" class="doc doc-heading">
        <code>
LightningOrchestratorFlavor            (<a class="autorefs autorefs-internal" title="zenml.orchestrators.base_orchestrator.BaseOrchestratorFlavor" href="../../core_code_docs/core-orchestrators/#zenml.orchestrators.base_orchestrator.BaseOrchestratorFlavor">BaseOrchestratorFlavor</a>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Lightning orchestrator flavor.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/flavors/lightning_orchestrator_flavor.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LightningOrchestratorFlavor</span><span class="p">(</span><span class="n">BaseOrchestratorFlavor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lightning orchestrator flavor.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Name of the flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the flavor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">LIGHTNING_ORCHESTRATOR_FLAVOR</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">docs_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to point at docs explaining this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A flavor docs url.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_default_docs_url</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sdk_docs_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to point at SDK docs explaining this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A flavor SDK docs url.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_default_sdk_docs_url</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logo_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to represent the flavor in the dashboard.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The flavor logo.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;https://public-flavor-logos.s3.eu-central-1.amazonaws.com/orchestrator/lightning.png&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">LightningOrchestratorConfig</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns `KubeflowOrchestratorConfig` config class.</span>

<span class="sd">        Returns:</span>
<span class="sd">                The config class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">LightningOrchestratorConfig</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implementation_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;LightningOrchestrator&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation class for this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The implementation class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.lightning.orchestrators</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">LightningOrchestrator</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">LightningOrchestrator</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.config_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">config_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">integrations</span><span class="o">.</span><span class="n">lightning</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">lightning_orchestrator_flavor</span><span class="o">.</span><span class="n">LightningOrchestratorConfig</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Returns <code>KubeflowOrchestratorConfig</code> config class.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Type[zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorConfig]</code></td>
      <td><p>The config class.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.docs_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">docs_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>A url to point at docs explaining this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>A flavor docs url.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.implementation_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">implementation_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">LightningOrchestrator</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Implementation class for this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Type[LightningOrchestrator]</code></td>
      <td><p>The implementation class.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.logo_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">logo_url</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>A url to represent the flavor in the dashboard.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The flavor logo.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Name of the flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The name of the flavor.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorFlavor.sdk_docs_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sdk_docs_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>A url to point at SDK docs explaining this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>A flavor SDK docs url.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>








  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorSettings" class="doc doc-heading">
        <code>
LightningOrchestratorSettings            (<a class="autorefs autorefs-internal" title="zenml.config.base_settings.BaseSettings" href="../../core_code_docs/core-config/#zenml.config.base_settings.BaseSettings">BaseSettings</a>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Lightning orchestrator base settings.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>main_studio_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Main studio name.</p></td>
      </tr>
      <tr>
        <td><code>machine_type</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Machine type.</p></td>
      </tr>
      <tr>
        <td><code>user_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>User id.</p></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>api_key.</p></td>
      </tr>
      <tr>
        <td><code>username</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Username.</p></td>
      </tr>
      <tr>
        <td><code>teamspace</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Teamspace.</p></td>
      </tr>
      <tr>
        <td><code>organization</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Organization.</p></td>
      </tr>
      <tr>
        <td><code>custom_commands</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>Custom commands to run.</p></td>
      </tr>
      <tr>
        <td><code>synchronous</code></td>
        <td><code>bool</code></td>
        <td><p>If <code>True</code>, the client running a pipeline using this
orchestrator waits until all steps finish running. If <code>False</code>,
the client returns immediately and the pipeline is executed
asynchronously. Defaults to <code>True</code>. This setting only
has an effect when specified on the pipeline and will be ignored if
specified on steps.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/flavors/lightning_orchestrator_flavor.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LightningOrchestratorSettings</span><span class="p">(</span><span class="n">BaseSettings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lightning orchestrator base settings.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        main_studio_name: Main studio name.</span>
<span class="sd">        machine_type: Machine type.</span>
<span class="sd">        user_id: User id.</span>
<span class="sd">        api_key: api_key.</span>
<span class="sd">        username: Username.</span>
<span class="sd">        teamspace: Teamspace.</span>
<span class="sd">        organization: Organization.</span>
<span class="sd">        custom_commands: Custom commands to run.</span>
<span class="sd">        synchronous: If `True`, the client running a pipeline using this</span>
<span class="sd">            orchestrator waits until all steps finish running. If `False`,</span>
<span class="sd">            the client returns immediately and the pipeline is executed</span>
<span class="sd">            asynchronously. Defaults to `True`. This setting only</span>
<span class="sd">            has an effect when specified on the pipeline and will be ignored if</span>
<span class="sd">            specified on steps.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Resources</span>
    <span class="n">main_studio_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">machine_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">SecretField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">SecretField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">username</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">teamspace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">organization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">custom_commands</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">synchronous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



























  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.lightning.orchestrators" class="doc doc-heading">
        <code>orchestrators</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialization of the Lightning ZenML orchestrator.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator" class="doc doc-heading">
        <code>lightning_orchestrator</code>



</h4>

    <div class="doc doc-contents ">

      <p>Implementation of the Lightning orchestrator.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator" class="doc doc-heading">
        <code>
LightningOrchestrator            (<a class="autorefs autorefs-internal" title="zenml.orchestrators.wheeled_orchestrator.WheeledOrchestrator" href="../../core_code_docs/core-orchestrators/#zenml.orchestrators.wheeled_orchestrator.WheeledOrchestrator">WheeledOrchestrator</a>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Base class for Orchestrator responsible for running pipelines remotely in a VM.</p>
<p>This orchestrator does not support running on a schedule.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LightningOrchestrator</span><span class="p">(</span><span class="n">WheeledOrchestrator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for Orchestrator responsible for running pipelines remotely in a VM.</span>

<span class="sd">    This orchestrator does not support running on a schedule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">validator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StackValidator</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates the stack.</span>

<span class="sd">        In the remote case, checks that the stack contains a container registry,</span>
<span class="sd">        image builder and only remote components.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A `StackValidator` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_validate_remote_components</span><span class="p">(</span>
            <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">component</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">is_local</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># return False, (</span>
                <span class="c1">#    f&quot;The Lightning orchestrator runs pipelines remotely, &quot;</span>
                <span class="c1">#    f&quot;but the &#39;{component.name}&#39; {component.type.value} is &quot;</span>
                <span class="c1">#    &quot;a local stack component and will not be available in &quot;</span>
                <span class="c1">#    &quot;the Lightning step.\nPlease ensure that you always &quot;</span>
                <span class="c1">#    &quot;use non-local stack components with the Lightning &quot;</span>
                <span class="c1">#    &quot;orchestrator.&quot;</span>
                <span class="c1"># )</span>

            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>

        <span class="k">return</span> <span class="n">StackValidator</span><span class="p">(</span>
            <span class="n">custom_validation_function</span><span class="o">=</span><span class="n">_validate_remote_components</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_lightning_env_vars</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the Lightning client using environment variables.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: The pipeline deployment to prepare or run.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the user id and api key or username and organization</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">LightningOrchestratorSettings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">user_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">api_key</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Lightning orchestrator requires `user_id` and `api_key` both to be set in the settings.&quot;</span>
            <span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LIGHTNING_USER_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">user_id</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LIGHTNING_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">api_key</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">username</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LIGHTNING_USERNAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">username</span>
        <span class="k">elif</span> <span class="n">settings</span><span class="o">.</span><span class="n">organization</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LIGHTNING_ORG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">organization</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Lightning orchestrator requires either `username` or `organization` to be set in the settings.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">teamspace</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LIGHTNING_TEAMSPACE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">teamspace</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LightningOrchestratorConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the `LightningOrchestratorConfig` config.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">LightningOrchestratorConfig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">settings_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">LightningOrchestratorSettings</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Settings class for the Lightning orchestrator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The settings class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">LightningOrchestratorSettings</span>

    <span class="k">def</span> <span class="nf">get_orchestrator_run_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the active orchestrator run id.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If no run id exists. This happens when this method</span>
<span class="sd">                gets called while the orchestrator is not running a pipeline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The orchestrator run id.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the run id cannot be read from the environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Unable to read run id from environment variable &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">root_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Path to the root directory for all files concerning this orchestrator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path to the root directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">get_global_config_directory</span><span class="p">(),</span>
            <span class="s2">&quot;lightning&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pipeline_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns path to a directory in which the kubeflow pipeline files are stored.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path to the pipeline directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_directory</span><span class="p">,</span> <span class="s2">&quot;pipelines&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setup_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up credentials for the orchestrator.&quot;&quot;&quot;</span>
        <span class="n">connector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connector</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">connector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">connector</span><span class="o">.</span><span class="n">configure_local_client</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">prepare_or_run_pipeline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
        <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
        <span class="n">environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a wheel and uploads the pipeline to Lightning.</span>

<span class="sd">        This functions as an intermediary representation of the pipeline which</span>
<span class="sd">        is then deployed to the kubeflow pipelines instance.</span>

<span class="sd">        How it works:</span>
<span class="sd">        -------------</span>
<span class="sd">        Before this method is called the `prepare_pipeline_deployment()`</span>
<span class="sd">        method builds a docker image that contains the code for the</span>
<span class="sd">        pipeline, all steps the context around these files.</span>

<span class="sd">        Based on this docker image a callable is created which builds</span>
<span class="sd">        task for each step (`_construct_lightning_pipeline`).</span>
<span class="sd">        To do this the entrypoint of the docker image is configured to</span>
<span class="sd">        run the correct step within the docker image. The dependencies</span>
<span class="sd">        between these task are then also configured onto each</span>
<span class="sd">        task by pointing at the downstream steps.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: The pipeline deployment to prepare or run.</span>
<span class="sd">            stack: The stack the pipeline will run on.</span>
<span class="sd">            environment: Environment variables to set in the orchestration</span>
<span class="sd">                environment.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the schedule is not set or if the cron expression</span>
<span class="sd">                is not set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">LightningOrchestratorSettings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">catchup</span>
                <span class="ow">or</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">interval_second</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Lightning orchestrator only uses schedules with the &quot;</span>
                    <span class="s2">&quot;`cron_expression` property, with optional `start_time` and/or `end_time`. &quot;</span>
                    <span class="s2">&quot;All other properties are ignored.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">cron_expression</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Property `cron_expression` must be set when passing &quot;</span>
                    <span class="s2">&quot;schedule to a Lightning orchestrator.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">cron_expression</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Property `schedule_timezone` must be set when passing &quot;</span>
                    <span class="s2">&quot;`cron_expression` to a Lightning orchestrator.&quot;</span>
                    <span class="s2">&quot;Lightning orchestrator requires a Java Timezone ID to run the pipeline on schedule.&quot;</span>
                    <span class="s2">&quot;Please refer to https://docs.oracle.com/middleware/1221/wcs/tag-ref/MISC/TimeZones.html for more information.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Get deployment id</span>
        <span class="n">deployment_id</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">id</span>

        <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span>
        <span class="n">orchestrator_run_name</span> <span class="o">=</span> <span class="n">get_orchestrator_run_name</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">)</span>

        <span class="c1"># Copy the repository to a temporary directory and add a setup.py file</span>
        <span class="c1"># repository_temp_dir = (</span>
        <span class="c1">#    self.copy_repository_to_temp_dir_and_add_setup_py()</span>
        <span class="c1"># )</span>

        <span class="c1"># Create a wheel for the package in the temporary directory</span>
        <span class="c1"># wheel_path = self.create_wheel(temp_dir=repository_temp_dir)</span>
        <span class="n">code_archive</span> <span class="o">=</span> <span class="n">code_utils</span><span class="o">.</span><span class="n">CodeArchive</span><span class="p">(</span>
            <span class="n">root</span><span class="o">=</span><span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Archiving pipeline code...&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+b&quot;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.tar.gz&quot;</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">code_file</span><span class="p">:</span>
            <span class="n">code_archive</span><span class="o">.</span><span class="n">write_archive</span><span class="p">(</span><span class="n">code_file</span><span class="p">)</span>
            <span class="n">code_path</span> <span class="o">=</span> <span class="n">code_file</span><span class="o">.</span><span class="n">name</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">orchestrator_run_name</span><span class="si">}</span><span class="s2">.tar.gz&quot;</span>
        <span class="c1"># Construct the env variables for the pipeline</span>
        <span class="n">env_vars</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">orchestrator_run_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">env_vars</span><span class="p">[</span><span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">orchestrator_run_id</span>
        <span class="c1"># Set up some variables for configuration</span>
        <span class="n">env_vars</span><span class="p">[</span><span class="n">ENV_ZENML_CUSTOM_SOURCE_ROOT</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">LIGHTNING_ZENML_DEFAULT_CUSTOM_REPOSITORY_PATH</span>
        <span class="p">)</span>
        <span class="n">env_vars</span><span class="p">[</span><span class="n">ENV_ZENML_WHEEL_PACKAGE_NAME</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">package_name</span>

        <span class="c1"># Create a line-by-line export of environment variables</span>
        <span class="n">env_exports</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;export </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">env_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="p">)</span>

        <span class="c1"># Write the environment variables to a temporary file</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.studiorc&quot;</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">temp_file</span><span class="p">:</span>
            <span class="n">temp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">env_exports</span><span class="p">)</span>
            <span class="n">env_file_path</span> <span class="o">=</span> <span class="n">temp_file</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># Gather the requirements</span>
        <span class="n">pipeline_docker_settings</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">docker_settings</span>
        <span class="p">)</span>
        <span class="n">pipeline_requirements</span> <span class="o">=</span> <span class="n">gather_requirements</span><span class="p">(</span><span class="n">pipeline_docker_settings</span><span class="p">)</span>
        <span class="n">pipeline_requirements_to_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">req</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">pipeline_requirements</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">_construct_lightning_steps</span><span class="p">(</span>
            <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Construct the steps for the pipeline.</span>

<span class="sd">            Args:</span>
<span class="sd">                deployment: The pipeline deployment to prepare or run.</span>

<span class="sd">            Returns:</span>
<span class="sd">                The steps for the pipeline.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># The arguments are passed to configure the entrypoint of the</span>
                <span class="c1"># docker container when the step is called.</span>
                <span class="n">entrypoint_command</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">entrypoint_arguments</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
                        <span class="n">step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span>
                        <span class="n">deployment_id</span><span class="o">=</span><span class="n">deployment_id</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">entrypoint</span> <span class="o">=</span> <span class="n">entrypoint_command</span> <span class="o">+</span> <span class="n">entrypoint_arguments</span>
                <span class="n">entrypoint_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>

                <span class="n">step_settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                    <span class="n">LightningOrchestratorSettings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="c1"># Gather the requirements</span>
                <span class="n">step_docker_settings</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span>
                <span class="n">step_requirements</span> <span class="o">=</span> <span class="n">gather_requirements</span><span class="p">(</span><span class="n">step_docker_settings</span><span class="p">)</span>
                <span class="n">step_requirements_to_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">req</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">step_requirements</span>
                <span class="p">)</span>

                <span class="c1"># Construct the command to run the step</span>
                <span class="n">run_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entrypoint_string</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">commands</span> <span class="o">=</span> <span class="p">[</span><span class="n">run_command</span><span class="p">]</span>
                <span class="n">steps</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;commands&quot;</span><span class="p">:</span> <span class="n">commands</span><span class="p">,</span>
                    <span class="s2">&quot;requirements&quot;</span><span class="p">:</span> <span class="n">step_requirements_to_string</span><span class="p">,</span>
                    <span class="s2">&quot;machine&quot;</span><span class="p">:</span> <span class="n">step_settings</span><span class="o">.</span><span class="n">machine_type</span>
                    <span class="k">if</span> <span class="n">step_settings</span> <span class="o">!=</span> <span class="n">settings</span>
                    <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="k">return</span> <span class="n">steps</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">synchronous</span><span class="p">:</span>
            <span class="n">entrypoint_command</span> <span class="o">=</span> <span class="n">LightningOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
            <span class="n">entrypoint_arguments</span> <span class="o">=</span> <span class="n">LightningOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
                <span class="n">run_name</span><span class="o">=</span><span class="n">orchestrator_run_name</span><span class="p">,</span>
                <span class="n">deployment_id</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">entrypoint</span> <span class="o">=</span> <span class="n">entrypoint_command</span> <span class="o">+</span> <span class="n">entrypoint_arguments</span>
            <span class="n">entrypoint_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Setting up Lightning AI client&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_lightning_env_vars</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>

            <span class="n">studio_name</span> <span class="o">=</span> <span class="n">sanitize_studio_name</span><span class="p">(</span>
                <span class="s2">&quot;zenml_async_orchestrator_studio&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating main studio: </span><span class="si">{</span><span class="n">studio_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">studio</span> <span class="o">=</span> <span class="n">Studio</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">studio_name</span><span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Uploading wheel package and installing dependencies on main studio&quot;</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;mkdir -p /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                <span class="n">code_path</span><span class="p">,</span>
                <span class="n">remote_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;tar -xvzf /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> -C /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                <span class="n">env_file_path</span><span class="p">,</span>
                <span class="n">remote_path</span><span class="o">=</span><span class="s2">&quot;/teamspace/studios/this_studio/.lightning_studio/.studiorc&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install uv&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Installing requirements: </span><span class="si">{</span><span class="n">pipeline_requirements_to_string</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;uv pip install </span><span class="si">{</span><span class="n">pipeline_requirements_to_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install zenml&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">custom_command</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">custom_commands</span> <span class="ow">or</span> <span class="p">[]:</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">custom_command</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="c1"># studio.run(f&quot;pip install {wheel_path.rsplit(&#39;/&#39;, 1)[-1]}&quot;)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running pipeline in async mode&quot;</span><span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;nohup bash -c &#39;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">entrypoint_string</span><span class="si">}</span><span class="s2">&#39; &gt; log_</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.txt 2&gt;&amp;1 &amp;&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The pipeline is running in async mode, you can keep checking the logs by running the following command: `lightning download -s vision-model/zenml-async-orchestrator-studio -p /teamspace/studios/this_studio/log_</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.txt &amp;&amp; cat log_</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.txt`&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_upload_and_run_pipeline</span><span class="p">(</span>
                <span class="n">deployment</span><span class="p">,</span>
                <span class="n">orchestrator_run_id</span><span class="p">,</span>
                <span class="n">pipeline_requirements_to_string</span><span class="p">,</span>
                <span class="n">settings</span><span class="p">,</span>
                <span class="n">_construct_lightning_steps</span><span class="p">(</span><span class="n">deployment</span><span class="p">),</span>
                <span class="n">code_path</span><span class="p">,</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">env_file_path</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">env_file_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_upload_and_run_pipeline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
        <span class="n">orchestrator_run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">requirements</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">settings</span><span class="p">:</span> <span class="n">LightningOrchestratorSettings</span><span class="p">,</span>
        <span class="n">steps_commands</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">code_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">env_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Upload and run the pipeline on Lightning Studio.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: The pipeline deployment to prepare or run.</span>
<span class="sd">            orchestrator_run_id: The orchestrator run id.</span>
<span class="sd">            requirements: The requirements for the pipeline.</span>
<span class="sd">            settings: The orchestrator settings.</span>
<span class="sd">            steps_commands: The commands for the steps.</span>
<span class="sd">            code_path: The path to the wheel package.</span>
<span class="sd">            filename: The name of the code archive.</span>
<span class="sd">            env_file_path: The path to the environment file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If an error occurs while running the pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Setting up Lightning AI client&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_lightning_env_vars</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">main_studio_name</span><span class="p">:</span>
            <span class="n">studio_name</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">main_studio_name</span>
            <span class="n">studio</span> <span class="o">=</span> <span class="n">Studio</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">studio_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">machine</span> <span class="o">!=</span> <span class="n">settings</span><span class="o">.</span><span class="n">machine_type</span>
                <span class="ow">and</span> <span class="n">settings</span><span class="o">.</span><span class="n">machine_type</span>
            <span class="p">):</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">switch_machine</span><span class="p">(</span><span class="n">Machine</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">machine_type</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">studio_name</span> <span class="o">=</span> <span class="n">sanitize_studio_name</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;zenml_</span><span class="si">{</span><span class="n">orchestrator_run_id</span><span class="si">}</span><span class="s2">_pipeline&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating main studio: </span><span class="si">{</span><span class="n">studio_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">studio</span> <span class="o">=</span> <span class="n">Studio</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">studio_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">machine_type</span><span class="p">:</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">Machine</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">machine_type</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;mkdir -p /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                <span class="n">code_path</span><span class="p">,</span>
                <span class="n">remote_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;tar -xvzf /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> -C /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Uploading wheel package and installing dependencies on main studio&quot;</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                <span class="n">env_file_path</span><span class="p">,</span>
                <span class="n">remote_path</span><span class="o">=</span><span class="s2">&quot;/teamspace/studios/this_studio/.lightning_studio/.studiorc&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install uv&quot;</span><span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;uv pip install </span><span class="si">{</span><span class="n">requirements</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install zenml&quot;</span><span class="p">)</span>
            <span class="c1"># studio.run(f&quot;pip install {wheel_path.rsplit(&#39;/&#39;, 1)[-1]}&quot;)</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">custom_commands</span> <span class="ow">or</span> <span class="p">[]:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom command output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">details</span> <span class="ow">in</span> <span class="n">steps_commands</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;machine&quot;</span><span class="p">]:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing step: </span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2"> in new studio&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_run_step_in_new_studio</span><span class="p">(</span>
                        <span class="n">orchestrator_run_id</span><span class="p">,</span>
                        <span class="n">step_name</span><span class="p">,</span>
                        <span class="n">details</span><span class="p">,</span>
                        <span class="n">code_path</span><span class="p">,</span>
                        <span class="n">filename</span><span class="p">,</span>
                        <span class="n">env_file_path</span><span class="p">,</span>
                        <span class="n">settings</span><span class="o">.</span><span class="n">custom_commands</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing step: </span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2"> in main studio&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_run_step_in_main_studio</span><span class="p">(</span><span class="n">studio</span><span class="p">,</span> <span class="n">details</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error running pipeline: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="n">studio</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">NotCreated</span>
                <span class="ow">and</span> <span class="n">settings</span><span class="o">.</span><span class="n">main_studio_name</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleting main studio&quot;</span><span class="p">)</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_run_step_in_new_studio</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orchestrator_run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">step_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">code_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">env_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">custom_commands</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a step in a new studio.</span>

<span class="sd">        Args:</span>
<span class="sd">            orchestrator_run_id: The orchestrator run id.</span>
<span class="sd">            step_name: The name of the step.</span>
<span class="sd">            details: The details of the step.</span>
<span class="sd">            code_path: The path to the wheel package.</span>
<span class="sd">            filename: The name of the code archive.</span>
<span class="sd">            env_file_path: The path to the environment file.</span>
<span class="sd">            custom_commands: Custom commands to run.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">studio_name</span> <span class="o">=</span> <span class="n">sanitize_studio_name</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;zenml_</span><span class="si">{</span><span class="n">orchestrator_run_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating new studio for step </span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">studio_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">studio</span> <span class="o">=</span> <span class="n">Studio</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">studio_name</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">Machine</span><span class="p">(</span><span class="n">details</span><span class="p">[</span><span class="s2">&quot;machine&quot;</span><span class="p">]))</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;mkdir -p /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">code_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;tar -xvzf /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> -C /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
            <span class="n">env_file_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="o">=</span><span class="s2">&quot;.lightning_studio/.studiorc&quot;</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install uv&quot;</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;uv pip install </span><span class="si">{</span><span class="n">details</span><span class="p">[</span><span class="s1">&#39;requirements&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install zenml&quot;</span><span class="p">)</span>
        <span class="c1"># studio.run(f&quot;pip install {wheel_path.rsplit(&#39;/&#39;, 1)[-1]}&quot;)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">custom_commands</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom command output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;commands&quot;</span><span class="p">]:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step </span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2"> output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_run_step_in_main_studio</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">studio</span><span class="p">:</span> <span class="n">Studio</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a step in the main studio.</span>

<span class="sd">        Args:</span>
<span class="sd">            studio: The studio to run the step in.</span>
<span class="sd">            details: The details of the step.</span>
<span class="sd">            filename: The name of the code archive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;commands&quot;</span><span class="p">]:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">config</span><span class="p">:</span> <span class="n">LightningOrchestratorConfig</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Returns the <code>LightningOrchestratorConfig</code> config.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>LightningOrchestratorConfig</code></td>
      <td><p>The configuration.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.pipeline_directory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pipeline_directory</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Returns path to a directory in which the kubeflow pipeline files are stored.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path to the pipeline directory.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.root_directory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">root_directory</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Path to the root directory for all files concerning this orchestrator.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path to the root directory.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.settings_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">settings_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">integrations</span><span class="o">.</span><span class="n">lightning</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">lightning_orchestrator_flavor</span><span class="o">.</span><span class="n">LightningOrchestratorSettings</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Settings class for the Lightning orchestrator.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Type[zenml.integrations.lightning.flavors.lightning_orchestrator_flavor.LightningOrchestratorSettings]</code></td>
      <td><p>The settings class.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.validator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">stack_validator</span><span class="o">.</span><span class="n">StackValidator</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Validates the stack.</p>
<p>In the remote case, checks that the stack contains a container registry,
image builder and only remote components.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[zenml.stack.stack_validator.StackValidator]</code></td>
      <td><p>A <code>StackValidator</code> instance.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>






  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.get_orchestrator_run_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_orchestrator_run_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Returns the active orchestrator run id.</p>

<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If no run id exists. This happens when this method
gets called while the orchestrator is not running a pipeline.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The orchestrator run id.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the run id cannot be read from the environment.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_orchestrator_run_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the active orchestrator run id.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no run id exists. This happens when this method</span>
<span class="sd">            gets called while the orchestrator is not running a pipeline.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The orchestrator run id.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the run id cannot be read from the environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Unable to read run id from environment variable &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.prepare_or_run_pipeline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare_or_run_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deployment</span><span class="p">,</span> <span class="n">stack</span><span class="p">,</span> <span class="n">environment</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Creates a wheel and uploads the pipeline to Lightning.</p>
<p>This functions as an intermediary representation of the pipeline which
is then deployed to the kubeflow pipelines instance.</p>
<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.prepare_or_run_pipeline--how-it-works">How it works:</h6>
<p>Before this method is called the <code>prepare_pipeline_deployment()</code>
method builds a docker image that contains the code for the
pipeline, all steps the context around these files.</p>
<p>Based on this docker image a callable is created which builds
task for each step (<code>_construct_lightning_pipeline</code>).
To do this the entrypoint of the docker image is configured to
run the correct step within the docker image. The dependencies
between these task are then also configured onto each
task by pointing at the downstream steps.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentResponse</code></td>
        <td><p>The pipeline deployment to prepare or run.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stack</code></td>
        <td><code>Stack</code></td>
        <td><p>The stack the pipeline will run on.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>environment</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>Environment variables to set in the orchestration
environment.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the schedule is not set or if the cron expression
is not set.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_or_run_pipeline</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
    <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a wheel and uploads the pipeline to Lightning.</span>

<span class="sd">    This functions as an intermediary representation of the pipeline which</span>
<span class="sd">    is then deployed to the kubeflow pipelines instance.</span>

<span class="sd">    How it works:</span>
<span class="sd">    -------------</span>
<span class="sd">    Before this method is called the `prepare_pipeline_deployment()`</span>
<span class="sd">    method builds a docker image that contains the code for the</span>
<span class="sd">    pipeline, all steps the context around these files.</span>

<span class="sd">    Based on this docker image a callable is created which builds</span>
<span class="sd">    task for each step (`_construct_lightning_pipeline`).</span>
<span class="sd">    To do this the entrypoint of the docker image is configured to</span>
<span class="sd">    run the correct step within the docker image. The dependencies</span>
<span class="sd">    between these task are then also configured onto each</span>
<span class="sd">    task by pointing at the downstream steps.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The pipeline deployment to prepare or run.</span>
<span class="sd">        stack: The stack the pipeline will run on.</span>
<span class="sd">        environment: Environment variables to set in the orchestration</span>
<span class="sd">            environment.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the schedule is not set or if the cron expression</span>
<span class="sd">            is not set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">LightningOrchestratorSettings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">catchup</span>
            <span class="ow">or</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">interval_second</span>
        <span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Lightning orchestrator only uses schedules with the &quot;</span>
                <span class="s2">&quot;`cron_expression` property, with optional `start_time` and/or `end_time`. &quot;</span>
                <span class="s2">&quot;All other properties are ignored.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">cron_expression</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Property `cron_expression` must be set when passing &quot;</span>
                <span class="s2">&quot;schedule to a Lightning orchestrator.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">deployment</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">cron_expression</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Property `schedule_timezone` must be set when passing &quot;</span>
                <span class="s2">&quot;`cron_expression` to a Lightning orchestrator.&quot;</span>
                <span class="s2">&quot;Lightning orchestrator requires a Java Timezone ID to run the pipeline on schedule.&quot;</span>
                <span class="s2">&quot;Please refer to https://docs.oracle.com/middleware/1221/wcs/tag-ref/MISC/TimeZones.html for more information.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Get deployment id</span>
    <span class="n">deployment_id</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">id</span>

    <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span>
    <span class="n">orchestrator_run_name</span> <span class="o">=</span> <span class="n">get_orchestrator_run_name</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">)</span>

    <span class="c1"># Copy the repository to a temporary directory and add a setup.py file</span>
    <span class="c1"># repository_temp_dir = (</span>
    <span class="c1">#    self.copy_repository_to_temp_dir_and_add_setup_py()</span>
    <span class="c1"># )</span>

    <span class="c1"># Create a wheel for the package in the temporary directory</span>
    <span class="c1"># wheel_path = self.create_wheel(temp_dir=repository_temp_dir)</span>
    <span class="n">code_archive</span> <span class="o">=</span> <span class="n">code_utils</span><span class="o">.</span><span class="n">CodeArchive</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="n">source_utils</span><span class="o">.</span><span class="n">get_source_root</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Archiving pipeline code...&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+b&quot;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.tar.gz&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">code_file</span><span class="p">:</span>
        <span class="n">code_archive</span><span class="o">.</span><span class="n">write_archive</span><span class="p">(</span><span class="n">code_file</span><span class="p">)</span>
        <span class="n">code_path</span> <span class="o">=</span> <span class="n">code_file</span><span class="o">.</span><span class="n">name</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">orchestrator_run_name</span><span class="si">}</span><span class="s2">.tar.gz&quot;</span>
    <span class="c1"># Construct the env variables for the pipeline</span>
    <span class="n">env_vars</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">orchestrator_run_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="n">env_vars</span><span class="p">[</span><span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">orchestrator_run_id</span>
    <span class="c1"># Set up some variables for configuration</span>
    <span class="n">env_vars</span><span class="p">[</span><span class="n">ENV_ZENML_CUSTOM_SOURCE_ROOT</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">LIGHTNING_ZENML_DEFAULT_CUSTOM_REPOSITORY_PATH</span>
    <span class="p">)</span>
    <span class="n">env_vars</span><span class="p">[</span><span class="n">ENV_ZENML_WHEEL_PACKAGE_NAME</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">package_name</span>

    <span class="c1"># Create a line-by-line export of environment variables</span>
    <span class="n">env_exports</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;export </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">env_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="p">)</span>

    <span class="c1"># Write the environment variables to a temporary file</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.studiorc&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">temp_file</span><span class="p">:</span>
        <span class="n">temp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">env_exports</span><span class="p">)</span>
        <span class="n">env_file_path</span> <span class="o">=</span> <span class="n">temp_file</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># Gather the requirements</span>
    <span class="n">pipeline_docker_settings</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">docker_settings</span>
    <span class="p">)</span>
    <span class="n">pipeline_requirements</span> <span class="o">=</span> <span class="n">gather_requirements</span><span class="p">(</span><span class="n">pipeline_docker_settings</span><span class="p">)</span>
    <span class="n">pipeline_requirements_to_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">req</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">pipeline_requirements</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_construct_lightning_steps</span><span class="p">(</span>
        <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentResponse&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the steps for the pipeline.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: The pipeline deployment to prepare or run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The steps for the pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># The arguments are passed to configure the entrypoint of the</span>
            <span class="c1"># docker container when the step is called.</span>
            <span class="n">entrypoint_command</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">entrypoint_arguments</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
                    <span class="n">step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span>
                    <span class="n">deployment_id</span><span class="o">=</span><span class="n">deployment_id</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">entrypoint</span> <span class="o">=</span> <span class="n">entrypoint_command</span> <span class="o">+</span> <span class="n">entrypoint_arguments</span>
            <span class="n">entrypoint_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>

            <span class="n">step_settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">LightningOrchestratorSettings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># Gather the requirements</span>
            <span class="n">step_docker_settings</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span>
            <span class="n">step_requirements</span> <span class="o">=</span> <span class="n">gather_requirements</span><span class="p">(</span><span class="n">step_docker_settings</span><span class="p">)</span>
            <span class="n">step_requirements_to_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">req</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">step_requirements</span>
            <span class="p">)</span>

            <span class="c1"># Construct the command to run the step</span>
            <span class="n">run_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entrypoint_string</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">[</span><span class="n">run_command</span><span class="p">]</span>
            <span class="n">steps</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;commands&quot;</span><span class="p">:</span> <span class="n">commands</span><span class="p">,</span>
                <span class="s2">&quot;requirements&quot;</span><span class="p">:</span> <span class="n">step_requirements_to_string</span><span class="p">,</span>
                <span class="s2">&quot;machine&quot;</span><span class="p">:</span> <span class="n">step_settings</span><span class="o">.</span><span class="n">machine_type</span>
                <span class="k">if</span> <span class="n">step_settings</span> <span class="o">!=</span> <span class="n">settings</span>
                <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">return</span> <span class="n">steps</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">synchronous</span><span class="p">:</span>
        <span class="n">entrypoint_command</span> <span class="o">=</span> <span class="n">LightningOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
        <span class="n">entrypoint_arguments</span> <span class="o">=</span> <span class="n">LightningOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
            <span class="n">run_name</span><span class="o">=</span><span class="n">orchestrator_run_name</span><span class="p">,</span>
            <span class="n">deployment_id</span><span class="o">=</span><span class="n">deployment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">entrypoint</span> <span class="o">=</span> <span class="n">entrypoint_command</span> <span class="o">+</span> <span class="n">entrypoint_arguments</span>
        <span class="n">entrypoint_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Setting up Lightning AI client&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_lightning_env_vars</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>

        <span class="n">studio_name</span> <span class="o">=</span> <span class="n">sanitize_studio_name</span><span class="p">(</span>
            <span class="s2">&quot;zenml_async_orchestrator_studio&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating main studio: </span><span class="si">{</span><span class="n">studio_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">studio</span> <span class="o">=</span> <span class="n">Studio</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">studio_name</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Uploading wheel package and installing dependencies on main studio&quot;</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;mkdir -p /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
            <span class="n">code_path</span><span class="p">,</span>
            <span class="n">remote_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;tar -xvzf /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> -C /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
            <span class="n">env_file_path</span><span class="p">,</span>
            <span class="n">remote_path</span><span class="o">=</span><span class="s2">&quot;/teamspace/studios/this_studio/.lightning_studio/.studiorc&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install uv&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Installing requirements: </span><span class="si">{</span><span class="n">pipeline_requirements_to_string</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;uv pip install </span><span class="si">{</span><span class="n">pipeline_requirements_to_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install zenml&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">custom_command</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">custom_commands</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">custom_command</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="c1"># studio.run(f&quot;pip install {wheel_path.rsplit(&#39;/&#39;, 1)[-1]}&quot;)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running pipeline in async mode&quot;</span><span class="p">)</span>
        <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;nohup bash -c &#39;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">entrypoint_string</span><span class="si">}</span><span class="s2">&#39; &gt; log_</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.txt 2&gt;&amp;1 &amp;&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The pipeline is running in async mode, you can keep checking the logs by running the following command: `lightning download -s vision-model/zenml-async-orchestrator-studio -p /teamspace/studios/this_studio/log_</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.txt &amp;&amp; cat log_</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.txt`&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_upload_and_run_pipeline</span><span class="p">(</span>
            <span class="n">deployment</span><span class="p">,</span>
            <span class="n">orchestrator_run_id</span><span class="p">,</span>
            <span class="n">pipeline_requirements_to_string</span><span class="p">,</span>
            <span class="n">settings</span><span class="p">,</span>
            <span class="n">_construct_lightning_steps</span><span class="p">(</span><span class="n">deployment</span><span class="p">),</span>
            <span class="n">code_path</span><span class="p">,</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">env_file_path</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">env_file_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator.LightningOrchestrator.setup_credentials" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setup_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Set up credentials for the orchestrator.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">setup_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up credentials for the orchestrator.&quot;&quot;&quot;</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connector</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">connector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">configure_local_client</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint" class="doc doc-heading">
        <code>lightning_orchestrator_entrypoint</code>



</h4>

    <div class="doc doc-contents ">

      <p>Entrypoint of the Lightning master/orchestrator STUDIO.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint.main" class="doc doc-heading">
<code class="highlight language-python"><span class="n">main</span><span class="p">()</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Entrypoint of the Lightning master/orchestrator STUDIO.</p>
<p>This is the entrypoint of the Lightning master/orchestrator STUDIO. It is
responsible for provisioning the STUDIO and running the pipeline steps in
separate STUDIO.</p>

<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>If the active stack's orchestrator is not an instance of
LightningOrchestrator.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the active stack's container registry is None.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator_entrypoint.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Entrypoint of the Lightning master/orchestrator STUDIO.</span>

<span class="sd">    This is the entrypoint of the Lightning master/orchestrator STUDIO. It is</span>
<span class="sd">    responsible for provisioning the STUDIO and running the pipeline steps in</span>
<span class="sd">    separate STUDIO.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the active stack&#39;s orchestrator is not an instance of</span>
<span class="sd">            LightningOrchestrator.</span>
<span class="sd">        ValueError: If the active stack&#39;s container registry is None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log to the container&#39;s stdout so it can be streamed by the client.</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Lightning orchestrator STUDIO started.&quot;</span><span class="p">)</span>

    <span class="c1"># Parse / extract args.</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parse_args</span><span class="p">()</span>

    <span class="n">orchestrator_run_id</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">orchestrator_run_id</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Environment variable &#39;</span><span class="si">{</span><span class="n">ENV_ZENML_LIGHTNING_ORCHESTRATOR_RUN_ID</span><span class="si">}</span><span class="s2">&#39; is not set.&quot;</span>
        <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Orchestrator run id: </span><span class="si">{</span><span class="n">orchestrator_run_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">deployment</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">get_deployment</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">deployment_id</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">run_name</span><span class="si">}</span><span class="s2">.tar.gz&quot;</span>

    <span class="n">pipeline_dag</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">step_name</span><span class="p">:</span> <span class="n">step</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">upstream_steps</span>
        <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">entrypoint_command</span> <span class="o">=</span> <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>

    <span class="n">active_stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>

    <span class="n">orchestrator</span> <span class="o">=</span> <span class="n">active_stack</span><span class="o">.</span><span class="n">orchestrator</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">orchestrator</span><span class="p">,</span> <span class="n">LightningOrchestrator</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;The active stack&#39;s orchestrator is not an instance of LightningOrchestrator.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Set up credentials</span>
    <span class="n">orchestrator</span><span class="o">.</span><span class="n">_set_lightning_env_vars</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>

    <span class="n">pipeline_settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">LightningOrchestratorSettings</span><span class="p">,</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Gather the requirements</span>
    <span class="n">pipeline_docker_settings</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">deployment</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">docker_settings</span>
    <span class="p">)</span>
    <span class="n">pipeline_requirements</span> <span class="o">=</span> <span class="n">gather_requirements</span><span class="p">(</span><span class="n">pipeline_docker_settings</span><span class="p">)</span>
    <span class="n">pipeline_requirements_to_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">req</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">pipeline_requirements</span>
    <span class="p">)</span>

    <span class="n">unique_resource_configs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">main_studio_name</span> <span class="o">=</span> <span class="n">sanitize_studio_name</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;zenml_</span><span class="si">{</span><span class="n">orchestrator_run_id</span><span class="si">}</span><span class="s2">_pipeline&quot;</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">step_settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">LightningOrchestratorSettings</span><span class="p">,</span>
            <span class="n">orchestrator</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">main_studio_name</span>
        <span class="k">if</span> <span class="n">pipeline_settings</span><span class="o">.</span><span class="n">machine_type</span> <span class="o">!=</span> <span class="n">step_settings</span><span class="o">.</span><span class="n">machine_type</span><span class="p">:</span>
            <span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;zenml-</span><span class="si">{</span><span class="n">orchestrator_run_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating main studio: </span><span class="si">{</span><span class="n">main_studio_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">main_studio</span> <span class="o">=</span> <span class="n">Studio</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">main_studio_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pipeline_settings</span><span class="o">.</span><span class="n">machine_type</span><span class="p">:</span>
        <span class="n">main_studio</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">Machine</span><span class="p">(</span><span class="n">pipeline_settings</span><span class="o">.</span><span class="n">machine_type</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">main_studio</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Main studio started.&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Uploading code to main studio the code path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">main_studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
        <span class="s2">&quot;/teamspace/studios/this_studio/.lightning_studio/.studiorc&quot;</span><span class="p">,</span>
        <span class="n">remote_path</span><span class="o">=</span><span class="s2">&quot;/teamspace/studios/this_studio/.lightning_studio/.studiorc&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">main_studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;mkdir -p /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">main_studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;/teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">remote_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting code... &quot;</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">main_studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;tar -xvzf /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> -C /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Code extraction output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Installing requirements... &quot;</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">main_studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install uv&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">main_studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;uv pip install </span><span class="si">{</span><span class="n">pipeline_requirements_to_string</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">main_studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install zenml&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">pipeline_settings</span><span class="o">.</span><span class="n">custom_commands</span> <span class="ow">or</span> <span class="p">[]:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">main_studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom command output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">run</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">list_pipeline_runs</span><span class="p">(</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;asc:created&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">deployment_id</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">deployment_id</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">ExecutionStatus</span><span class="o">.</span><span class="n">INITIALIZING</span><span class="p">,</span>
    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Fetching pipeline run: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_step_on_lightning_studio</span><span class="p">(</span><span class="n">step_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a pipeline step in a separate Lightning STUDIO.</span>

<span class="sd">        Args:</span>
<span class="sd">            step_name: Name of the step.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If an error occurs while running the step on the STUDIO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">step_args</span> <span class="o">=</span> <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
            <span class="n">step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span>
            <span class="n">deployment_id</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">deployment_id</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">entrypoint</span> <span class="o">=</span> <span class="n">entrypoint_command</span> <span class="o">+</span> <span class="n">step_args</span>
        <span class="n">entrypoint_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entrypoint</span><span class="p">)</span>
        <span class="n">run_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entrypoint_string</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">step</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">main_studio_name</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Creating separate studio for step: </span><span class="si">{</span><span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="c1"># Get step settings</span>
            <span class="n">step_settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">LightningOrchestratorSettings</span><span class="p">,</span>
                <span class="n">orchestrator</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="c1"># Gather the requirements</span>
            <span class="n">step_docker_settings</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span>
            <span class="n">step_requirements</span> <span class="o">=</span> <span class="n">gather_requirements</span><span class="p">(</span><span class="n">step_docker_settings</span><span class="p">)</span>
            <span class="n">step_requirements_to_string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">req</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">step_requirements</span>
            <span class="p">)</span>
            <span class="n">run_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entrypoint_string</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Creating separate studio for step: </span><span class="si">{</span><span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">studio</span> <span class="o">=</span> <span class="n">Studio</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">Machine</span><span class="p">(</span><span class="n">step_settings</span><span class="o">.</span><span class="n">machine_type</span><span class="p">))</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;mkdir -p /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;/teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">remote_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;tar -xvzf /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> -C /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                    <span class="s2">&quot;/teamspace/studios/this_studio/.lightning_studio/.studiorc&quot;</span><span class="p">,</span>
                    <span class="n">remote_path</span><span class="o">=</span><span class="s2">&quot;/teamspace/studios/this_studio/.lightning_studio/.studiorc&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install uv&quot;</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;uv pip install </span><span class="si">{</span><span class="n">step_requirements_to_string</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pip install zenml&quot;</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">step_settings</span><span class="o">.</span><span class="n">custom_commands</span> <span class="ow">or</span> <span class="p">[]:</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom command output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">run_command</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Error running step </span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2"> on studio </span><span class="si">{</span><span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
                <span class="n">studio</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">main_studio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;cd /teamspace/studios/this_studio/zenml_codes/</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; </span><span class="si">{</span><span class="n">run_command</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

            <span class="c1"># Pop the resource configuration for this step</span>
        <span class="n">unique_resource_configs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">step_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">main_studio_name</span> <span class="ow">in</span> <span class="n">unique_resource_configs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="c1"># If there are more steps using this configuration, skip deprovisioning the cluster</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Resource configuration for studio &#39;</span><span class="si">{</span><span class="n">main_studio_name</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                <span class="s2">&quot;is used by subsequent steps. Skipping the deprovisioning of &quot;</span>
                <span class="s2">&quot;the studio.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If there are no more steps using this configuration, down the cluster</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Resource configuration for cluster &#39;</span><span class="si">{</span><span class="n">main_studio_name</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                <span class="s2">&quot;is not used by subsequent steps. deprovisioning the cluster.&quot;</span>
            <span class="p">)</span>
            <span class="n">main_studio</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running step `</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">` on a Studio is completed.&quot;</span><span class="p">)</span>

    <span class="n">ThreadedDagRunner</span><span class="p">(</span>
        <span class="n">dag</span><span class="o">=</span><span class="n">pipeline_dag</span><span class="p">,</span> <span class="n">run_fn</span><span class="o">=</span><span class="n">run_step_on_lightning_studio</span>
    <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Orchestration STUDIO provisioned.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint.parse_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_args</span><span class="p">()</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Parse entrypoint arguments.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Namespace</code></td>
      <td><p>Parsed args.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator_entrypoint.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_args</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse entrypoint arguments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parsed args.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--run_name&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--deployment_id&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration" class="doc doc-heading">
        <code>lightning_orchestrator_entrypoint_configuration</code>



</h4>

    <div class="doc doc-contents ">

      <p>Entrypoint configuration for the Lightning master/orchestrator VM.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration" class="doc doc-heading">
        <code>
LightningOrchestratorEntrypointConfiguration        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Entrypoint configuration for the Lightning master/orchestrator VM.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator_entrypoint_configuration.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LightningOrchestratorEntrypointConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Entrypoint configuration for the Lightning master/orchestrator VM.&quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_entrypoint_options</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets all the options required for running this entrypoint.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Entrypoint options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">RUN_NAME_OPTION</span><span class="p">,</span>
            <span class="n">DEPLOYMENT_ID_OPTION</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">options</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_entrypoint_command</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a command that runs the entrypoint module.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Entrypoint command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_entrypoint_arguments</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">run_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">deployment_id</span><span class="p">:</span> <span class="s2">&quot;UUID&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets all arguments that the entrypoint command should be called with.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_name: Name of the ZenML run.</span>
<span class="sd">            deployment_id: ID of the deployment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of entrypoint arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">RUN_NAME_OPTION</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">run_name</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">DEPLOYMENT_ID_OPTION</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">deployment_id</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">args</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_arguments" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_entrypoint_arguments</span><span class="p">(</span><span class="n">run_name</span><span class="p">,</span> <span class="n">deployment_id</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Gets all arguments that the entrypoint command should be called with.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>run_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the ZenML run.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>deployment_id</code></td>
        <td><code>UUID</code></td>
        <td><p>ID of the deployment.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>List of entrypoint arguments.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator_entrypoint_configuration.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_entrypoint_arguments</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">run_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">deployment_id</span><span class="p">:</span> <span class="s2">&quot;UUID&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets all arguments that the entrypoint command should be called with.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_name: Name of the ZenML run.</span>
<span class="sd">        deployment_id: ID of the deployment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of entrypoint arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">RUN_NAME_OPTION</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">run_name</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">DEPLOYMENT_ID_OPTION</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">deployment_id</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">args</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_command" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_entrypoint_command</span><span class="p">()</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Returns a command that runs the entrypoint module.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>Entrypoint command.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator_entrypoint_configuration.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_entrypoint_command</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a command that runs the entrypoint module.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Entrypoint command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;python&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">command</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.lightning.orchestrators.lightning_orchestrator_entrypoint_configuration.LightningOrchestratorEntrypointConfiguration.get_entrypoint_options" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_entrypoint_options</span><span class="p">()</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Gets all the options required for running this entrypoint.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Set[str]</code></td>
      <td><p>Entrypoint options.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/lightning_orchestrator_entrypoint_configuration.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_entrypoint_options</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets all the options required for running this entrypoint.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Entrypoint options.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">RUN_NAME_OPTION</span><span class="p">,</span>
        <span class="n">DEPLOYMENT_ID_OPTION</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">options</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.lightning.orchestrators.utils" class="doc doc-heading">
        <code>utils</code>



</h4>

    <div class="doc doc-contents ">

      <p>Utility functions for the Lightning orchestrator.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.lightning.orchestrators.utils.gather_requirements" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gather_requirements</span><span class="p">(</span><span class="n">docker_settings</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Gather the requirements files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>docker_settings</code></td>
        <td><code>DockerSettings</code></td>
        <td><p>Docker settings.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>List of requirements.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gather_requirements</span><span class="p">(</span><span class="n">docker_settings</span><span class="p">:</span> <span class="s2">&quot;DockerSettings&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gather the requirements files.</span>

<span class="sd">    Args:</span>
<span class="sd">        docker_settings: Docker settings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of requirements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">docker_image_builder</span> <span class="o">=</span> <span class="n">PipelineDockerImageBuilder</span><span class="p">()</span>
    <span class="n">requirements_files</span> <span class="o">=</span> <span class="n">docker_image_builder</span><span class="o">.</span><span class="n">gather_requirements_files</span><span class="p">(</span>
        <span class="n">docker_settings</span><span class="o">=</span><span class="n">docker_settings</span><span class="p">,</span>
        <span class="n">stack</span><span class="o">=</span><span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span><span class="p">,</span>
        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Extract and clean the requirements</span>
    <span class="n">requirements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">requirements_files</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Remove empty items and duplicates</span>
    <span class="n">requirements</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">requirements</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">requirements</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.lightning.orchestrators.utils.sanitize_studio_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_studio_name</span><span class="p">(</span><span class="n">studio_name</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Sanitize studio_names so they conform to Kubernetes studio naming convention.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>studio_name</code></td>
        <td><code>str</code></td>
        <td><p>Arbitrary input studio_name.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Sanitized pod name.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/lightning/orchestrators/utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_studio_name</span><span class="p">(</span><span class="n">studio_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sanitize studio_names so they conform to Kubernetes studio naming convention.</span>

<span class="sd">    Args:</span>
<span class="sd">        studio_name: Arbitrary input studio_name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sanitized pod name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">studio_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^a-z0-9-]&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">studio_name</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="n">studio_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[-]+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">studio_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[-]+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">studio_name</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../integrations-lightgbm/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lightgbm" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Lightgbm
            </div>
          </div>
        </a>
      
      
        
        <a href="../integrations-llama_index/" class="md-footer__link md-footer__link--next" aria-label="Next: Llama Index" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Llama Index
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 ZenML GmbH – <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  




<h4>This website uses cookies</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>